var _SETTINGS={tileSize:64,lifeTileSize:64};_AUDIO=[],_AUDIO.push(["mainbg","long/hotel_room.mp3",.3,!0]),_AUDIO.push(["menu","long/menu.mp3",.3,!0]),_AUDIO.push(["ding","ding.mp3",.1]),_AUDIO.push(["win","win.mp3",.4]),_AUDIO.push(["blip","blip.mp3",.1]),_AUDIO.push(["hammer","hammer.mp3",.05]),_AUDIO.push(["tack","tack.mp3",1]),_AUDIO.push(["tweets","tweets.mp3",.5]),_AUDIO.push(["highlazer","highlazer.mp3",.5]),_AUDIO.push(["shortlazer","shortlazer.mp3",.5]),_AUDIO.push(["lose","lose.mp3",.5]),_AUDIO.push(["superwin","superwin.mp3",.5]),_AUDIO.push(["turnon","turnon.mp3",.5]),_AUDIO.push(["takeoff","takeoff.mp3",.5]),_AUDIO.push(["retroending","retroending.mp3",.5]),_AUDIO.push(["ratchet","ratchet.mp3",.5]),_AUDIO.push(["spend","spend.mp3",.5]),_AUDIO.push(["munch","munch.mp3",.5]),_AUDIO.push(["crank","crank.mp3",.5]),_AUDIO.push(["denied","denied.mp3",.5]),_AUDIO.push(["hallknock","hallknock.mp3",.5]),_AUDIO.push(["goodding","goodding.mp3",.5]),_AUDIO.push(["blonk","blonk.mp3",.5]),_AUDIO.push(["toggle","toggle.mp3",.5]),_AUDIO.push(["creak","creak.mp3",.5]),_AUDIO.push(["slot","slot.mp3",.5]),_AUDIO.push(["rollkaching","rollkaching.mp3",.5]),_AUDIO.push(["coinspin","coinspin.mp3",.5]);var settings=function(){game.resetSettings=function(){game.settings={},game.settings.cash=5e3,game.settings.happyPeeps=0,game.settings.unHappyPeeps=0,game.settings.locked={},game.settings.locked.level1=!1,game.settings.locked.normal=!1,game.settings.locked.easy=!1,game.settings.locked.sandbox=!1,game.settings.locked.nightmare=!1,"jamdonut.com"==window.location.hostname||window.location.hostname},game.isLocked=function(name){return!!game.settings.locked[name]&&game.settings.locked[name]},game.unlock=function(name){game.settings.locked[name]=!1,game.ui.updateAll()},game.resetSettings()};bootStrap.push(settings);var tool=function(){game.upgrades={},console.debug(_LANG),game.upgrades.tier1=[{name:"basicfurni",cost:500,across:21,d1:"Contains Snack Machine and Toilets",down:9,readName:_LANG.BASICFURNI,runFunction:function(){game.settings.locked.basicfurni=!1,game.settings.locked.chair=!1,game.settings.locked.door=!1,game.settings.locked.toilet=!1,game.settings.locked.snackmachine=!1,game.ui.mainUI()}},{name:"readthoughts",cost:1e3,across:21,d1:"Find out what customers think",down:10,readName:_LANG.READTHOUGHTS,runFunction:function(){game.settings.locked.readthoughts=!1,game.apis.ng.unlockMedal("Unlocked mind control!"),game.ui.mainUI()}},{name:"elec_prices",cost:1e3,across:22,d1:"Click on machines to set prices",down:10,readName:_LANG.U2,runFunction:function(){game.settings.locked.elec_prices=!1}},{name:"janitor",cost:2e3,across:19,down:9,d1:"Hire janitors to clean up",readName:_LANG.JANITOR,runFunction:function(){game.settings.locked.janitor=!1,game.apis.ng.unlockMedal("Unlocked janitors!"),game.ui.mainUI()}},{name:"redmachines",cost:500,across:18,down:10,d1:"Red Pinball and Red arcade machine",readName:_LANG.REDMACHINES,runFunction:function(){game.settings.locked.redmachines=!1,game.settings.locked.monkeykong=!1,game.settings.locked.fireball=!1,game.ui.mainUI()}},{name:"bluemachines",cost:1500,across:19,down:10,d1:"Blue pinball and Blue arcade machine",readName:_LANG.BLUEMACHINES,runFunction:function(){game.settings.locked.bluemachines=!1,game.settings.locked.pacboy=!1,game.settings.locked.twinklezone=!1,game.ui.mainUI()}},{name:"workman",cost:1e3,across:20,down:9,d1:"Hire more builders",readName:_LANG.WORKMAN,runFunction:function(){game.settings.locked.workman=!1,game.ui.mainUI()}},{name:"advancedfurni",cost:1500,across:22,down:9,d1:"Contains snack machine and lamps",readName:_LANG.ADVANCEDFURNI,runFunction:function(){game.settings.locked.advancedfurni=!1,game.settings.locked.pixellamp=!1,game.settings.locked.couch=!1,game.settings.locked.redneonstrip=!1,game.settings.locked.sodamachine=!1,game.settings.locked.coffeetable=!1,game.ui.mainUI()}},{name:"2tables1",cost:1500,across:18,down:11,d1:"Contains pool table and table tennis",readName:_LANG.TABLEPACK1,runFunction:function(){game.settings.locked["2tables1"]=!1,game.settings.locked.pooltable=!1,game.settings.locked.tabletennis=!1,game.ui.mainUI()}},{name:"2tables2",cost:1e4,across:19,down:11,d1:"Contains air hockey and tablefootball",readName:_LANG.TABLEPACK2,runFunction:function(){game.settings.locked["2tables2"]=!1,game.settings.locked.airhockey=!1,game.settings.locked.tablefootball=!1,game.ui.mainUI()}}]};bootStrap.push(tool);bootStrap.push(function(){dismantle={name:"dismantle",readName:_LANG.DESTROY,codename:"dismantle",description:_LANG.DESC_DESTROY,cost:0,across:31,down:4,blocks:1,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{dismantle:!0,across:7,down:16}},game.world.objectTemplates={tables:[dismantle,{name:"arcade",readName:_LANG.POOLTABLE,codename:"pooltable",description:_LANG.WAITING_FOR_DESCRIPTION,cost:1e4,across:20,down:2,blocks:5,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{big:!0,canBeTaken:!1,buildFurni:!0,standArea4:!0,buildFunction:"arcademachine",pay:120}},{name:"arcade",readName:_LANG.AIRHOCKEY,codename:"airhockey",description:_LANG.WAITING_FOR_DESCRIPTION,cost:12500,across:22,down:2,blocks:5,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{big:!0,buildFurni:!0,standArea4:!0,buildFunction:"arcademachine",pay:180}},{name:"arcade",readName:_LANG.TABLETENNIS,codename:"tabletennis",description:_LANG.WAITING_FOR_DESCRIPTION,cost:12500,across:20,down:4,blocks:5,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{big:!0,buildFurni:!0,standArea4:!0,buildFunction:"arcademachine",pay:150}},{name:"arcade",readName:_LANG.TABLEFOOTBALL,codename:"tablefootball",description:_LANG.WAITING_FOR_DESCRIPTION,cost:19500,across:22,down:4,blocks:5,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{big:!0,buildFurni:!0,standArea4:!0,buildFunction:"arcademachine",pay:220}}],machines:[dismantle,{name:"change",codename:"changemachine",readName:_LANG.CHANGE_MACHINE,description:_LANG.WAITING_FOR_DESCRIPTION,cost:100,across:5,down:1,blocks:4,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,tutNumber:3,onCreate:!1,data:{canBeTaken:!1,buildFurni:!0,standArea4:!0,buildFunction:"arcademachine",tutNumber:4}},{name:"arcade",codename:"monkeykong",readName:_LANG.MONKEYKONG,description:_LANG.WAITING_FOR_DESCRIPTION,cost:1e3,across:1,down:23,blocks:4,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{buildFurni:!0,standArea4:!0,buildFunction:"arcademachine",pay:25}},{name:"arcade",codename:"pacboy",readName:_LANG.PACBOY,description:_LANG.WAITING_FOR_DESCRIPTION,cost:5e3,across:1,down:25,blocks:4,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{buildFurni:!0,standArea4:!0,buildFunction:"arcademachine",pay:50}},{name:"arcade",codename:"froggy",readName:_LANG.FROGGY,description:_LANG.WAITING_FOR_DESCRIPTION,cost:8e3,across:1,down:27,blocks:4,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{buildFurni:!0,standArea4:!0,buildFunction:"arcademachine",pay:100}},{name:"pinball",codename:"sunwars",readName:_LANG.SUNWARS,description:_LANG.WAITING_FOR_DESCRIPTION,cost:200,across:1,down:13,blocks:2,quality:1,dirs:4,tutNumber:7,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{buildFurni:!0,elecUnits:2,standArea3:!0,pay:1,buildFunction:"arcademachine",tutNumber:8}},{name:"pinball",codename:"fireball",readName:_LANG.FIREBALL,description:_LANG.WAITING_FOR_DESCRIPTION,cost:500,across:1,down:15,blocks:2,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{buildFurni:!0,elecUnits:5,standArea3:!0,pay:25,buildFunction:"arcademachine"}},{name:"pinball",codename:"twinklezone",readName:_LANG.TWINKLEZONE,description:_LANG.WAITING_FOR_DESCRIPTION,cost:750,across:1,down:17,blocks:2,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{buildFurni:!0,elecUnits:7,standArea3:!0,pay:50,buildFunction:"arcademachine"}}],furni:[dismantle,{name:"door",readName:_LANG.DOOR,codename:"door",description:_LANG.WAITING_FOR_DESCRIPTION,cost:50,across:1,down:2,blocks:1,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{buildDoor:!0,wallBuild:!0,isDoor:!0,buildTicker:game.tickers.door}},{name:"seat",readName:_LANG.CHAIR,codename:"chair",description:_LANG.DESC_CHAIR,cost:50,across:1,down:1,blocks:1,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{buildFurni:!0,anim:"chatter"}},{name:"toilet",readName:_LANG.TOILET,codename:"toilet",description:_LANG.WAITING_FOR_DESCRIPTION,cost:50,across:1,down:7,blocks:1,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{buildFurni:!0,buildFunction:"toilet"}},{name:"lamp",readName:_LANG.PIXELLAMP,codename:"pixellamp",description:_LANG.WAITING_FOR_DESCRIPTION,cost:50,across:1,down:21,blocks:4,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{buildFurni:!0,buildFunction:"pixellamp"}},{name:"redneonstrip",readName:_LANG.REDNEONSTRIP,codename:"redneonstrip",description:_LANG.WAITING_FOR_DESCRIPTION,cost:50,across:1,down:20,blocks:1,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{buildFurni:!0,wallBuild:!0,buildFunction:"neonstrip",color:"red"}},{name:"seat",readName:_LANG.COUCH,codename:"couch",description:_LANG.WAITING_FOR_DESCRIPTION,cost:100,across:1,down:4,blocks:1,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{buildFurni:!0,anim:"chatter"}},{name:"food",readName:_LANG.SNACKMACHINE,codename:"snackmachine",description:_LANG.WAITING_FOR_DESCRIPTION,cost:250,across:1,down:11,blocks:4,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{buildFurni:!0,elecUnits:20,standArea4:!0,pay:25,anim:"snack",buildFunction:"arcademachine"}},{name:"food",readName:_LANG.SODAMACHINE,codename:"sodamachine",description:_LANG.WAITING_FOR_DESCRIPTION,cost:250,across:1,down:9,blocks:4,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{buildFurni:!0,elecUnits:25,standArea4:!0,pay:25,anim:"drink",buildFunction:"arcademachine"}},{name:"coffeetable",readName:_LANG.COFFEETABLE,codename:"coffeetable",description:_LANG.WAITING_FOR_DESCRIPTION,cost:150,across:1,down:5,blocks:2,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{buildFurni:!0}},{name:"smalltable",readName:_LANG.SMALL_TABLE,codename:"smalltable",description:_LANG.WAITING_FOR_DESCRIPTION,cost:100,across:1,down:3,blocks:1,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{buildFurni:!0}}],staff:[{name:"workman",readName:_LANG.WORKMAN,codename:"workman",description:_LANG.WAITING_FOR_DESCRIPTION,cost:5e3,across:1,blocks:1,down:1,data:{maxJobs:20}},{name:"janitor",readName:_LANG.JANITOR,codename:"janitor",description:_LANG.WAITING_FOR_DESCRIPTION,cost:2500,across:1,down:2,blocks:1,data:{maxJobs:1}}],walls:[dismantle,{name:"buildroom",readName:_LANG.BUILDWALL,codename:"buildroom",description:_LANG.WAITING_FOR_DESCRIPTION,cost:0,across:30,down:2,blocks:1,collide:"allowwall",data:{buildWall:!0,fill:!0,wallBuild:!0,across:1,down:7}},{name:"destroywall",readName:_LANG.DESTROYWALL,codename:"destroywall",description:_LANG.WAITING_FOR_DESCRIPTION,cost:0,across:31,down:2,blocks:1,data:{bulldoze:!0,wallBuild:!0,across:1,down:7}}],floors:[{name:"blue",readName:_LANG.BLUE,codename:"floor",description:_LANG.WAITING_FOR_DESCRIPTION,cost:0,across:1,down:8,blocks:1,data:{buildFloor:!0,fill:!0,killOnBuild:!0,friction:0,across:1,down:8}},{name:"tiled",readName:_LANG.TILED,codename:"floor",description:_LANG.WAITING_FOR_DESCRIPTION,cost:0,across:1,down:9,blocks:1,data:{buildFloor:!0,fill:!0,killOnBuild:!0,friction:0,across:1,down:9}},{name:"concrete",readName:_LANG.CONCRETE,codename:"floor",description:_LANG.WAITING_FOR_DESCRIPTION,cost:0,across:1,down:10,blocks:1,data:{buildFloor:!0,fill:!0,killOnBuild:!0,friction:0,across:1,down:10}},{name:"red",readName:_LANG.RED,codename:"floor",description:_LANG.WAITING_FOR_DESCRIPTION,cost:0,across:1,down:11,blocks:1,data:{buildFloor:!0,fill:!0,killOnBuild:!0,friction:0,across:1,down:11}},{name:"wood",readName:_LANG.WOOD,codename:"floor",description:_LANG.WAITING_FOR_DESCRIPTION,cost:0,across:1,down:12,blocks:1,data:{buildFloor:!0,fill:!0,killOnBuild:!0,friction:0,across:1,down:12}},{name:"gravel",readName:_LANG.GRAVEL,codename:"floor",description:_LANG.WAITING_FOR_DESCRIPTION,cost:0,across:1,down:13,blocks:1,data:{buildFloor:!0,fill:!0,killOnBuild:!0,friction:0,across:1,down:13}}],utilities:[{name:"filingcabinet",codename:"filingcabinet",readName:_LANG.FILINGCABINET,description:_LANG.WAITING_FOR_DESCRIPTION,cost:1e3,across:5,down:3,blocks:4,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{canBeTaken:!1,buildFurni:!0,standArea4:!0,buildFunction:"filingcabinet"}},{name:"officedesk",readName:_LANG.OFFICEDESK,codename:"officedesk",description:_LANG.WAITING_FOR_DESCRIPTION,cost:2500,across:5,down:5,blocks:2,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{buildFurni:!0}},{name:"bin",readName:_LANG.BIN,codename:"bin",description:_LANG.WAITING_FOR_DESCRIPTION,cost:150,across:5,down:7,blocks:1,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{buildFurni:!0,buildFunction:"bin"}},{name:"power",readName:_LANG.SMALLPOWER,codename:"smallpower",description:_LANG.WAITING_FOR_DESCRIPTION,cost:1e3,across:5,down:8,blocks:1,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{powerUnits:5,buildFurni:!0,buildFunction:"power"}},{name:"power",readName:_LANG.BIGPOWER,codename:"bigpower",description:_LANG.WAITING_FOR_DESCRIPTION,cost:1e4,across:20,down:6,blocks:5,quality:1,dirs:4,offsetX:0,offsetY:0,tick:!1,mouseDown:!1,onCreate:!1,data:{big:!0,canBeTaken:!1,buildFurni:!0,standArea4:!0,buildFunction:"power"}}],planning:[{name:"markroom",readName:_LANG.NEW_ROOM,description:_LANG.WAITING_FOR_DESCRIPTION,cost:50,across:1,down:1,data:{buildFurni:!0}}],other:{trash:{name:"trash",readName:_LANG.WOOD,description:_LANG.WAITING_FOR_DESCRIPTION,cost:0,across:30,down:5,blocks:1,data:{cleanup:!0,fill:!0,killOnBuild:!0,friction:0,across:30,down:5}}}},game.world.objectTemplates.machines.sort(function(a,b){return a.cost<b.cost?-1:a.cost>b.cost?1:0})});var tool=function(){game.needs=["seat","seat","seat","food","food","food","pinball","pinball","pinball","change","pinball","toilet","toilet","arcade","arcade","arcade","change"]};bootStrap.push(tool);bootStrap.push(function(){game.allMissions={},game.allMissions.starter1={description:_LANG.M1,payout:3e3,checkMission:function(){return 1<=game.propCount(game.world.index.change)}},game.allMissions.starter2={description:_LANG.M2,payout:1e3,checkMission:function(){return 1<=game.propCount(game.world.index.pinball)}},game.allMissions.starter3={description:_LANG.M3,payout:1e3,checkMission:function(){return!0===game.isOpen}},game.allMissions.tutcomplete={description:_LANG.M4,payout:1e3,checkMission:function(){return 1<=game.propCount(game.world.index.food)}},game.allMissions.starter4={description:_LANG.M4,payout:1e3,checkMission:function(){return 1<=game.propCount(game.world.index.snack)}},buildXOf=function(howMany,whatCalled,whatLangRef,payout){return{description:_LANG.MISSION_DYNAMIC_1+howMany+" "+_LANG[whatLangRef]+_LANG.MISSION_DYNAMIC_2,payout:payout,checkMission:function(){return game.propCount(game.world.index[whatCalled])>=howMany}}},game.allMissions.toilets_3=buildXOf(3,"toilet","TOILETS",500),game.allMissions.toilets_5=buildXOf(5,"toilet","TOILETS",1e3),game.allMissions.toilets_10=buildXOf(10,"toilet","TOILETS",2e3),game.allMissions.pinball_3=buildXOf(3,"pinball","PINBALL_MACHINES",1e3),game.allMissions.pinball_10=buildXOf(10,"pinball","PINBALL_MACHINES",1500),game.allMissions.pinball_15=buildXOf(15,"pinball","PINBALL_MACHINES",3500),game.allMissions.arcade_3=buildXOf(3,"arcade","ARCADE_MACHINES",2e3),game.allMissions.arcade_10=buildXOf(10,"arcade","ARCADE_MACHINES",5500),game.allMissions.arcade_15=buildXOf(15,"arcade","ARCADE_MACHINES",9e3),game.allMissions.complete_tutorial={description:_LANG.M5,payout:1e3,checkMission:function(){return 5<=game.settings.happyPeeps}}});bootStrap.push(function(){game.challenges={},openSign=',{"x":384,"y":704,"height":256,"width":128,"framex":1472,"framey":64,"tileSetName":"png/furni.png","built":true,"id":"object-191","data":{"buildFunction":"openSign"},"name":null,"alpha":1}',game.setupDefaultLocks=function(){for(game.patients.newAvailablePatient("manager"),game.patients.newAvailablePatient("manager"),game.patients.newAvailablePatient("manager"),game.patients.newAvailablePatient("manager"),game.patients.newAvailablePatient("manager"),game.patients.newAvailablePatient("manager"),game.patients.newAvailablePatient("builder"),game.patients.newAvailablePatient("builder"),game.patients.newAvailablePatient("builder"),game.patients.newAvailablePatient("builder"),game.patients.newAvailablePatient("builder"),game.patients.newAvailablePatient("janitor"),game.patients.newAvailablePatient("janitor"),game.patients.newAvailablePatient("janitor"),game.patients.newAvailablePatient("janitor"),game.patients.newAvailablePatient("janitor"),i=0;i<game.world.objectTemplates.machines.length;i++)game.settings.locked[game.world.objectTemplates.machines[i].codename]=!0;game.setMarketingSettings(),game.settings.locked.staff_builder=!0,game.settings.locked.staff_janitor=!0,game.settings.locked.hire_staff=!0,game.settings.locked.game_log=!0,game.settings.locked.elec_prices=!0,game.settings.locked.upgrades=!0,game.settings.locked.missions=!0,game.settings.locked.utilities=!0,game.settings.locked.basicfurni=!0,game.settings.locked.chair=!0,game.settings.locked.door=!0,game.settings.locked.toilet=!0,game.settings.locked.snackmachine=!0,game.settings.locked.builder=!0,game.settings.locked.janitor=!0,game.settings.locked.advancedfurni=!0,game.settings.locked.readthoughts=!0,game.settings.locked.bluemachines=!0,game.settings.locked.redmachines=!0,game.settings.locked.tabletennis=!0,game.settings.locked.pooltable=!0,game.settings.locked.tablefootball=!0,game.settings.locked.airhockey=!0,game.settings.locked.pixellamp=!0,game.settings.locked.couch=!0,game.settings.locked.redneonstrip=!0,game.settings.locked.sodamachine=!0,game.settings.locked.coffeetable=!0,game.settings.locked.smallpower=!0,game.settings.locked.bigpower=!0,game.settings.locked.filingcabinet=!0,game.settings.locked.officedesk=!0,game.settings.locked.bin=!0,game.settings.locked["2tables1"]=!0,game.settings.locked["2tables2"]=!0,game.settings.locked.dismantle=!1,game.settings.locked.sandbox=!1,game.settings.locked.normal=!1,game.settings.locked.easy=!1,game.settings.locked.nightmare=!1},game.challenges.level1={name:_LANG.C1,description:_LANG.C1_DESC,tileset:"default",startElecRate:10,challenges:["starter1","pinball_3","toilets_3","arcade_3","pinball_10","toilets_5","arcade_10","pinball_15","arcade_15","toilets_10"],load:function(){game.track.event("Started tutorial",""),game.resetSettings(),game.settings.locked.floors=!0,game.settings.locked.walls=!0,game.settings.locked.tables=!0,game.settings.locked.furni=!0,game.settings.locked.machines=!0,game.settings.locked.staff=!0,game.setupDefaultLocks(),game.settings.happyPeeps=65,game.settings.locked.sandbox=!1,game.settings.locked.normal=!1,game.settings.locked.easy=!1,loadFile='{"drawMatrix":[[[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10]],[[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13]],[[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13]],[[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13]],[[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10]],[[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,10],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,10],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[3,2],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,6],[1,10],[4,6],[3,3],[3,3],[3,3],[3,4],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[5,5],[3,3],[3,3],[3,3],[3,3],[3,3],[3,4],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,12],[1,12],[1,12],[1,12],[1,12],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[3,2],[3,3],[3,3],[3,3],[3,3],[5,6],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,12],[1,12],[1,12],[1,12],[1,12],[3,5],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,9],[1,9],[1,9],[1,9],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,12],[1,12],[1,12],[1,12],[1,12],[1,12],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[3,5],[1,9],[1,9],[1,9],[1,9],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,12],[1,12],[1,12],[1,12],[1,12],[4,5],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,9],[1,9],[1,9],[1,9],[1,9],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,12],[1,12],[1,12],[1,12],[1,12],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,5],[1,9],[1,9],[1,9],[1,9],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,12],[1,12],[1,12],[1,12],[1,12],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,9],[1,9],[1,9],[1,9],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[5,2],[3,3],[3,3],[3,3],[3,3],[3,3],[6,6],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[6,6],[3,3],[3,3],[3,3],[3,3],[5,4],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]]],"life":[{"x":960,"y":960,"data":{"speed":91,"across":1,"down":1,"patient":{"name":"Nickname: Shremblo","rawName":"Jammy","bio":"Loves to play FPS games","love":100,"compliance":20,"creativity":100,"skill":"manager","skillLevel":3},"body":{"hat":3,"head":2,"across":1,"down":1},"female":false,"jobs":["builder","miner","janitor"],"needCount":0,"need":"gohome"}}],"objects":[{"x":256,"y":704,"height":256,"width":128,"framex":1344,"framey":1344,"tileSetName":"png/furni.png","built":true,"id":"object-292","data":{"buildFunction":"car"},"name":"car","alpha":1},{"x":256,"y":1024,"height":256,"width":128,"framex":1344,"framey":1600,"tileSetName":"png/furni.png","built":true,"id":"object-293","data":{"buildFunction":"car"},"name":"car","alpha":1},{"x":384,"y":704,"height":256,"width":128,"framex":1472,"framey":64,"tileSetName":"png/furni.png","built":true,"id":"object-208","itemid":"0","data":{"buildFunction":"openSign","maxPay":null},"name":"openSign","alpha":1},{"x":64,"y":64,"height":256,"width":128,"framex":1472,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-209","itemid":"1","data":{"maxPay":null},"name":null,"alpha":1},{"x":64,"y":384,"height":256,"width":128,"framex":1472,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-210","itemid":"2","data":{"maxPay":null},"name":null,"alpha":1},{"x":64,"y":704,"height":256,"width":128,"framex":1472,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-211","itemid":"3","data":{"maxPay":null},"name":null,"alpha":1},{"x":64,"y":1024,"height":256,"width":128,"framex":1472,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-212","itemid":"4","data":{"maxPay":null},"name":null,"alpha":1},{"x":64,"y":1344,"height":256,"width":128,"framex":1472,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-213","itemid":"5","data":{"maxPay":null},"name":null,"alpha":1},{"x":256,"y":192,"height":256,"width":128,"framex":1600,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-214","itemid":"6","data":{"maxPay":null},"name":null,"alpha":1},{"x":256,"y":512,"height":256,"width":128,"framex":1600,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-215","itemid":"7","data":{"maxPay":null},"name":null,"alpha":1},{"x":256,"y":832,"height":256,"width":128,"framex":1600,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-216","itemid":"8","data":{"maxPay":null},"name":null,"alpha":1},{"x":256,"y":1152,"height":256,"width":128,"framex":1600,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-217","itemid":"9","data":{"maxPay":null},"name":null,"alpha":1},{"x":256,"y":1472,"height":256,"width":128,"framex":1600,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-218","itemid":"10","data":{"maxPay":null},"name":null,"alpha":1},{"x":1536,"y":448,"height":64,"width":64,"framex":0,"framey":64,"tileSetName":"png/furni.png","built":true,"id":"object-219","itemid":"11","data":{"buildDoor":false,"wallBuild":true,"isDoor":true,"maxPay":null},"name":"door","direction":0,"readName":"Door","alpha":1},{"x":512,"y":896,"height":64,"width":64,"framex":192,"framey":64,"tileSetName":"png/furni.png","built":true,"id":"object-220","itemid":"12","data":{"buildDoor":false,"wallBuild":true,"isDoor":true,"maxPay":null},"name":"door","direction":3,"readName":"Door","alpha":1},{"x":1600,"y":896,"height":64,"width":64,"framex":0,"framey":64,"tileSetName":"png/furni.png","built":true,"id":"object-221","itemid":"13","data":{"buildDoor":false,"wallBuild":true,"isDoor":true,"maxPay":null},"name":"door","direction":0,"readName":"Door","alpha":1},{"x":576,"y":1152,"height":64,"width":64,"framex":64,"framey":192,"tileSetName":"png/furni.png","built":true,"id":"object-222","itemid":"14","data":{"buildFurni":false,"anim":"chatter","maxPay":null},"name":"seat","direction":1,"readName":"Couch","alpha":1},{"x":576,"y":1088,"height":64,"width":64,"framex":64,"framey":192,"tileSetName":"png/furni.png","built":true,"id":"object-223","itemid":"15","data":{"buildFurni":false,"anim":"chatter","maxPay":null},"name":"seat","direction":1,"readName":"Couch","alpha":1},{"x":640,"y":1088,"height":128,"width":64,"framex":192,"framey":256,"tileSetName":"png/furni.png","built":true,"id":"object-224","itemid":"16","data":{"buildFurni":false,"maxPay":null},"name":"coffeetable","direction":2,"readName":"Coffee table","alpha":1},{"x":704,"y":1152,"height":64,"width":64,"framex":192,"framey":192,"tileSetName":"png/furni.png","built":true,"id":"object-225","itemid":"17","data":{"buildFurni":false,"anim":"chatter","maxPay":null},"name":"seat","direction":3,"readName":"Couch","alpha":1},{"x":704,"y":1088,"height":64,"width":64,"framex":192,"framey":192,"tileSetName":"png/furni.png","built":true,"id":"object-226","itemid":"18","data":{"buildFurni":false,"anim":"chatter","maxPay":null},"name":"seat","direction":3,"readName":"Couch","alpha":1},{"x":1472,"y":1152,"height":64,"width":64,"framex":128,"framey":384,"tileSetName":"png/furni.png","built":true,"id":"object-227","itemid":"19","data":{"buildFurni":false,"maxPay":null},"name":"toilet","direction":2,"readName":"Toilet","alpha":1},{"x":1536,"y":1152,"height":64,"width":64,"framex":128,"framey":384,"tileSetName":"png/furni.png","built":true,"id":"object-228","itemid":"20","data":{"buildFurni":false,"maxPay":null},"name":"toilet","direction":2,"readName":"Toilet","alpha":1},{"x":1600,"y":1152,"height":64,"width":64,"framex":128,"framey":384,"tileSetName":"png/furni.png","built":true,"id":"object-229","itemid":"21","data":{"buildFurni":false,"maxPay":null},"name":"toilet","direction":2,"readName":"Toilet","alpha":1},{"x":640,"y":960,"height":128,"width":64,"framex":0,"framey":1280,"tileSetName":"png/furni.png","built":true,"id":"object-230","itemid":"22","data":{"buildFurni":false,"buildFunction":"pixellamp","maxPay":null},"name":"lamp","direction":3,"readName":"Pixel lamp","alpha":1},{"x":1344,"y":448,"height":128,"width":64,"framex":0,"framey":640,"tileSetName":"png/furni.png","built":true,"id":"object-231","itemid":"23","data":{"buildFurni":false,"elecUnits":20,"standArea4":true,"pay":25,"anim":"snack","buildFunction":"arcademachine","defaultPay":25,"maxPay":31.25},"name":"food","direction":3,"readName":"Snack machine","alpha":1},{"x":1408,"y":448,"height":128,"width":64,"framex":0,"framey":640,"tileSetName":"png/furni.png","built":true,"id":"object-232","itemid":"24","data":{"buildFurni":false,"elecUnits":20,"standArea4":true,"pay":25,"anim":"snack","buildFunction":"arcademachine","defaultPay":25,"maxPay":31.25},"name":"food","direction":3,"readName":"Snack machine","alpha":1},{"x":1600,"y":448,"height":128,"width":64,"framex":0,"framey":512,"tileSetName":"png/furni.png","built":true,"id":"object-233","itemid":"25","data":{"buildFurni":false,"elecUnits":25,"standArea4":true,"pay":25,"anim":"drink","buildFunction":"arcademachine","defaultPay":25,"maxPay":31.25},"name":"food","direction":3,"readName":"Soda machine","alpha":1},{"x":1664,"y":448,"height":128,"width":64,"framex":0,"framey":512,"tileSetName":"png/furni.png","built":true,"id":"object-234","itemid":"26","data":{"buildFurni":false,"elecUnits":25,"standArea4":true,"pay":25,"anim":"drink","buildFunction":"arcademachine","defaultPay":25,"maxPay":31.25},"name":"food","direction":3,"readName":"Soda machine","alpha":1},{"x":1152,"y":448,"height":128,"width":64,"framex":0,"framey":1536,"tileSetName":"png/furni.png","built":true,"id":"object-235","itemid":"27","data":{"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","pay":50,"defaultPay":50,"maxPay":62.5},"name":"arcade","direction":3,"readName":"Pacboy","alpha":1},{"x":1088,"y":448,"height":128,"width":64,"framex":0,"framey":1536,"tileSetName":"png/furni.png","built":true,"id":"object-236","itemid":"28","data":{"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","pay":50,"defaultPay":50,"maxPay":62.5},"name":"arcade","direction":3,"readName":"Pacboy","alpha":1},{"x":1024,"y":448,"height":128,"width":64,"framex":0,"framey":1536,"tileSetName":"png/furni.png","built":true,"id":"object-237","itemid":"29","data":{"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","pay":50,"defaultPay":50,"maxPay":62.5},"name":"arcade","direction":3,"readName":"Pacboy","alpha":1},{"x":960,"y":448,"height":128,"width":64,"framex":0,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-238","itemid":"30","data":{"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","pay":100,"defaultPay":100,"maxPay":125},"name":"arcade","direction":3,"readName":"Froggy","alpha":1},{"x":896,"y":448,"height":128,"width":64,"framex":0,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-239","itemid":"31","data":{"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","pay":100,"defaultPay":100,"maxPay":125},"name":"arcade","direction":3,"readName":"Froggy","alpha":1},{"x":832,"y":448,"height":128,"width":64,"framex":0,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-240","itemid":"32","data":{"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","pay":100,"defaultPay":100,"maxPay":125},"name":"arcade","direction":3,"readName":"Froggy","alpha":1},{"x":832,"y":704,"height":128,"width":64,"framex":0,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-241","itemid":"33","data":{"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","pay":100,"defaultPay":100,"maxPay":125},"name":"arcade","direction":3,"readName":"Froggy","alpha":1},{"x":896,"y":704,"height":128,"width":64,"framex":0,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-242","itemid":"34","data":{"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","pay":100,"defaultPay":100,"maxPay":125},"name":"arcade","direction":3,"readName":"Froggy","alpha":1},{"x":960,"y":704,"height":128,"width":64,"framex":0,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-243","itemid":"35","data":{"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","pay":100,"defaultPay":100,"maxPay":125},"name":"arcade","direction":3,"readName":"Froggy","alpha":1},{"x":832,"y":128,"height":128,"width":64,"framex":0,"framey":896,"tileSetName":"png/furni.png","built":true,"id":"object-244","itemid":"36","data":{"buildFurni":false,"elecUnits":5,"standArea3":true,"pay":25,"buildFunction":"arcademachine","defaultPay":25,"maxPay":31.25},"name":"pinball","direction":3,"readName":"Fireball","alpha":1},{"x":896,"y":128,"height":128,"width":64,"framex":0,"framey":896,"tileSetName":"png/furni.png","built":true,"id":"object-245","itemid":"37","data":{"buildFurni":false,"elecUnits":5,"standArea3":true,"pay":25,"buildFunction":"arcademachine","defaultPay":25,"maxPay":31.25},"name":"pinball","direction":3,"readName":"Fireball","alpha":1},{"x":960,"y":128,"height":128,"width":64,"framex":0,"framey":896,"tileSetName":"png/furni.png","built":true,"id":"object-246","itemid":"38","data":{"buildFurni":false,"elecUnits":5,"standArea3":true,"pay":25,"buildFunction":"arcademachine","defaultPay":25,"maxPay":31.25},"name":"pinball","direction":3,"readName":"Fireball","alpha":1},{"x":1024,"y":128,"height":128,"width":64,"framex":0,"framey":768,"tileSetName":"png/furni.png","built":true,"id":"object-247","itemid":"39","data":{"buildFurni":false,"elecUnits":2,"standArea3":true,"pay":1,"buildFunction":"arcademachine","tutNumber":8,"defaultPay":1,"maxPay":1.25},"name":"pinball","direction":3,"readName":"Sun Wars","alpha":1},{"x":1088,"y":128,"height":128,"width":64,"framex":0,"framey":768,"tileSetName":"png/furni.png","built":true,"id":"object-248","itemid":"40","data":{"buildFurni":false,"elecUnits":2,"standArea3":true,"pay":1,"buildFunction":"arcademachine","tutNumber":8,"defaultPay":1,"maxPay":1.25},"name":"pinball","direction":3,"readName":"Sun Wars","alpha":1},{"x":1152,"y":128,"height":128,"width":64,"framex":0,"framey":768,"tileSetName":"png/furni.png","built":true,"id":"object-249","itemid":"41","data":{"buildFurni":false,"elecUnits":2,"standArea3":true,"pay":1,"buildFunction":"arcademachine","tutNumber":8,"defaultPay":1,"maxPay":1.25},"name":"pinball","direction":3,"readName":"Sun Wars","alpha":1},{"x":1088,"y":704,"height":128,"width":128,"framex":1344,"framey":64,"tileSetName":"png/furni.png","built":true,"id":"object-250","itemid":"42","data":{"big":true,"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","pay":180,"defaultPay":180,"maxPay":225},"name":"arcade","direction":3,"readName":"Airhockey","alpha":1},{"x":1280,"y":704,"height":128,"width":128,"framex":1216,"framey":64,"tileSetName":"png/furni.png","built":true,"id":"object-251","itemid":"43","data":{"big":true,"canBeTaken":false,"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","pay":120,"defaultPay":120,"maxPay":150},"name":"arcade","direction":3,"readName":"Pool table","alpha":1}],"settings":false,"cash":100,"isOpen":false}',game.saves.load(loadFile),game.ui.updateAll(),game.started=!0,!(game.isTut=!0)!==game.showTut&&(game.ui.tutLevel1(),game.nextTutorial()),game.cash=100}},game.challenges.normal={name:_LANG.C2,description:_LANG.C2_DESC,requires:_LANG.C2_REQ,tileset:"default",startElecRate:10,challenges:["starter1","pinball_3","toilets_3","arcade_3","pinball_10","toilets_5","arcade_10","pinball_15","arcade_15","toilets_10"],load:function(){game.track.event("Started Normal mode",""),game.resetSettings(),game.setupDefaultLocks(),game.settings.locked.floors=!1,game.settings.locked.walls=!1,game.settings.locked.tables=!1,game.settings.locked.furni=!1,game.settings.locked.machines=!1,game.settings.locked.staff=!1,game.settings.locked.utilities=!1,game.settings.locked.upgrades=!1,game.settings.locked.missions=!1,game.settings.locked.staff_builder=!1,game.settings.locked.hire_staff=!1,game.settings.locked.game_log=!1,game.settings.locked.changemachine=!1,game.settings.locked.sunwars=!1,game.settings.happyPeeps=65,loadFile='{"drawMatrix":[[[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10]],[[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13]],[[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13]],[[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13]],[[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10]],[[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,10],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,10],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[3,2],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,6],[1,10],[4,6],[3,3],[3,3],[3,3],[3,4],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[5,5],[3,3],[3,3],[3,3],[3,3],[3,3],[3,4],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,12],[1,12],[1,12],[1,12],[1,12],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[3,2],[3,3],[3,3],[3,3],[3,3],[5,6],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,12],[1,12],[1,12],[1,12],[1,12],[3,5],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,9],[1,9],[1,9],[1,9],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,12],[1,12],[1,12],[1,12],[1,12],[1,12],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[3,5],[1,9],[1,9],[1,9],[1,9],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,12],[1,12],[1,12],[1,12],[1,12],[4,5],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,9],[1,9],[1,9],[1,9],[1,9],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,12],[1,12],[1,12],[1,12],[1,12],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,5],[1,9],[1,9],[1,9],[1,9],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,12],[1,12],[1,12],[1,12],[1,12],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,9],[1,9],[1,9],[1,9],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[5,2],[3,3],[3,3],[3,3],[3,3],[3,3],[6,6],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[6,6],[3,3],[3,3],[3,3],[3,3],[5,4],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]]],"objects":[{"x":384,"y":704,"height":256,"width":128,"framex":1472,"framey":64,"tileSetName":"png/furni.png","built":true,"id":"object-186","data":{"buildFunction":"openSign"},"name":"openSign","alpha":1}],"settings":false,"cash":100,"isOpen":false,"life":[]}',game.saves.load(loadFile),game.ui.updateAll(),game.started=!0,game.cash=4e3,game.ui.availablePatientsMenu(),sx=21*game.tileSize,sy=21*game.tileSize,bluecar={x:4*game.tileSize,y:10*game.tileSize+game.tileSize,height:4*game.tileSize,width:2*game.tileSize,framex:sx,framey:sy,tileSetName:"png/furni.png",built:!0,id:"object-1",data:{buildFunction:"car"},name:"car",alpha:1},game.world.furniFromObject(bluecar),sx=21*game.tileSize,sy=25*game.tileSize,redcar={x:4*game.tileSize,y:15*game.tileSize+game.tileSize,height:4*game.tileSize,width:2*game.tileSize,framex:sx,framey:sy,tileSetName:"png/furni.png",built:!0,id:"object-1",data:{buildFunction:"car"},name:"car",alpha:1},game.world.furniFromObject(redcar);var x=1*game.tileSize,y=1*game.tileSize;for(offsetY=0,i=0;i<5;i++)sx=23*game.tileSize,sy=26*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.furni,sx,sy,2*game.tileSize,4*game.tileSize)),staticImage.x=x,staticImage.y=y+offsetY,staticImage.width=2*game.tileSize,staticImage.height=4*game.tileSize,game.render.objectLayer.addChild(staticImage),game.world.addObject(staticImage),light=PIXI.Sprite.fromImage("png/spotlight2-yellow.png"),light.width=2*game.tileSize,light.height=3*game.tileSize,light.x=1*game.tileSize,light.y=offsetY+game.tileSize+game.tileSize-15,light.alpha=.5,light.blendMode=PIXI.BLEND_MODES.ADD,game.render.objectLayer.addChild(light),offsetY+=5*game.tileSize;x=4*game.tileSize,y=1*game.tileSize;for(offsetY=0,i=0;i<5;i++)sx=25*game.tileSize,sy=26*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.furni,sx,sy,2*game.tileSize,4*game.tileSize)),staticImage.x=x,staticImage.y=y+offsetY+game.tileSize+game.tileSize,staticImage.width=2*game.tileSize,staticImage.height=4*game.tileSize,game.render.objectLayer.addChild(staticImage),game.world.addObject(staticImage),light=PIXI.Sprite.fromImage("png/spotlight2-yellow.png"),light.width=2*game.tileSize,light.height=3*game.tileSize,light.x=4*game.tileSize,light.y=offsetY+game.tileSize+game.tileSize+game.tileSize+game.tileSize-15,light.alpha=.5,light.blendMode=PIXI.BLEND_MODES.ADD,game.render.objectLayer.addChild(light),offsetY+=5*game.tileSize}},game.challenges.sandbox={name:_LANG.C4,description:_LANG.C4_DESC,requires:_LANG.C4_REQ,tileset:"default",startElecRate:1,challenges:Object.keys(game.allMissions),load:function(){for(lock in game.resetSettings(),game.track.event("Started sandbox",""),game.setupDefaultLocks(),game.sandboxGame(),game.tutStep=-1,game.settings.locked)game.settings.locked[lock]=!1;game.settings.locked.floors=!1,game.settings.locked.walls=!1,game.settings.locked.tables=!1,game.settings.locked.furni=!1,game.settings.locked.machines=!1,game.settings.locked.staff=!1,game.settings.locked.upgrades=!1,game.settings.locked.missions=!1,game.settings.locked.changemachine=!1,game.settings.locked.sunwars=!1,game.cash=5e6,game.started=!0,game.ui.updateAll(),game.patients.newAvailablePatient("builder"),game.ui.availablePatientsMenu()}}});bootStrap.push(function(){game.ui.data={},game.ui.data.menus=[{name:"walls",readName:_LANG.WALLS,description:"",across:18,down:3,tools:game.world.objectTemplates.walls},{name:"floors",readName:_LANG.FLOORING,description:"",across:20,down:3,tools:game.world.objectTemplates.floors},{name:"tables",readName:_LANG.LARGE_GAMES,description:"",across:24,down:3,tools:game.world.objectTemplates.tables},{name:"machines",tutNumbers:[2,6],rotate:!0,readName:_LANG.GAMES_MACHINES,description:"",across:22,down:3,tools:game.world.objectTemplates.machines},{name:"furni",rotate:!0,readName:_LANG.FURNITURE,description:"",across:19,down:3,tools:game.world.objectTemplates.furni}]});var tool=function(){game.world.attachStandAreas=function(furni){if(x=furni.x,y=furni.y,void 0!==furni.standArea||void 0!==furni.standArea2||void 0!==furni.standArea3||void 0!==furni.standArea4)return!1;if(!0===furni.data.standArea&&(furni.standArea=game.render.window(16,16,32,32,65280),game.render.objectLayer.addChild(furni.standArea)),!0===furni.data.standArea2&&(furni.standArea2=game.render.window(16,16,32,32,255),game.render.objectLayer.addChild(furni.standArea2)),!0===furni.data.standArea3&&(furni.standArea3=game.render.window(16,16,32,32,255),game.render.objectLayer.addChild(furni.standArea3)),!0===furni.data.standArea4&&(furni.standArea4=game.render.window(16,16,32,32,255),game.render.objectLayer.addChild(furni.standArea4)),!0===furni.data.standArea)switch(furni.direction){case 0:furni.standArea.x=x,furni.standArea.y=y+game.tileSize;break;case 1:furni.standArea.x=x,furni.standArea.y=y-game.tileSize;break;case 2:furni.standArea.x=x+game.tileSize,furni.standArea.y=y;break;case 3:furni.standArea.x=x-game.tileSize,furni.standArea.y=y}if(!0===furni.data.standArea2)switch(furni.direction){case 0:furni.standArea2.x=x,furni.standArea2.y=y-game.tileSize;break;case 1:furni.standArea2.x=x,furni.standArea2.y=y+game.tileSize;break;case 2:furni.standArea2.x=x-game.tileSize,furni.standArea2.y=y;break;case 3:furni.standArea2.x=x+game.tileSize,furni.standArea2.y=y}if(!0===furni.data.standArea3)switch(furni.direction){case 0:furni.standArea3.x=x,furni.standArea3.y=y;break;case 1:furni.standArea3.x=x+game.tileSize,furni.standArea3.y=y;break;case 2:furni.standArea3.x=x,furni.standArea3.y=y-16;break;case 3:furni.standArea3.x=x,furni.standArea3.y=y+game.tileSize}if(!0===furni.data.standArea4)switch(furni.direction){case 0:furni.standArea4.x=x+game.tileSize,furni.standArea4.y=y+game.tileSize;break;case 1:furni.standArea4.x=x,furni.standArea4.y=y-game.tileSize;break;case 2:furni.standArea4.x=x-game.tileSize,furni.standArea4.y=y+game.tileSize;break;case 3:furni.standArea4.x=x,furni.standArea4.y=y+game.tileSize+game.tileSize}},game.blockList=["coffeetable","arcade","pinball","change"],game.world.defaultBuildFunction=function(furni){console.debug("Doing build "+furni.name),furni.data.defaultPay=furni.data.pay,furni.data.maxPay=1.25*furni.data.pay,void 0!==furni.data.elecUnits&&game.world.addToIndex("on",furni),game.world.addToIndex(furni.name,furni),furni.interactive=!0,furni.on("pointerdown",function(){if(!0===game.ui.clicked)return!1;"pinball"===furni.name&&game.ui.showElecFurniInfo(this)}),-1!==game.blockList.indexOf(furni.name)&&game.ai.updateGrid(game.gridPos(furni.x),game.gridPos(furni.y),!1),1==furni.data.big&&game.ai.updateGrid(game.gridPos(furni.x)+1,game.gridPos(furni.y),!1),x=furni.x,y=furni.y,game.world.attachStandAreas(furni)},game.onBuildFunctions.toilet=function(f){game.world.defaultBuildFunction(f)},game.onBuildFunctions.car=function(furni){console.log("Running for car"),game.ai.updateGrid(game.gridPos(furni.x),game.gridPos(furni.y),!1),game.ai.updateGrid(game.gridPos(furni.x)+1,game.gridPos(furni.y),!1),game.ai.updateGrid(game.gridPos(furni.x),game.gridPos(furni.y)+1,!1),game.ai.updateGrid(game.gridPos(furni.x)+1,game.gridPos(furni.y)+1,!1)},game.onBuildFunctions.openSign=function(furni){game.ai.updateGrid(game.gridPos(furni.x),game.gridPos(furni.y),!1),game.ai.updateGrid(game.gridPos(furni.x)+1,game.gridPos(furni.y),!1),game.debug("ATTACH"),game.debug("ATTACH"),game.debug("ATTACH"),game.debug("ATTACH"),game.debug("ATTACH"),void 0!==game.open&&game.open.destroy(),void 0!==game.closed&&game.closed.destroy(),furni.interactive=!0,furni.on("pointerdown",function(){return!0!==game.ui.clicked&&(Object.keys(game.world.index.pinball).length<3?(game.ui.notification("You must have atleast 3 pinball tables before opening!"),!1):(!1===game.isOpen?(game.tut(13),openOrClose=_LANG.READY_TO_OPEN,yesFunc=function(){game.apis.ng.unlockMedal("Opened your arcade!"),game.closed.visible=!1,game.open.visible=!0,game.isOpen=!0,game.tut(14),game.track.event("Opened arcade","")}):(openOrClose=_LANG.READY_TO_CLOSE,yesFunc=function(){game.closed.visible=!0,game.open.visible=!1,game.isOpen=!1,game.track.event("Closed arcade","")}),void game.ui.yesno(openOrClose,yesFunc)))}),game.open=game.render.text(_LANG.OPEN,"sign-open"),game.open.x=furni.x+furni.width/2,game.open.y=furni.y+57,game.open.visible=!1,game.open.anchor.set(.5),game.closed=game.render.text(_LANG.CLOSED,"sign-closed"),game.closed.x=furni.x+furni.width/2,game.closed.y=furni.y+57,game.closed.anchor.set(.5),game.closed.visible=!1,game.render.objectLayer.addChild(game.open),game.render.objectLayer.addChild(game.closed),!1===game.isOpen?game.closed.visible=!0:game.open.visible=!0}};bootStrap.push(tool);var tool=function(){game.onBuildFunctions.arcademachine=function(furni){game.world.defaultBuildFunction(furni)}};bootStrap.push(tool);var tool=function(){game.onBuildFunctions.soda=function(furni){game.world.defaultBuildFunction(furni)}};bootStrap.push(tool);var tool=function(){game.onBuildFunctions.pixellamp=function(furni){light=PIXI.Sprite.fromImage("png/spotlight3-red.png"),light.width=128,light.height=128,light.x=furni.x-32,light.y=furni.y+32,light.alpha=1,light.rotate=-180,light.blendMode=PIXI.BLEND_MODES.ADD,game.render.objectLayer.addChild(light),game.tempObjects.push(light),light=PIXI.Sprite.fromImage("png/spotlight3-green.png"),light.width=128,light.height=128,light.x=furni.x-32,light.y=furni.y-32,light.alpha=1,light.rotate=-180,light.blendMode=PIXI.BLEND_MODES.ADD,game.render.objectLayer.addChild(light),game.tempObjects.push(light)}};bootStrap.push(tool);var tool=function(){game.onBuildFunctions.neonstrip=function(furni){}};bootStrap.push(tool);function Game(version){this.stage=document.getElementById("gamestage"),this.ee=new EventEmitter,this.runVersion=version,this.tileSize=_SETTINGS.tileSize,this.lifeTileSize=_SETTINGS.lifeTileSize,this.mapDimension=30,this.buildDistance=192,this.defaultScene="start",this._RENDER_WIDTH=RENDER_WIDTH,this._RENDER_HEIGHT=RENDER_HEIGHT,this.blockMatrix=[],this.oppositeBlockMatrix=[],this.drawMatrix=[],this.shadowMatrix=[],this.folder="",this.randomLoadQuotes=["Counting quarters","Playing Mario","Plugging in machines","Warming up CPU","Warming up GPU","Adding coal to kernel","Inspecting inspector"],this.saveFile="ABSave",this.events={},this.event=function(name,data){void 0!==this.events[name]?this.events[name](data):game.debug("Cant find event: "+name)},this.fps=60,this.lastTime=(new Date).getTime(),this.interval=1e3/this.fps,this.delta=0,this.langLoaded=!1,this.activeTool="select",this.calcFPS=0,this.quickRender=!1,this.furniture=[],this.speed=1,this.play=!0,this.tempObjects=[],this.flashingLights=[],this.rotatingLights=[],this.lastID=100,this.onBuildFunctions={},this.onDismantleFunctions={},this.propCount=function(objectToCount){return void 0!==objectToCount?Object.keys(objectToCount).length:0},this.isLangLoaded=!1,this.lang="en",this.pickLang=function(lang){var js=document.createElement("script");this.lang=lang,js.type="text/javascript",js.src="js/languages/"+lang+".js",document.body.appendChild(js)},this.langConvert=function(word){return void 0===_LANG[word]?(game.debug(word+" has no translation"),word):_LANG[word]},this.urlVar=function(variable){for(var vars=window.location.search.substring(1).split("&"),i=0;i<vars.length;i++){var pair=vars[i].split("=");if(pair[0]==variable)return pair[1]}return!1},this.rotate=function(object,angle){object.rotation=angle*(Math.PI/180)},this.tickers=[],this.drawBlockers=function(){game.ai.pathFinders[1].postMessage(["getgrid"]),setTimeout(function(){for(var i=0;i<game.blockMatrix.length-1;i++){console.log(game.blockMatrix[i]);for(var k=0;k<game.blockMatrix[i].length;k++)if(1!=game.blockMatrix[i][k].walkable){var blocker=new PIXI.Graphics;blocker.beginFill(65535,.8),blocker.lineStyle(1,0),blocker.drawRect(0,0,game.tileSize,game.tileSize),blocker.visible=!0,x=game.blockMatrix[i][k].x,y=game.blockMatrix[i][k].y,console.log("X :"+x+" Y :"+y),blocker.x=game.atGridPos(x),blocker.y=game.atGridPos(y),game.render.lifeLayer.addChild(blocker)}}},1e3)},this.atGridPos=function(n){return Math.floor(n*game.tileSize)},this.gridPos=function(n){return Math.floor(n/game.tileSize)},this.rand=function(start,end){return end-=start,Math.floor(Math.random()*end)+start},this.randID=function(name){return void 0===name&&(name="object"),this.lastID++,name+"-"+this.lastID},this.clone=function(obj){if(null===obj||"object"!=typeof obj)return obj;var copy=obj.constructor();for(var attr in obj)obj.hasOwnProperty(attr)&&(copy[attr]=obj[attr]);return copy},this.debug=function(msg){this.llog("default",msg)},window.onfocus=function(){game.debug("play")},window.onblur=function(){game.debug("pause")},this.pause=function(){game.play=!1},this.unpause=function(){game.play=!0},this.jobCounter=0,this.flashLights=function(){},this.rotateLights=function(){for(var i=0;i<game.rotatingLights.length;i++)5==game.rand(0,50)&&(game.rotatingLights[i].rotation=game.rand(0,360))},this.tickDraw=!1,this.tickDelta=0,this.tickThen=Date.now(),this.tickInterval=1e3/60,this.tickCounter=0,this.ticks=0,this.showLogs=["worker","pathfinder","jobs","timers","ai"],this.llog=function(type,data){-1!==this.showLogs.indexOf(type)&&console.log({type:type,data:data})},this.renderWorld=function(){if(now=Date.now(),delta=now-this.tickThen,this.tickCounter=this.tickCounter+delta,1e4<this.tickCounter?(this.ticks=0,this.tickCounter=0):this.ticks++,delta>this.tickInterval&&(this.tickThen=now-delta%this.tickInterval,this.render.render(delta)),this.ui.tick(),this.tools.tick(),!0===this.play){TWEEN.update(),this.camera.tick(),this.ui.render(this.delta),currentTime=(new Date).getTime(),this.delta=(currentTime-this.lastTime)/1e3,this.delta=this.delta,this.ai.lifeTicker(this.delta);for(var k=0;k<this.tickers.length;k++)this.tickers[k]();this.world.render(this.delta),game.jobs.createJobs(),this.jobCounter=0,this.jobCounter++,!1!==this.quickRender&&this.quickRender(),this.grid.render(),this.stats.tick(this.delta),this.flashLights(),this.lastTime=currentTime}else currentTime=(new Date).getTime(),this.lastTime=currentTime},this.load=function(){this.debug("Loading"),this.render=new Render(this),this.render.init()},this.renderReady=function(){game.debug("Start game in language: "+_LANG.LANGUAGE),this.grid=new Grid(this),this.ai=new AI(this),this.ai.init(),this.ui=new UI(this),this.ui.init(),this.tools=new Tools(this),this.tools.init(),this.stats=new Stats(this),this.stats.init(),this.world=new World(this),this.world.init(),roomx=10*game.tileSize,roomy=10*game.tileSize,game.world.rooms=JSON.parse('[{"x":'+roomx+',"y":'+roomy+',"framex":0,"framey":0,"built":false,"id":"undefined-9961-1815-8229-7731","data":{"type":"Storage","startX":500000,"startY":500000,"endY":0,"endX":0,"rects":[{"x":'+roomx+',"y":'+roomy+',"width":384,"height":448}],"occupied":false,"occupiedBy":{}}}]'),this.camera=new Camera(this),this.camera.init(),this.jobs=new Jobs(this),this.jobs.init(),this.grid.drawWalls(),this.saves=new Saves(this),this.audio=new GameAudio,this.audio.init(),this.audio.loadAudio(this.selectLanguage)},this.selectLanguageContents=[],this.closeselectLanguage=function(){for(var i=0;i<game.selectLanguageContents.length;i++)game.selectLanguageContents[i].destroy(),game.selectLanguageContents[i]=void 0;game.selectLanguageContents=[]},this.selectLanguage=function(){game.render.loadingBlack.visible=!1,game.createCursor(),game.render.loadingComplete(),game.startUI(),console.debug("here"),console.debug("NOTIFICATION");var y;sx=0,sy=0,windowW=RENDER_WIDTH,windowH=RENDER_HEIGHT,windowX=RENDER_WIDTH/2-windowW/2,windowY=RENDER_HEIGHT/2-windowH/2+100,windowYTop=30,x=windowX,y=windowY,0===game.selectLanguageContents.length?(game.selectLanguageContents.push(game.render.window(0,0,RENDER_WIDTH,RENDER_HEIGHT,266515,1)),game.selectLanguageContents.push(game.render.window(25,25,RENDER_WIDTH-50,RENDER_HEIGHT-50,266515,1,266515)),this.r=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,1,1)),this.r.width=1,this.r.height=1,this.r.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(this.r),game.selectLanguageContents.push(this.r),game.langLoaded=function(){game.audio.sounds.blonk.playOnce(),game.closeselectLanguage(),game.isLangLoaded=!0,game.runBootstrap()},langBtn=function(){game.clicked=!0,game.pickLang(this.lang),game.render.loadQuick("Loading scripts")},offset=0,windowText=game.render.text("English","menu-title"),windowText.x=windowX+windowW/2-windowText.width/2,windowText.y=windowY+140,game.selectLanguageContents.push(windowText),game.render.baseStage.addChild(windowText),windowText.interactive=!0,game.attachCursorEvents(windowText),windowText.lang="en",windowText.on("pointerup",langBtn)):this.r.visible=!0,game.pickLang("en"),game.render.loadQuick("Loading scripts")},this.runBootstrap=function(){game.debug("Loaded"),game.debug("Bootstrapping: "+bootStrap.length+" scripts"),game.render.loadingText("Loading scripts"),game.bitMax=bootStrap.length,game.bitsReady=function(){game.audio.sounds.mainbg.playOnce(),game.audio.sounds.tweets.playOnce(),game.debug("Bits ready"),bootStrap=[],game.start(),game.render.loadingComplete(),game.ui.mainMenu()},game.loadBits()},this.cash=100,this.isOpen=!1,this.cursor={},this.createCursor=function(){sx=22*game.tileSize,sy=6*game.tileSize,game.cursor=new WorldObject(0,0,game.render.newTexture(game.render.tilesets.gui,sx,sy,64,64)),game.cursor.width=1,game.cursor.height=1,game.cursor.defaultTexture=game.cursor.texture,texture=game.render.cache[game.render.tilesets.gui].clone(),rectangle=new PIXI.Rectangle(sx+64,sy,64,64),texture.frame=rectangle,game.cursor.textureOver=texture,game.render.cursor.addChild(game.cursor),game.cursor.alpha=0},this.setCursor=function(cursorStyle){var elem;document.getElementById&&(elem=document.getElementById("viewport"))&&elem.style&&(elem.style.cursor=cursorStyle)},this.cursorOver=function(){this.cursorOver=!0,game.setCursor("pointer"),game.cursor.texture=game.cursor.textureOver},this.cursorOut=function(){this.cursorOver=!1,game.setCursor("default"),game.cursor.texture=game.cursor.defaultTexture},this.hideCursor=!1,this.cursorHide=function(){game.hideCursor=!0},this.cursorUnHide=function(){game.hideCursor=!1,game.cursorShow()},this.cursorShow=function(){game.cursor.alpha=1},this.attachCursorEvents=function(sprite){sprite.on("pointerover",game.cursorOver),sprite.on("pointerout",game.cursorOut),sprite.on("pointerup",game.cursorOut),sprite.on("pointerdown",game.cursorOut)},document.onmousemove=function(e){event=e||window.event,game.cursor.x=event.clientX,game.cursor.y=event.clientY,!0===game.hideCursor&&"select"!==game.tools.activeTool.name&&(game.cursor.x<100||game.cursor.x>game.ui._VIEWPORT_RIGHT-50||game.cursor.y>game.ui._VIEWPORT_BOTTOM-220||game.cursor.y<100?game.cursorShow():game.cursor.alpha=1)},this.sandboxGame=function(){game.gameLog("Started new sandbox game"),game.mapDimension=30,game.isOpen=!1,game.grid.needRedraw=!0,game.grid.reGrid(),game.grid.drawWalls();for(var blockMatrix=[],y=0;y<game.drawMatrix.length;y++){xMatrix=[];for(var x=0;x<game.drawMatrix[y].length;x++)3<=game.drawMatrix[x][y][0]?xMatrix.push(1):xMatrix.push(0);console.debug(xMatrix),blockMatrix.push(xMatrix)}for(i=0;i<game.ai.maxWorkers;i++)game.ai.pathFinders[i].postMessage(["creategrid",blockMatrix]);for(game.cash=5e5,i=0;i<game.mapDimension;i++)game.grid.floorTile(0,i,1,1);for(i=0;i<game.mapDimension;i++)game.grid.floorTile(1,i,1,10);for(i=0;i<game.mapDimension;i++)game.grid.floorTile(2,i,1,13);for(i=0;i<game.mapDimension;i++)game.grid.floorTile(3,i,1,13);for(i=0;i<game.mapDimension;i++)game.grid.floorTile(4,i,1,13);for(i=0;i<game.mapDimension;i++)game.grid.floorTile(5,i,1,10);for(roomSize=17,game.grid.drawn=!1,game.grid.needRedraw=!0,game.cash=5e6,game.grid.drawWalls(),game.grid.reGrid(),i=0;i<game.mapDimension;i++)game.grid.floorTile(0,i,1,1);for(i=0;i<game.mapDimension;i++)game.grid.floorTile(1,i,1,10);for(i=0;i<game.mapDimension;i++)game.grid.floorTile(2,i,1,13);for(i=0;i<game.mapDimension;i++)game.grid.floorTile(3,i,1,13);for(i=0;i<game.mapDimension;i++)game.grid.floorTile(4,i,1,13);for(i=0;i<game.mapDimension;i++)game.grid.floorTile(5,i,1,10);openSignObj={x:384,y:704,height:256,width:128,framex:1472,framey:64,tileSetName:"png/furni.png",built:!0,id:"object-191",data:{buildFunction:"openSign"},name:"openSign",alpha:1},game.world.furniFromObject(openSignObj),sx=21*game.tileSize,sy=21*game.tileSize,bluecar={x:4*game.tileSize,y:10*game.tileSize+game.tileSize,height:4*game.tileSize,width:2*game.tileSize,framex:sx,framey:sy,tileSetName:"png/furni.png",built:!0,id:"object-1",data:{buildFunction:"car"},name:"car",alpha:1},game.world.furniFromObject(bluecar),sx=21*game.tileSize,sy=25*game.tileSize,redcar={x:4*game.tileSize,y:15*game.tileSize+game.tileSize,height:4*game.tileSize,width:2*game.tileSize,framex:sx,framey:sy,tileSetName:"png/furni.png",built:!0,id:"object-1",data:{buildFunction:"car"},name:"car",alpha:1},game.world.furniFromObject(redcar);x=1*game.tileSize,y=1*game.tileSize;for(offsetY=0,i=0;i<5;i++)sx=23*game.tileSize,sy=26*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.furni,sx,sy,2*game.tileSize,4*game.tileSize)),staticImage.x=x,staticImage.y=y+offsetY,staticImage.width=2*game.tileSize,staticImage.height=4*game.tileSize,game.render.objectLayer.addChild(staticImage),game.world.addObject(staticImage),light=PIXI.Sprite.fromImage("png/spotlight2-yellow.png"),light.width=2*game.tileSize,light.height=3*game.tileSize,light.x=1*game.tileSize,light.y=offsetY+game.tileSize+game.tileSize-15,light.alpha=.5,light.blendMode=PIXI.BLEND_MODES.ADD,game.render.objectLayer.addChild(light),offsetY+=5*game.tileSize;x=4*game.tileSize,y=1*game.tileSize;for(offsetY=0,i=0;i<5;i++)sx=25*game.tileSize,sy=26*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.furni,sx,sy,2*game.tileSize,4*game.tileSize)),staticImage.x=x,staticImage.y=y+offsetY+game.tileSize+game.tileSize,staticImage.width=2*game.tileSize,staticImage.height=4*game.tileSize,game.render.objectLayer.addChild(staticImage),game.world.addObject(staticImage),light=PIXI.Sprite.fromImage("png/spotlight2-yellow.png"),light.width=2*game.tileSize,light.height=3*game.tileSize,light.x=4*game.tileSize,light.y=offsetY+game.tileSize+game.tileSize+game.tileSize+game.tileSize-15,light.alpha=.5,light.blendMode=PIXI.BLEND_MODES.ADD,game.render.objectLayer.addChild(light),offsetY+=5*game.tileSize},this.newGame=function(){game.cash=10,loadFile='{"drawMatrix":[[[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10]],[[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13]],[[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13]],[[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13],[1,13]],[[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10],[1,10]],[[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,10],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,10],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[3,2],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,6],[1,10],[4,6],[3,3],[3,3],[3,3],[3,4],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[5,5],[3,3],[3,3],[3,3],[3,3],[3,3],[3,4],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,12],[1,12],[1,12],[1,12],[1,12],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[3,2],[3,3],[3,3],[3,3],[3,3],[5,6],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,12],[1,12],[1,12],[1,12],[1,12],[3,5],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,9],[1,9],[1,9],[1,9],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,12],[1,12],[1,12],[1,12],[1,12],[1,12],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[3,5],[1,9],[1,9],[1,9],[1,9],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,12],[1,12],[1,12],[1,12],[1,12],[4,5],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[1,9],[1,9],[1,9],[1,9],[1,9],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,12],[1,12],[1,12],[1,12],[1,12],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,5],[1,9],[1,9],[1,9],[1,9],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[4,2],[1,12],[1,12],[1,12],[1,12],[1,12],[4,2],[1,8],[1,8],[1,8],[1,8],[1,8],[1,8],[4,2],[1,9],[1,9],[1,9],[1,9],[4,2],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[5,2],[3,3],[3,3],[3,3],[3,3],[3,3],[6,6],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[6,6],[3,3],[3,3],[3,3],[3,3],[5,4],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]],[[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1],[1,1]]],"life":[{"x":705.3576839124744,"y":513.3576839124744,"data":{"speed":91,"across":1,"down":1,"patient":{"name":"Nickname: Shremblo","rawName":"Jammy","bio":"Loves to play FPS games","love":100,"compliance":20,"creativity":100,"skill":"manager","skillLevel":3},"body":{"hat":3,"head":2,"across":1,"down":1},"female":false,"jobs":["builder","miner","janitor"],"needCount":0,"need":"gohome","job":"builder"}},{"x":1165.8916962691096,"y":1009.1854627789169,"data":{"speed":94,"across":1,"down":3,"customerID":2,"customer":true,"happiness":50,"jobs":["customer"],"personality":"immature","experience":"noob","cash":7,"needCount":851,"need":"toilet"}},{"x":1296.1960254020069,"y":576,"data":{"speed":70,"across":1,"down":2,"customerID":3,"customer":true,"happiness":50,"jobs":["customer"],"personality":"ruffian","experience":"noob","cash":61,"needCount":837,"need":"food"}},{"x":705.4965341817676,"y":512,"data":{"speed":97,"across":1,"down":2,"customerID":4,"customer":true,"happiness":50,"jobs":["customer"],"personality":"ruffian","experience":"amateur","cash":159,"needCount":935,"need":"seat"}},{"x":1599.9954516718326,"y":1150.5399866582432,"data":{"speed":95,"across":1,"down":3,"customerID":5,"customer":true,"happiness":50,"jobs":["customer"],"personality":"casual","experience":"amateur","cash":25,"needCount":501,"need":"toilet"}},{"x":1473.4067052998196,"y":1150.5823048150255,"data":{"speed":61,"across":1,"down":2,"customerID":6,"customer":true,"happiness":50,"jobs":["customer"],"personality":"casual","experience":"pro","cash":107,"needCount":683,"need":"toilet"}},{"x":705.4409053350067,"y":1150.564701300538,"data":{"speed":96,"across":1,"down":3,"customerID":7,"customer":true,"happiness":50,"jobs":["customer"],"personality":"immature","experience":"noob","cash":102,"needCount":958,"need":"seat"}},{"x":962.455965048122,"y":832.1698645378231,"data":{"speed":65,"across":1,"down":2,"customerID":8,"customer":true,"happiness":50,"jobs":["customer"],"personality":"casual","experience":"amateur","cash":68,"needCount":899,"need":"arcade"}},{"x":1342.2111771406192,"y":576,"data":{"speed":90,"across":1,"down":3,"customerID":9,"customer":true,"happiness":50,"jobs":["customer"],"personality":"ruffian","experience":"noob","cash":159,"needCount":589,"need":"seat"}},{"x":700.4539905700867,"y":963.8592425416755,"data":{"speed":62,"across":1,"down":3,"customerID":10,"customer":true,"happiness":50,"jobs":["customer"],"personality":"immature","experience":"amateur","cash":3,"needCount":118,"need":"seat"}},{"x":832.1318611459375,"y":576,"data":{"speed":71,"across":1,"down":2,"customerID":11,"customer":true,"happiness":50,"jobs":["customer"],"personality":"immature","experience":"noob","cash":92,"needCount":653,"need":"arcade"}},{"x":1153.4409192346204,"y":576,"data":{"speed":68,"across":1,"down":2,"customerID":12,"customer":true,"happiness":50,"jobs":["customer"],"personality":"hardcore","experience":"novice","cash":163,"needCount":656,"need":"arcade"}},{"x":1406.6503787024662,"y":576.0069928564639,"data":{"speed":85,"across":1,"down":2,"customerID":13,"customer":true,"happiness":50,"jobs":["customer"],"personality":"ruffian","experience":"pro","cash":101,"needCount":470,"need":"food"}},{"x":932.6279286061902,"y":576,"data":{"speed":66,"across":1,"down":3,"customerID":14,"customer":true,"happiness":50,"jobs":["customer"],"personality":"casual","experience":"pro","cash":126,"needCount":67,"need":"change"}},{"x":894.592440136061,"y":193.39664854716423,"data":{"speed":69,"across":1,"down":3,"customerID":15,"customer":true,"happiness":50,"jobs":["customer"],"personality":"ruffian","experience":"novice","cash":155,"needCount":270,"need":"pinball"}},{"x":640.5284839382018,"y":655.0647676575534,"data":{"speed":89,"across":1,"down":2,"customerID":16,"customer":true,"happiness":50,"jobs":["customer"],"personality":"ruffian","experience":"amateur","cash":110,"needCount":276,"need":"seat"}},{"x":1022.7372235798496,"y":193.2433490906097,"data":{"speed":86,"across":1,"down":2,"customerID":17,"customer":true,"happiness":50,"jobs":["customer"],"personality":"casual","experience":"amateur","cash":150,"needCount":191,"need":"pinball"}},{"x":696.2136646295658,"y":569.0920031394027,"data":{"speed":90,"across":1,"down":3,"customerID":18,"customer":true,"happiness":50,"jobs":["customer"],"personality":"immature","experience":"novice","cash":64,"needCount":65,"need":"pinball"}},{"x":1128.8353649166347,"y":296.1543912050459,"data":{"speed":84,"across":1,"down":2,"customerID":19,"customer":true,"happiness":50,"jobs":["customer"],"personality":"ruffian","experience":"amateur","cash":122,"needCount":909,"need":"arcade"}},{"x":1124.815295600463,"y":512.7068581736398,"data":{"speed":70,"across":1,"down":3,"customerID":20,"customer":true,"happiness":50,"jobs":["customer"],"personality":"casual","experience":"amateur","cash":78,"needCount":15,"need":"pinball"}},{"x":750.4166174850484,"y":849.674962632217,"data":{"speed":72,"across":1,"down":3,"customerID":21,"customer":true,"happiness":50,"jobs":["customer"],"personality":"casual","experience":"noob","cash":99,"needCount":895,"need":"food"}},{"x":958.6231853818465,"y":257.36614163661744,"data":{"speed":79,"across":1,"down":2,"customerID":22,"customer":true,"happiness":50,"jobs":["customer"],"personality":"ruffian","experience":"amateur","cash":177,"needCount":475,"need":"pinball"}},{"x":958.7306202916393,"y":577.2498507897706,"data":{"speed":65,"across":1,"down":2,"customerID":23,"customer":true,"happiness":50,"jobs":["customer"],"personality":"hardcore","experience":"pro","cash":185,"needCount":42,"need":"arcade"}},{"x":894.7354963636727,"y":577.2450497342298,"data":{"speed":76,"across":1,"down":2,"customerID":24,"customer":true,"happiness":50,"jobs":["customer"],"personality":"casual","experience":"amateur","cash":178,"needCount":752,"need":"arcade"}},{"x":766.5554091385098,"y":577.4521147722271,"data":{"speed":62,"across":1,"down":2,"customerID":25,"customer":true,"happiness":50,"jobs":["customer"],"personality":"casual","experience":"amateur","cash":30,"needCount":188,"need":"change"}},{"x":575.9289443808279,"y":479.8329173890759,"data":{"speed":92,"across":1,"down":2,"customerID":26,"customer":true,"happiness":50,"jobs":["customer"],"personality":"immature","experience":"novice","cash":10,"needCount":289,"need":"pinball"}}],"objects":[{"x":384,"y":704,"height":256,"width":128,"framex":1472,"framey":64,"tileSetName":"png/furni.png","built":true,"id":"object-206","itemid":"0","data":{"buildFunction":"openSign","maxPay":null},"name":"openSign","alpha":1},{"x":64,"y":64,"height":256,"width":128,"framex":1472,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-207","itemid":"1","data":{"maxPay":null},"name":null,"alpha":1},{"x":64,"y":384,"height":256,"width":128,"framex":1472,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-208","itemid":"2","data":{"maxPay":null},"name":null,"alpha":1},{"x":64,"y":704,"height":256,"width":128,"framex":1472,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-209","itemid":"3","data":{"maxPay":null},"name":null,"alpha":1},{"x":64,"y":1024,"height":256,"width":128,"framex":1472,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-210","itemid":"4","data":{"maxPay":null},"name":null,"alpha":1},{"x":64,"y":1344,"height":256,"width":128,"framex":1472,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-211","itemid":"5","data":{"maxPay":null},"name":null,"alpha":1},{"x":256,"y":192,"height":256,"width":128,"framex":1600,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-212","itemid":"6","data":{"maxPay":null},"name":null,"alpha":1},{"x":256,"y":512,"height":256,"width":128,"framex":1600,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-213","itemid":"7","data":{"maxPay":null},"name":null,"alpha":1},{"x":256,"y":832,"height":256,"width":128,"framex":1600,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-214","itemid":"8","data":{"maxPay":null},"name":null,"alpha":1},{"x":256,"y":1152,"height":256,"width":128,"framex":1600,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-215","itemid":"9","data":{"maxPay":null},"name":null,"alpha":1},{"x":256,"y":1472,"height":256,"width":128,"framex":1600,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-216","itemid":"10","data":{"maxPay":null},"name":null,"alpha":1},{"x":1536,"y":448,"height":64,"width":64,"framex":0,"framey":64,"tileSetName":"png/furni.png","built":true,"id":"object-217","itemid":"11","data":{"buildDoor":false,"wallBuild":true,"isDoor":true,"maxPay":null},"name":"door","direction":0,"readName":"Door","alpha":1},{"x":512,"y":896,"height":64,"width":64,"framex":192,"framey":64,"tileSetName":"png/furni.png","built":true,"id":"object-218","itemid":"12","data":{"buildDoor":false,"wallBuild":true,"isDoor":true,"maxPay":null},"name":"door","direction":3,"readName":"Door","alpha":1},{"x":1600,"y":896,"height":64,"width":64,"framex":0,"framey":64,"tileSetName":"png/furni.png","built":true,"id":"object-219","itemid":"13","data":{"buildDoor":false,"wallBuild":true,"isDoor":true,"maxPay":null},"name":"door","direction":0,"readName":"Door","alpha":1},{"x":576,"y":1152,"height":64,"width":64,"framex":64,"framey":192,"tileSetName":"png/furni.png","built":true,"id":"object-220","itemid":"14","data":{"buildFurni":false,"anim":"chatter","maxPay":null,"runAnim":"chatter"},"name":"seat","direction":1,"readName":"Couch","alpha":1},{"x":576,"y":1088,"height":64,"width":64,"framex":64,"framey":192,"tileSetName":"png/furni.png","built":true,"id":"object-221","itemid":"15","data":{"buildFurni":false,"anim":"chatter","maxPay":null,"runAnim":"chatter"},"name":"seat","direction":1,"readName":"Couch","alpha":1},{"x":640,"y":1088,"height":128,"width":64,"framex":192,"framey":256,"tileSetName":"png/furni.png","built":true,"id":"object-222","itemid":"16","data":{"buildFurni":false,"maxPay":null},"name":"coffeetable","direction":2,"readName":"Coffee table","alpha":1},{"x":704,"y":1152,"height":64,"width":64,"framex":192,"framey":192,"tileSetName":"png/furni.png","built":true,"id":"object-223","itemid":"17","data":{"buildFurni":false,"anim":"chatter","maxPay":null,"runAnim":"chatter"},"name":"seat","direction":3,"readName":"Couch","alpha":1},{"x":704,"y":1088,"height":64,"width":64,"framex":192,"framey":192,"tileSetName":"png/furni.png","built":true,"id":"object-224","itemid":"18","data":{"buildFurni":false,"anim":"chatter","maxPay":null,"runAnim":"chatter"},"name":"seat","direction":3,"readName":"Couch","alpha":1},{"x":1472,"y":1152,"height":64,"width":64,"framex":128,"framey":384,"tileSetName":"png/furni.png","built":true,"id":"object-225","itemid":"19","data":{"buildFurni":false,"maxPay":null},"name":"toilet","direction":2,"readName":"Toilet","alpha":1},{"x":1536,"y":1152,"height":64,"width":64,"framex":128,"framey":384,"tileSetName":"png/furni.png","built":true,"id":"object-226","itemid":"20","data":{"buildFurni":false,"maxPay":null},"name":"toilet","direction":2,"readName":"Toilet","alpha":1},{"x":1600,"y":1152,"height":64,"width":64,"framex":128,"framey":384,"tileSetName":"png/furni.png","built":true,"id":"object-227","itemid":"21","data":{"buildFurni":false,"maxPay":null},"name":"toilet","direction":2,"readName":"Toilet","alpha":1},{"x":640,"y":960,"height":128,"width":64,"framex":0,"framey":1280,"tileSetName":"png/furni.png","built":true,"id":"object-228","itemid":"22","data":{"buildFurni":false,"buildFunction":"pixellamp","maxPay":null},"name":"lamp","direction":3,"readName":"Pixel lamp","alpha":1},{"x":1344,"y":448,"height":128,"width":64,"framex":0,"framey":640,"tileSetName":"png/furni.png","built":true,"id":"object-229","itemid":"23","data":{"buildFurni":false,"elecUnits":20,"standArea4":true,"pay":25,"anim":"snack","buildFunction":"arcademachine","defaultPay":25,"maxPay":31.25,"runAnim":"snack"},"name":"food","direction":3,"readName":"Snack machine","alpha":1},{"x":1408,"y":448,"height":128,"width":64,"framex":0,"framey":640,"tileSetName":"png/furni.png","built":true,"id":"object-230","itemid":"24","data":{"buildFurni":false,"elecUnits":20,"standArea4":true,"pay":25,"anim":"snack","buildFunction":"arcademachine","defaultPay":25,"maxPay":31.25,"runAnim":"snack"},"name":"food","direction":3,"readName":"Snack machine","alpha":1},{"x":1600,"y":448,"height":128,"width":64,"framex":0,"framey":512,"tileSetName":"png/furni.png","built":true,"id":"object-231","itemid":"25","data":{"buildFurni":false,"elecUnits":25,"standArea4":true,"pay":25,"anim":"drink","buildFunction":"arcademachine","defaultPay":25,"maxPay":31.25,"runAnim":"snack"},"name":"food","direction":3,"readName":"Soda machine","alpha":1},{"x":1664,"y":448,"height":128,"width":64,"framex":0,"framey":512,"tileSetName":"png/furni.png","built":true,"id":"object-232","itemid":"26","data":{"buildFurni":false,"elecUnits":25,"standArea4":true,"pay":25,"anim":"drink","buildFunction":"arcademachine","defaultPay":25,"maxPay":31.25,"runAnim":"snack"},"name":"food","direction":3,"readName":"Soda machine","alpha":1},{"x":1152,"y":448,"height":128,"width":64,"framex":0,"framey":1536,"tileSetName":"png/furni.png","built":true,"id":"object-233","itemid":"27","data":{"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","pay":50,"defaultPay":50,"maxPay":62.5},"name":"arcade","direction":3,"readName":"Pacboy","alpha":1},{"x":1088,"y":448,"height":128,"width":64,"framex":0,"framey":1536,"tileSetName":"png/furni.png","built":true,"id":"object-234","itemid":"28","data":{"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","pay":50,"defaultPay":50,"maxPay":62.5},"name":"arcade","direction":3,"readName":"Pacboy","alpha":1},{"x":1024,"y":448,"height":128,"width":64,"framex":0,"framey":1536,"tileSetName":"png/furni.png","built":true,"id":"object-235","itemid":"29","data":{"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","pay":50,"defaultPay":50,"maxPay":62.5},"name":"arcade","direction":3,"readName":"Pacboy","alpha":1},{"x":960,"y":448,"height":128,"width":64,"framex":0,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-236","itemid":"30","data":{"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","pay":100,"defaultPay":100,"maxPay":125},"name":"arcade","direction":3,"readName":"Froggy","alpha":1},{"x":896,"y":448,"height":128,"width":64,"framex":0,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-237","itemid":"31","data":{"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","pay":100,"defaultPay":100,"maxPay":125},"name":"arcade","direction":3,"readName":"Froggy","alpha":1},{"x":832,"y":448,"height":128,"width":64,"framex":0,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-238","itemid":"32","data":{"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","pay":100,"defaultPay":100,"maxPay":125},"name":"arcade","direction":3,"readName":"Froggy","alpha":1},{"x":832,"y":704,"height":128,"width":64,"framex":0,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-239","itemid":"33","data":{"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","pay":100,"defaultPay":100,"maxPay":125},"name":"arcade","direction":3,"readName":"Froggy","alpha":1},{"x":896,"y":704,"height":128,"width":64,"framex":0,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-240","itemid":"34","data":{"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","pay":100,"defaultPay":100,"maxPay":125},"name":"arcade","direction":3,"readName":"Froggy","alpha":1},{"x":960,"y":704,"height":128,"width":64,"framex":0,"framey":1664,"tileSetName":"png/furni.png","built":true,"id":"object-241","itemid":"35","data":{"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","pay":100,"defaultPay":100,"maxPay":125},"name":"arcade","direction":3,"readName":"Froggy","alpha":1},{"x":832,"y":128,"height":128,"width":64,"framex":0,"framey":896,"tileSetName":"png/furni.png","built":true,"id":"object-242","itemid":"36","data":{"buildFurni":false,"elecUnits":5,"standArea3":true,"pay":25,"buildFunction":"arcademachine","defaultPay":25,"maxPay":31.25,"runAnim":"happy"},"name":"pinball","direction":3,"readName":"Fireball","alpha":1},{"x":896,"y":128,"height":128,"width":64,"framex":0,"framey":896,"tileSetName":"png/furni.png","built":true,"id":"object-243","itemid":"37","data":{"buildFurni":false,"elecUnits":5,"standArea3":true,"pay":25,"buildFunction":"arcademachine","defaultPay":25,"maxPay":31.25,"runAnim":"happy"},"name":"pinball","direction":3,"readName":"Fireball","alpha":1},{"x":960,"y":128,"height":128,"width":64,"framex":0,"framey":896,"tileSetName":"png/furni.png","built":true,"id":"object-244","itemid":"38","data":{"buildFurni":false,"elecUnits":5,"standArea3":true,"pay":25,"buildFunction":"arcademachine","defaultPay":25,"maxPay":31.25,"runAnim":"happy"},"name":"pinball","direction":3,"readName":"Fireball","alpha":1},{"x":1024,"y":128,"height":128,"width":64,"framex":0,"framey":768,"tileSetName":"png/furni.png","built":true,"id":"object-245","itemid":"39","data":{"buildFurni":false,"elecUnits":2,"standArea3":true,"pay":1,"buildFunction":"arcademachine","tutNumber":8,"defaultPay":1,"maxPay":1.25,"runAnim":"happy"},"name":"pinball","direction":3,"readName":"Sun Wars","alpha":1},{"x":1088,"y":128,"height":128,"width":64,"framex":0,"framey":768,"tileSetName":"png/furni.png","built":true,"id":"object-246","itemid":"40","data":{"buildFurni":false,"elecUnits":2,"standArea3":true,"pay":1,"buildFunction":"arcademachine","tutNumber":8,"defaultPay":1,"maxPay":1.25,"runAnim":"happy"},"name":"pinball","direction":3,"readName":"Sun Wars","alpha":1},{"x":1152,"y":128,"height":128,"width":64,"framex":0,"framey":768,"tileSetName":"png/furni.png","built":true,"id":"object-247","itemid":"41","data":{"buildFurni":false,"elecUnits":2,"standArea3":true,"pay":1,"buildFunction":"arcademachine","tutNumber":8,"defaultPay":1,"maxPay":1.25},"name":"pinball","direction":3,"readName":"Sun Wars","alpha":1},{"x":1088,"y":704,"height":128,"width":128,"framex":1344,"framey":64,"tileSetName":"png/furni.png","built":true,"id":"object-248","itemid":"42","data":{"big":true,"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","pay":180,"defaultPay":180,"maxPay":225},"name":"arcade","direction":3,"readName":"Airhockey","alpha":1},{"x":1280,"y":704,"height":128,"width":128,"framex":1216,"framey":64,"tileSetName":"png/furni.png","built":true,"id":"object-249","itemid":"43","data":{"big":true,"canBeTaken":false,"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","pay":120,"defaultPay":120,"maxPay":150},"name":"arcade","direction":3,"readName":"Pool table","alpha":1},{"x":256,"y":704,"height":256,"width":128,"framex":1344,"framey":1344,"tileSetName":"png/furni.png","built":true,"id":"object-250","itemid":"44","data":{"buildFunction":"car","maxPay":null},"name":"car","alpha":1},{"x":256,"y":1024,"height":256,"width":128,"framex":1344,"framey":1600,"tileSetName":"png/furni.png","built":true,"id":"object-251","itemid":"45","data":{"buildFunction":"car","maxPay":null},"name":"car","alpha":1},{"x":768,"y":448,"height":128,"width":64,"framex":256,"framey":0,"tileSetName":"png/furni.png","built":true,"id":"object-362","data":{"canBeTaken":false,"buildFurni":false,"standArea4":true,"buildFunction":"arcademachine","tutNumber":4,"maxPay":null},"name":"change","direction":3,"readName":"Change Machine","alpha":1},{"x":704,"y":448,"height":128,"width":64,"framex":0,"framey":768,"tileSetName":"png/furni.png","built":true,"id":"object-386","data":{"buildFurni":false,"elecUnits":2,"standArea3":true,"pay":1,"buildFunction":"arcademachine","tutNumber":8,"defaultPay":1,"maxPay":1.25,"runAnim":"happy"},"name":"pinball","direction":3,"readName":"Sun Wars","alpha":1}],"settings":false,"cash":4256,"isOpen":true}',game.saves.load(loadFile),game.setupDefaultLocks()},this.bitNumber=0,this.bitMax=0,this.loadLoop=function(){this.debug("Bits: "+this.bitNumber),this.bitNumber<this.bitMax?(5==game.rand(0,7)&&(oneP=this.bitMax/100,p=Math.round(this.bitNumber/oneP),game.render.loadingText("Loading: ("+p+"%) "+this.randomLoadQuotes[game.rand(0,this.randomLoadQuotes.length)])),bootStrap[this.bitNumber](),this.bitNumber++):(this.loading=!1,this.bitsReady())},this.loading=!0,this.loadBits=function(){!function loadloop(){!0===game.loading&&(game.loadLoop(),window.requestAnimationFrame(loadloop))}(),this.debug("Loading Bits")},this.startUI=function(){this.debug("Starting"),document.getElementById("viewport").style.display="block",document.getElementById("loader").style.display="none",function animloop(){game.renderWorld(),!1===game.isLangLoaded&&window.requestAnimationFrame(animloop)}(),this.debug("Started")},this.start=function(){this.newGame(),this.debug("Starting"),document.getElementById("viewport").style.display="block",document.getElementById("loader").style.display="none",function animloop(){game.renderWorld(),window.requestAnimationFrame(animloop)}(),this.debug("Started")}}function Stats(game){this.cash=100,this.time=21600,this.hr=0,this.gameTime=21600,this.tick=function(delta){this.time+=24*delta,this.gameTime+=60*game.speed*delta,game.world.currentHour=moment.duration(this.gameTime,"seconds").hours()},this.makeTime=function(seconds){return hr=moment.duration(seconds,"seconds").hours()+"",mn=moment.duration(seconds,"seconds").minutes()+"",sec=moment.duration(seconds,"seconds").seconds()+"",tim="am",1==hr.length&&(hr="0"+hr),12<=1*hr&&(tim="pm"),1==mn.length&&(mn="0"+mn),1==sec.length&&(sec="0"+sec),hr+":"+mn+" "+tim},this.init=function(){game.debug("Stats loading"),game.debug("Stats loaded")}}function Camera(game){PIXI.settings.SCALE_MODE=PIXI.SCALE_MODES.NEAREST,game.debug("Camera loading"),this.offsetX=0,this.offsetY=0,this.newOffsetX=0,this.newOffsetY=0,this.scrollAmount=100,this.zoom=1,this.scale=1,this.originX=0,this.originY=0,this.lerp=.1,this.keyMap={},this.newScale=0,this.keydownEvent=function(e){game.camera.keyMap[e.keyCode]="keydown"==e.type},this.overLeft=!1,this.overUp=!1,this.overDown=!1,this.overRight=!1,this.left=void 0,this.right=void 0,this.up=void 0,this.down=void 0,this.oldPosX=0,this.oldPosY=0,this.originX=0,this.originY=0,this.rDown=!1,this.rightClick=function(event){console.log(["rc",event,this]),3==event.which&&(game.camera.rDown=!game.camera.rDown,event.preventDefault(),game.camera.rDown?(game.camera.oldPosX=game.cursor.x,game.camera.oldPosY=game.cursor.y,game.camera.originX=game.camera.offsetX,game.camera.originY=game.camera.offsetY):game.camera.originX===game.camera.offsetX&&game.camera.originY===game.camera.offsetY&&game.tools.setActiveTool("select"))},this.updateScales=function(){return game.render.background.scale.x=game.camera.scale,game.render.background.scale.y=game.camera.scale,game.render.lifeLayer.scale.x=game.camera.scale,game.render.lifeLayer.scale.y=game.camera.scale,game.render.objectLayer.scale.x=game.camera.scale,game.render.objectLayer.scale.y=game.camera.scale,game.render.shadowLayer.scale.x=game.camera.scale,game.render.shadowLayer.scale.y=game.camera.scale,game.render.aboveLife.scale.x=game.camera.scale,game.render.aboveLife.scale.y=game.camera.scale,!0},this.updateFocus=function(){game.stage.tabIndex=0,game.stage.focus()},this.init=function(){game.camera.scale=.8,game.camera.updateFocus(),game.camera.updateScales(),document.addEventListener("contextmenu",game.camera.rightClick),document.addEventListener("mousedown",game.camera.rightClick),document.addEventListener("mousewheel",function(e){return!1},{passive:!0}),document.addEventListener("keyup",function(e){game.camera.overRight=!1,game.camera.overLeft=!1,game.camera.overUp=!1,game.camera.overDown=!1,game.camera.keydownEvent(e)}),document.addEventListener("keydown",function(e){game.camera.keydownEvent(e),console.debug(game.camera.keyMap),game.camera.keyMap[16]&&game.camera.keyMap[187]&&game.apis.ng.unlockMedal("Completed 1st challenge!"),(game.camera.keyMap[68]||game.camera.keyMap[39])&&(game.camera.offsetX=game.camera.offsetX-100,game.camera.offsetX,game.camera.overRight=!0),(game.camera.keyMap[83]||game.camera.keyMap[40])&&(game.camera.offsetY=game.camera.offsetY-100,game.camera.offsetY,game.camera.overDown=!0),(game.camera.keyMap[65]||game.camera.keyMap[37])&&(game.camera.offsetX=game.camera.offsetX+100,game.camera.offsetX,game.camera.overLeft=!0),(game.camera.keyMap[87]||game.camera.keyMap[38])&&(game.camera.offsetY=game.camera.offsetY+100,game.camera.offsetY,game.camera.overUp=!0),game.camera.keyMap[82]&&(3<=game.tools.direction?game.tools.direction=0:game.tools.direction++)})},this.tick=function(){!0===this.rDown&&(game.ui.stageMousePos(),scrollX=game.cursor.x-this.oldPosX,scrollY=game.cursor.y-this.oldPosY,0!==scrollX&&(game.camera.offsetX=this.originX+scrollX,game.camera.offsetY=this.originY+scrollY)),game.render.aboveLife.position.x=game.camera.offsetX,game.render.aboveLife.position.y=game.camera.offsetY,game.render.background.position.x=game.camera.offsetX,game.render.background.position.y=game.camera.offsetY,game.render.objectLayer.position.x=game.camera.offsetX,game.render.objectLayer.position.y=game.camera.offsetY,game.render.lifeLayer.position.x=game.camera.offsetX,game.render.lifeLayer.position.y=game.camera.offsetY,game.render.shadowLayer.position.x=game.camera.offsetX,game.render.shadowLayer.position.y=game.camera.offsetY}}function Render(game){game.debug("Renderer loading"),this.tilesets={},this.cache=PIXI.utils.TextureCache,this.resources=PIXI.loader.resources,this.sprite=PIXI.Sprite,this.isFullscreen=!1,this.textStyles={},this.lastWidth=0,this.render=function(delta){!0===game.render.loadingBlack.fadeOut&&(game.render.loadingBlack.alpha-=.25*delta,game.render.loadingBlack.alpha<.01&&(game.render.loadingBlack.visible=!1,game.render.loadingBlack.fadeOut=!1)),game.render.background.cacheAsBitmap=!0,game.render.draw.render(game.render.allStages),5==game.rand(0,10)&&(game.calcFPS=Math.round(1/game.delta)),this.fpsCounter.visible=!1,this.fpsCounter.text="FPS: "+game.calcFPS+" AI: "+game.ai.life.length+" Objects: "+game.world.objects.length},this.fullscreen=function(){if(this.isFullscreen)this.isFullscreen=!1,document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.exitFullscreen();else{this.isFullscreen=!0;var el=document.getElementById("gamestage");el.webkitRequestFullScreen?el.webkitRequestFullScreen():el.mozRequestFullScreen()}setTimeout(function(){game.render.redraw()},1e3)},document.onfullscreenchange=function(event){setTimeout(function(){game.render.redraw()},1e3)},this.rezoom=function(){game.debug("rezoom"),console.debug(document.documentElement.clientWidth);var w=window.innerWidth,h=window.innerHeight;game.render.draw.view.style.width=w+"px",game.render.draw.view.style.height=h+"px",RENDER_WIDTH=w,RENDER_HEIGHT=h,void 0!==game.ui&&(game.ui._VIEWPORT_RIGHT=RENDER_WIDTH,game.ui._VIEWPORT_BOTTOM=RENDER_HEIGHT),game.render.draw.resize(w,h),void 0!==game.ui&&void 0!==game.ui.updateAll&&game.ui.updateAll(),void 0!==game.showTutorial&&game.showTutorial()},this.redraw=function(){game.debug("resize")},this.init=function(){console.debug("REZOOM"),game.debug("Render init"),"true"==game.urlVar("canvasMode")?this.draw=new PIXI.CanvasRenderer(RENDER_WIDTH,RENDER_HEIGHT,{resolution:window.devicePixelRatio||1,view:document.getElementById("gamestage")}):this.draw=PIXI.autoDetectRenderer(RENDER_WIDTH,RENDER_HEIGHT,{resolution:window.devicePixelRatio||1,view:document.getElementById("gamestage")}),this.draw.roundPixels=!0,this.draw.view.addEventListener("webglcontextlost",function(event){event.preventDefault(),console.log("WebGL fucked itself"),console.log(event)},!1),window.onresize=function(event){game.render.rezoom()},document.addEventListener("fullscreenchange",function(event){game.render.redraw(),setTimeout(function(){game.render.redraw()},1e3),document.fullscreen&&document.fullscreenElement}),this.allStages=new PIXI.Container,this.baseStage=new PIXI.Container,this.allStages.addChild(this.baseStage),this.background=new PIXI.Container;this.filter=new PIXI.filters.ColorMatrixFilter,this.filter.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.uiLayer=new PIXI.Container(3,!1),this.world=new PIXI.Container,this.world.interactive=!0,this.world.on("pointerdown",function(){game.debug("background clicked"),game.debug("ui click: "+game.ui.clicked),game.lifeClicked,game.lifeClicked=!1}),this.filter.brightness(.5,!1),this.baseStage.addChild(this.world),this.aboveLife=new PIXI.Container,this.aboveLifeLayer=new PIXI.Container,this.objectLayer=new PIXI.Container,this.lifeLayer=new PIXI.Container,this.underLifeLayer=new PIXI.Container,this.shadowLayer=new PIXI.Container,this.aboveAll=new PIXI.Container,this.cursor=new PIXI.Container,this.world.pivot.set(0,0),this.baseStage.pivot.set(0,0),this.aboveLife.pivot.set(0,0),this.aboveLifeLayer.pivot.set(0,0),this.objectLayer.pivot.set(0,0),this.lifeLayer.pivot.set(0,0),this.underLifeLayer.pivot.set(0,0),this.shadowLayer.pivot.set(0,0),this.aboveAll.pivot.set(0,0),this.cursor.pivot.set(0,0),this.loadingInfo=this.text("Loading: Renderer Init",1,this.uiLayer),this.loadingInfo.x=RENDER_WIDTH/2,this.loadingInfo.y=RENDER_HEIGHT/2,this.loadingInfo.anchor.set(.5),this.world.addChild(this.background),this.world.addChild(this.underLifeLayer),this.world.addChild(this.shadowLayer),this.world.addChild(this.objectLayer),this.world.addChild(this.lifeLayer),this.world.addChild(this.aboveLife),this.loadingBlack=this.window(0,0,RENDER_WIDTH,RENDER_HEIGHT,0,1),this.aboveAll.addChild(this.loadingBlack),this.betweenAboveAll=new PIXI.Container,this.aboveAll.addChild(this.betweenAboveAll),this.aboveAll.addChild(this.loadingInfo),this.allStages.addChild(this.aboveAll),this.allStages.addChild(this.cursor),game.render.draw.render(this.allStages),game.render.newTileset("loadscreen",game.folder+"png/loadbg.png",function(){game.render.newTileset("light",game.folder+"png/light.png",function(){game.render.newTileset("rain",game.folder+"png/rain.png",function(){game.render.newTileset("background",game.folder+"png/tileset.png",function(){game.render.newTileset("gui",game.folder+"png/gui.png",function(){game.render.newTileset("furni",game.folder+"png/furni.png",function(){game.render.newTileset("skins",game.folder+"png/life.png",function(){game.render.allImagesLoaded()})})})})})})}),this.fpsCounter=this.text("Fps: 0","time",this.uiLayer),this.fpsCounter.x=10,this.fpsCounter.y=10,this.rezoom()},this.allImagesLoaded=function(){game.renderReady()},this.loadQuick=function(text){game.render.loadingInfo.visible=!0,game.render.loadingBlack.alpha=1,game.render.loadingBlack.visible=!0,this.loadingText(text)},this.hideLoad=function(){game.render.loadingInfo.visible=!1,game.render.loadingBlack.fadeOut=!0},this.loadingComplete=function(){new PIXI.Sprite(game.render.lightTexture);game.render.loadingInfo.visible=!1},this.updateLighting=function(){game.render.draw.render(game.render.lights,game.render.lightTexture)},this.text=function(text,styleid,layer){var style=new PIXI.TextStyle({fontFamily:"Handlee",fontSize:22,fill:"#ffffff",strokeThickness:0});if(void 0!==game.render.textStyles[styleid])style=new PIXI.TextStyle(game.render.textStyles[styleid]);var newText=new PIXI.Text(text,style);return newText.resolution=2,newText.x=-10,newText.y=-10,void 0!==(newText.displayGroup=layer)&&this.baseStage.addChild(newText),newText},this.window=function(x,y,w,h,color,opacity,border,stage){void 0===color&&(color=13421772),void 0===opacity&&(opacity=.2),borderWidth=void 0===border?(border=2697513,0):1;var graphics=new PIXI.Graphics;return graphics.beginFill(color,opacity),graphics.lineStyle(borderWidth,border),graphics.drawRect(x,y,w,h),graphics.displayGroup=game.render.uiLayer,graphics.interactive=!0,graphics.on("pointerdown",function(){game.ui.clicked=!0}),void 0===stage?this.baseStage.addChild(graphics):stage.addChild(graphics),graphics},this.loadingText=function(text){return game.debug(text),game.render.loadingInfo.text="Loading plot... \n\n\n"+text,game.render.draw.render(game.render.allStages),game.render.draw.render(game.render.allStages),!0},this.newTileset=function(tileSetName,source,callback){if(game.render.tilesets[tileSetName]==source)return callback(),!0;game.render.loadingText("Loading tileset: "+tileSetName),PIXI.loader.add(source).load(function(e){game.render.loadingText("Loaded tileset: "+tileSetName+"..."),game.render.tilesets[tileSetName]=source,callback()})},this.tiles={},this.shadows={},this.drawTile=function(across,down,sw,sh,x,y){gameX=x,gameY=y,void 0===this.tiles[gameX]&&(this.tiles[gameX]={}),sx=(across-1)*game.tileSize,sy=(down-1)*game.tileSize;var texture=this.cache[this.tilesets.background].clone(),rectangle=new PIXI.Rectangle(sx,sy,sw,sh);texture.frame=rectangle,texture.baseTexture.scaleMode=PIXI.SCALE_MODES.NEAREST,void 0===this.tiles[gameX][gameY]?(this.tiles[gameX][gameY]=new this.sprite(texture),this.tiles[gameX][gameY].x=game.atGridPos(x),this.tiles[gameX][gameY].y=game.atGridPos(y),game.render.background.addChild(this.tiles[gameX][gameY])):(texture=this.cache[this.tilesets.background].clone(),rectangle=new PIXI.Rectangle(sx,sy,sw,sh),texture.frame=rectangle,this.tiles[gameX][gameY].texture=texture)},this.drawShadow=function(across,down,sw,sh,x,y){gameX=x,gameY=y,void 0===this.shadows[gameX]&&(this.shadows[gameX]={}),sx=(across-1)*game.tileSize,sy=(down-1)*game.tileSize;var texture=this.cache[this.tilesets.background].clone(),rectangle=new PIXI.Rectangle(sx,sy,sw+1,sh+1);texture.frame=rectangle,texture.baseTexture.scaleMode=PIXI.SCALE_MODES.NEAREST,void 0===this.shadows[gameX][gameY]?(this.shadows[gameX][gameY]=new this.sprite(texture),this.shadows[gameX][gameY].x=game.atGridPos(x),this.shadows[gameX][gameY].y=game.atGridPos(y),game.render.shadowLayer.addChild(this.shadows[gameX][gameY])):(texture=this.cache[this.tilesets.background].clone(),rectangle=new PIXI.Rectangle(sx,sy,sw,sh),texture.frame=rectangle,this.shadows[gameX][gameY].texture=texture)},this.textureCache={},this.newTexture=function(tileset,sx,sy,sw,sh){if(void 0!==this.textureCache[tileset+"-"+sx+"-"+sy+"-"+sw+"-"+sh])return this.textureCache[tileset+"-"+sx+"-"+sy+"-"+sw+"-"+sh];console.log({tileset:tileset});var texture=this.cache[tileset].clone(),rectangle=new PIXI.Rectangle(sx,sy,sw,sh);return texture.frame=rectangle,texture.tileSetName=tileset,this.textureCache[tileset+"-"+sx+"-"+sy+"-"+sw+"-"+sh]=texture}}function Grid(game){game.debug("Grid loading"),reGrid=function(){for(game.blockMatrix=[],game.shadowMatrix=[],game.drawMatrix=[],i=0;i<game.mapDimension;i++){var row=[],blockrow=[],oppositeblockrow=[],shadowrow=[];for(j=0;j<game.mapDimension;j++)row.push([game.rand(1,2),game.rand(1,2)]),shadowrow.push([-1,-1]),blockrow.push(!1),oppositeblockrow.push(1);game.blockMatrix.push(blockrow),game.oppositeBlockMatrix.push(oppositeblockrow),game.shadowMatrix.push(shadowrow),game.drawMatrix.push(row)}},this.getTileType=function(x,y){return data={},tile=game.drawMatrix[x][y],data.across=tile[0],data.down=tile[1],14<data.across&&data.across<17&&2<data.down&&data.down<14?"stone":0<data.across&&data.across<3&&0<data.down&&data.down<3?"grass":1==data.across&&10===data.down?"cement tile":void 0},reGrid(),this.reGrid=reGrid,this.renderCounter=0,this.needRedraw=!0,this.render=function(){100<this.renderCounter&&!(this.renderCounter=0)===this.needRedraw&&(this.drawWalls(),this.needRedraw=!1),this.renderCounter++},this.drawn=!1,this.drawWalls=function(){if(game.render.background.cacheAsBitmap=!1,this.calcAllRooms(),!1===this.drawn){this.drawn=!0;for(var i=0;i<game.drawMatrix.length;i++)for(var j=0;j<game.drawMatrix[i].length;j++)game.drawMatrix[i][j]=this.checkResolve(i,j),game.render.drawTile(game.drawMatrix[i][j][0],game.drawMatrix[i][j][1],game.tileSize,game.tileSize,i,j),game.shadowMatrix[i][j]=this.checkShadow(i,j),game.render.drawShadow(game.shadowMatrix[i][j][0],game.shadowMatrix[i][j][1],game.tileSize,game.tileSize,i,j),game.drawMatrix[i][j]=this.checkWireResolve(i,j),game.render.drawTile(game.drawMatrix[i][j][0],game.drawMatrix[i][j][1],game.tileSize,game.tileSize,i,j)}},this.check=function(x,y){return x<game.mapDimension&&y<game.mapDimension&&0<x&&0<y&&void 0!==game.drawMatrix[x]&&void 0!==game.drawMatrix[x][y]&&!(game.drawMatrix[x][y][0]<3||game.drawMatrix[x][y][0]<3)},this.checkWire=function(x,y){return!1},this.checkShadow=function(x,y){var r=this.check(x+1,y),l=this.check(x-1,y),u=this.check(x,y-1),d=this.check(x,y+1),tl=this.check(x-1,y-1),tr=this.check(x+1,y-1),bl=this.check(x-1,y+1),br=this.check(x+1,y+1);return!1===this.check(x,y)?!(tl&&tr&&br)||u||d||l||r||bl?!(tl&&tr&&bl)||l||u||d||r||br?!(br&&tl&&br)||tr||u||l||r||d?!(bl&&tr&&br)||u||d||l||r||tl?r&&l?[11,12]:u&&d?[11,11]:tl&&tr&&bl&&br?[11,12]:r&&u&&tr?[13,11]:l&&u&&tl?[12,11]:l&&d&&bl?[12,12]:r&&d&&br?[13,12]:l&&bl&&br&&!d&&!u&&!r?[12,12]:r&&bl&&br&&!d&&!u&&!l?[13,12]:l&&tl&&!u&&!d&&!r&&tr?[12,11]:u&&!d&&tr&&br&&!l&&!r?[13,11]:d&&!u&&bl&&tl&&!r&&!l?[12,12]:d&&!u&&!l&&!r&&tr&&br?[13,12]:r&&!u&&!l&&!d&&tr&&tl?[13,11]:u&&!d&&!l&&bl&&tl&&!r?[12,11]:tl&&tr&&!u?[14,9]:bl&&br&&!d?[14,8]:tr&&br&&!r?[14,10]:tl&&bl&&!l?[15,10]:d&&r?[13,12]:u&&l?[12,11]:u&&r?[13,11]:d&&l?[12,12]:r?[12,10]:l?[13,10]:u?[11,10]:d?[11,9]:tl?[13,9]:tr?[12,9]:bl?[13,8]:br?[12,8]:[-1,-1]:[13,12]:[12,12]:[12,11]:[13,11]:[-1,-1]},this.checkWireResolve=function(x,y){xAdd=8,void 0!==game.world.powerGrid&&void 0!==game.world.powerGrid[x+"-"+y]&&game.world.powerGrid[x+"-"+y][0]&&(xAdd=4),yAdd=12;var r=this.checkWire(x+1,y),l=this.checkWire(x-1,y),u=this.checkWire(x,y-1),d=this.checkWire(x,y+1);if(this.checkWire(x,y)){if(!1===r&&!1===l&&!1===u&&!1===d)return game.drawMatrix[x][y];if(r&&l&&u&&d)return[6+xAdd,4+yAdd];if(u&&d&&r)return[6+xAdd,5+yAdd];if(u&&d&&l)return[6+xAdd,6+yAdd];if(l&&u&&r)return[5+xAdd,6+yAdd];if(l&&d&&r)return[5+xAdd,5+yAdd];if(r&&l)return[4+xAdd,2+yAdd];if(u&&d)return[3+xAdd,3+yAdd];if(r&&u)return[3+xAdd,4+yAdd];if(r&&d)return[3+xAdd,2+yAdd];if(l&&u)return[5+xAdd,4+yAdd];if(l&&d)return[5+xAdd,2+yAdd];if(r)return[4+xAdd,5+yAdd];if(l)return[3+xAdd,5+yAdd];if(u)return[3+xAdd,6+yAdd];if(d)return[4+xAdd,6+yAdd]}return game.drawMatrix[x][y]},this.checkPowerWireResolve=function(x,y){xAdd=4,yAdd=12;var r=this.checkWire(x+1,y),l=this.checkWire(x-1,y),u=this.checkWire(x,y-1),d=this.checkWire(x,y+1);if(this.checkWire(x,y)){if(!1===r&&!1===l&&!1===u&&!1===d)return game.drawMatrix[x][y];if(r&&l&&u&&d)return[6+xAdd,4+yAdd];if(u&&d&&r)return[6+xAdd,5+yAdd];if(u&&d&&l)return[6+xAdd,6+yAdd];if(l&&u&&r)return[5+xAdd,6+yAdd];if(l&&d&&r)return[5+xAdd,5+yAdd];if(r&&l)return[4+xAdd,2+yAdd];if(u&&d)return[3+xAdd,3+yAdd];if(r&&u)return[3+xAdd,4+yAdd];if(r&&d)return[3+xAdd,2+yAdd];if(l&&u)return[5+xAdd,4+yAdd];if(l&&d)return[5+xAdd,2+yAdd];if(r)return[4+xAdd,5+yAdd];if(l)return[3+xAdd,5+yAdd];if(u)return[3+xAdd,6+yAdd];if(d)return[4+xAdd,6+yAdd]}return game.drawMatrix[x][y]},this.checkResolve=function(x,y){var r=this.check(x+1,y),l=this.check(x-1,y),u=this.check(x,y-1),d=this.check(x,y+1);if(this.check(x,y)){if(!1===r&&!1===l&&!1===u&&!1===d)return game.drawMatrix[x][y];if(r&&l&&u&&d)return[6,4];if(u&&d&&r)return[6,5];if(u&&d&&l)return[6,6];if(l&&u&&r)return[5,6];if(l&&d&&r)return[5,5];if(r&&l)return[4,2];if(u&&d)return[3,3];if(r&&u)return[3,4];if(r&&d)return[3,2];if(l&&u)return[5,4];if(l&&d)return[5,2];if(r)return[4,5];if(l)return[3,5];if(u)return[3,6];if(d)return[4,6]}return game.drawMatrix[x][y]},this.updateDrawTile=function(x,y){game.drawMatrix[x][y]=[4,2],game.ai.updateGrid(x,y,!1),game.render.drawTile(4,2,game.tileSize,game.tileSize,x,y),this.drawn=!1},this.calcedRooms=[],this.setCalcedRoom=function(room,doorid){this.calcedRooms.push([doorid,room])},this.showedRooms=[],this.calcAllRooms=function(){this.calcedRooms=[];for(var i=0;i<game.world.objects.length;i++)!0===game.world.objects[i].data.isDoor&&this.calcRooms(game.world.objects[i])},this.showRooms=function(){for(var i=0;i<this.calcedRooms.length;i++){room=this.calcedRooms[i],path=room[1];var graphics=new PIXI.Graphics;graphics.beginFill(255,.5),graphics.lineStyle(4,16767232,1),graphics.moveTo(game.atGridPos(path[0][0])+32,game.atGridPos(path[0][1])+32);for(var j=0;j<path.length;j++)graphics.lineTo(game.atGridPos(path[j][0])+32,game.atGridPos(path[j][1])+32);graphics.endFill(),this.showedRooms.push(graphics),game.render.world.addChild(graphics)}},this.hideRooms=function(){for(var i=0;i<this.showedRooms.length;i++)this.showedRooms[i].destroy();this.showedRooms=[]},this.calcRooms=function(door){},this.updateTile=function(x,y){game.drawMatrix[x][y]=[4,2],game.ai.updateGrid(x,y,!1),game.render.drawTile(4,2,game.tileSize,game.tileSize,x,y),this.drawn=!1,this.needRedraw=!0},this.floorTile=function(x,y,across,down){game.drawMatrix[x][y]=[across,down],game.ai.updateGrid(x,y,!0),game.render.drawTile(across,down,game.tileSize,game.tileSize,x,y),this.drawn=!1,this.needRedraw=!0},this.removeWall=function(x,y){game.drawMatrix[x][y]=[1,1],game.ai.updateGrid(x,y,!0),game.render.drawTile(1,1,game.tileSize,game.tileSize,x,y),this.drawn=!1,this.needRedraw=!0}}function Tool(name){this.name=name}function Tools(game){game.debug("Tools loading"),this.isMouseDown=!1,this.mouseDownX=0,this.direction=3,this.mouseDownY=0,this.mouseUpX=0,this.mouseUpY=0,this.activeTool="",this.toolFunctions={},this.activeMenu="",this.menuButtons=[],this.menuWindows=[],this.collisionCheckId=0,this.fullsweep=!1,this.lastsweep=!0,this.addTool=function(tool){game.debug("Adding tool: "+tool.name),this.tools.push(tool)},this.bottomMenuOpen=function(){return 0<game.tools.menuButtons.length},this.closeMenus=function(){if(0<game.tools.menuButtons.length)for(var i=0;i<game.tools.menuButtons.length;i++)game.tools.menuButtons[i].destroy();if(0<game.tools.menuWindows.length)for(var j=0;j<game.tools.menuWindows.length;j++)game.tools.menuWindows[j].destroy();game.tools.menuWindows=[],game.tools.menuButtons=[],game.ui.hideItemInfo()},this.tools=[],this.activeToolIndex=-1,this.activeTool=!1,this.tick=function(){if(!1!==this.activeTool&&this.inBounds(this.mouseX,this.mouseY)&&void 0!==this.activeTool.onMouseMove)try{this.activeTool.onMouseMove(this.mouseX,this.mouseY)}catch(e){console.log(e)}},this.setSquaringTool=function(tool){console.log("~~~~~TOOOL~~~~~"),console.log(tool),console.log("~~~~~TOOOL~~~~~"),game.tools.deactivate();var newTool=new Tool(tool.name);newTool.hoverBricks=[],newTool.data=tool,newTool.canCommit=!0,newTool.wallHolder=function(x,y){console.debug(this.data.data.across);var tileAcross=this.data.data.across,tileDown=this.data.data.down,sx=(tileAcross-1)*game.tileSize,sy=(tileDown-1)*game.tileSize,bricks=(Math.floor(x/game.tileSize),Math.floor(y/game.tileSize),new WorldObject(x,y,game.render.newTexture(game.render.tilesets.background,sx,sy,game.tileSize,game.tileSize)));bricks.x=x,bricks.y=y;for(var i=0;i<game.world.objects.length;i++)if((!0!==this.data.data.buildFloor||"brickholder"==game.world.objects[i].name)&&("allowwall"!=this.data.collide||"brickholder"!=game.world.objects[i].name)&&game.world.rCollision(bricks,game.world.objects[i])){bricks.tint=16711680,this.canCommit=!1;break}!0!==this.data.data.wallBuild&&3<=game.drawMatrix[game.gridPos(x)][game.gridPos(y)][0]&&2<=game.drawMatrix[game.gridPos(x)][game.gridPos(y)][1]&&(this.canCommit=!1,bricks.tint=16711680,"allowwall"==this.data.collide&&(void 0!==game.world.objects[i]?"brickholder"==game.world.objects[i].name&&(this.cancommit=!0):this.cancommit=!0)),!0!==this.data.data.mine&&13<=game.drawMatrix[game.gridPos(x)][game.gridPos(y)][0]&&2<=game.drawMatrix[game.gridPos(x)][game.gridPos(y)][1]&&(this.canCommit=!1,bricks.tint=16711680,"allowmine"==this.data.collide&&(void 0!==game.world.objects[i]?"brickholder"==game.world.objects[i].name&&(this.cancommit=!0):this.cancommit=!0)),game.render.objectLayer.addChild(bricks),this.hoverBricks.push(bricks)},newTool.floorHolder=function(x,y){var tileAcross=1,tileDown=12;!0===this.data.data.buildFloor&&(tileAcross=this.data.across,tileDown=this.data.down),void 0!==this.data.data.across&&(tileAcross=this.data.data.across,tileDown=this.data.data.down);var sx=(tileAcross-1)*game.tileSize,sy=(tileDown-1)*game.tileSize,bricks=(Math.floor(x/game.tileSize),Math.floor(y/game.tileSize),new WorldObject(x,y,game.render.newTexture(game.render.tilesets.background,sx,sy,game.tileSize,game.tileSize)));bricks.x=x,bricks.y=y,!0!==this.data.data.wallBuild&&3<=game.drawMatrix[game.gridPos(x)][game.gridPos(y)][0]&&2<=game.drawMatrix[game.gridPos(x)][game.gridPos(y)][1]&&(this.canCommit=!1,bricks.tint=16711680,"allowwall"==this.data.collide&&"brickholder"==game.world.objects[i].name&&(this.cancommit=!0)),game.render.objectLayer.addChild(bricks),this.hoverBricks.push(bricks)},newTool.commitFloor=function(x,y){var tileAcross=1,tileDown=12;!0===this.data.data.buildFloor&&(tileAcross=this.data.across,tileDown=this.data.down);var sx=(tileAcross-1)*game.tileSize,sy=(tileDown-1)*game.tileSize,commit=(Math.floor(x/game.tileSize),Math.floor(y/game.tileSize),!0);if(!1===this.canCommit&&(commit=!1),!0===commit){var bricks=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.background,sx,sy,game.tileSize,game.tileSize));!0===this.data.data.buildFloor?bricks.data=game.clone(this.data.data):bricks.data={buildFloor:!0,across:1,down:8},bricks.x=x,bricks.y=y,bricks.across=tileAcross,bricks.down=tileDown,bricks.alpha=.25,bricks.name="floorholder",game.render.objectLayer.addChild(bricks),game.world.objects.push(bricks);for(var e=0;e<game.world.objects.length;e++)game.world.rCollision(bricks,game.world.objects[e])&&!0===game.world.objects[e].data.buildFloor&&game.world.objects[e].id!=bricks.id&&(game.world.objects[e].destroy(),game.world.removeObject(game.world.objects[e].id))}},newTool.commitWall=function(x,y){var tileAcross=this.data.data.across,tileDown=this.data.data.down,sx=(tileAcross-1)*game.tileSize,sy=(tileDown-1)*game.tileSize,commit=(Math.floor(x/game.tileSize),Math.floor(y/game.tileSize),!0);if(!1===this.canCommit&&(commit=!1),!0===commit){var bricks=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.background,sx,sy,game.tileSize,game.tileSize));bricks.data=game.clone(this.data.data),bricks.x=x,bricks.y=y,bricks.across=tileAcross,bricks.down=tileDown,bricks.alpha=.25,this.data.data.buildWall?bricks.name="brickholder":bricks.name="floorholder",game.render.objectLayer.addChild(bricks),game.world.objects.push(bricks)}},newTool.mouseDown=!1,newTool.onMouseDown=function(e){newTool.mouseDown=!0},newTool.onMouseMove=function(x,y){this.canCommit=!0;for(var i=0;i<this.hoverBricks.length;i++)this.hoverBricks[i].destroy();var stagePos={x:x,y:y};if(startX=game.atGridPos(game.gridPos(game.tools.mouseDownX)),startY=game.atGridPos(game.gridPos(game.tools.mouseDownY)),endX=game.atGridPos(game.gridPos(stagePos.x)),endY=game.atGridPos(game.gridPos(stagePos.y)),this.wallHolder(endX,endY),!0===this.mouseDown){for(endX<startX&&(tmp=endX,endX=startX,startX=tmp),endY<startY&&(tmp=endY,endY=startY,startY=tmp),game.debug("r:"+startY),xBlocks=(endX-startX)/game.tileSize,yBlocks=(endY-startY)/game.tileSize,xOffset=0,i=yOffset=0;i<xBlocks;i++)xOffset+=game.tileSize,this.wallHolder(startX+xOffset,endY+yOffset);if(xOffset=0,yOffset=0,yOffset+=game.tileSize,!0===this.data.data.fill)for(i=0;i<yBlocks-1;i++){for(j=0;j<xBlocks-1;j++)xOffset+=game.tileSize,this.floorHolder(startX+xOffset,startY+yOffset);xOffset=0,yOffset+=game.tileSize}for(this.wallHolder(startX,startY),xOffset=0,yOffset=0,this.wallHolder(startX,startY),i=0;i<xBlocks;i++)xOffset+=game.tileSize,this.wallHolder(startX+xOffset,startY);for(i=yOffset=0;i<yBlocks;i++)yOffset+=game.tileSize,this.wallHolder(startX+xOffset,startY+yOffset);for(i=yOffset=0;i<yBlocks;i++)yOffset+=game.tileSize,this.wallHolder(startX,startY+yOffset)}},newTool.onMouseUp=function(x,y){for(var i=0;i<this.hoverBricks.length;i++)this.hoverBricks[i].destroy();if(!0===this.mouseDown){newTool.mouseDown=!1;var stagePos={x:x,y:y};for(startX=game.atGridPos(game.gridPos(game.tools.mouseDownX)),startY=game.atGridPos(game.gridPos(game.tools.mouseDownY)),endX=game.atGridPos(game.gridPos(stagePos.x)),endY=game.atGridPos(game.gridPos(stagePos.y)),endX<startX&&(tmp=endX,endX=startX,startX=tmp),endY<startY&&(tmp=endY,endY=startY,startY=tmp),game.debug("r:"+startY),xBlocks=(endX-startX)/game.tileSize,yBlocks=(endY-startY)/game.tileSize,xOffset=0,i=yOffset=0;i<xBlocks;i++)xOffset+=game.tileSize,!0!==this.data.data.buildFloor?this.commitWall(startX+xOffset,endY+yOffset):this.commitFloor(startX+xOffset,endY+yOffset);for(!0!==this.data.data.buildFloor?this.commitWall(startX,startY):this.commitFloor(startX,startY),xOffset=0,i=yOffset=0;i<xBlocks;i++)xOffset+=game.tileSize,!0!==this.data.data.buildFloor?this.commitWall(startX+xOffset,startY):this.commitFloor(startX+xOffset,startY);for(i=yOffset=0;i<yBlocks-1;i++)yOffset+=game.tileSize,!0!==this.data.data.buildFloor?this.commitWall(startX+xOffset,startY+yOffset):this.commitFloor(startX+xOffset,startY+yOffset);for(i=yOffset=0;i<yBlocks;i++)yOffset+=game.tileSize,!0!==this.data.data.buildFloor?this.commitWall(startX,startY+yOffset):this.commitFloor(startX,startY+yOffset);if(xOffset=0,yOffset=0,yOffset+=game.tileSize,!0===this.data.data.fill)for(i=0;i<yBlocks-1;i++){for(j=0;j<xBlocks-1;j++)xOffset+=game.tileSize,this.commitFloor(startX+xOffset,startY+yOffset);xOffset=0,yOffset+=game.tileSize}}},newTool.deactivate=function(){for(var i=0;i<this.hoverBricks.length;i++)this.hoverBricks[i].destroy()},this.activeTool=newTool},this.setFurniTool=function(tool){game.debug(tool.name),game.cursorHide(),game.tools.deactivate(),game.tut(tool.tutNumber);var newTool=new Tool(tool.name);newTool.createFurni=!0,newTool.data=tool,newTool.canCommit=!0,newTool.onMouseDown=function(x,y){if(this.canCommit){var tileAcross=0;tileAcross=1==this.data.blocks?this.data.across+game.tools.direction:this.data.across;var tileDown=this.data.down,sx=(tileAcross-1)*game.tileSize,sy=(tileDown-1)*game.tileSize,w=(Math.floor(x/game.tileSize),Math.floor(y/game.tileSize),game.tileSize),h=game.tileSize;if(x=game.atGridPos(game.gridPos(x)),y=4==this.data.blocks?game.atGridPos(game.gridPos(y-64)):game.atGridPos(game.gridPos(y)),void 0===this.data.mat?material="cash":material=this.data.mat,!game.spend(this.data.cost,material))return console.log("Not spending"),game.pooraf({data:{pay:this.data.cost,mat:material},x:x,y:y}),0;if(console.log("Spending"),game.ouching({data:{pay:this.data.cost,mat:material},x:x,y:y}),furni=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.furni,sx,sy,w,h)),furni.name=tool.name,furni.readName=tool.readName,furni.direction=game.tools.direction,2==this.data.blocks)switch(game.tools.direction){case 0:furni.texture=game.render.newTexture(game.render.tilesets.furni,sx+game.tileSize,sy+game.tileSize,128,game.tileSize),furni.height=game.tileSize,furni.width=128;break;case 1:furni.texture=game.render.newTexture(game.render.tilesets.furni,sx+game.tileSize,sy,128,game.tileSize),furni.height=game.tileSize,furni.width=128;break;case 2:furni.texture=game.render.newTexture(game.render.tilesets.furni,sx+game.tileSize+game.tileSize+game.tileSize,sy,game.tileSize,128),furni.height=128,furni.width=game.tileSize;break;case 3:furni.texture=game.render.newTexture(game.render.tilesets.furni,sx,sy,game.tileSize,128),furni.height=128,furni.width=game.tileSize}if(3==this.data.blocks&&(furni.texture=game.render.newTexture(game.render.tilesets.furni,sx+1,sy,3*game.tileSize,3*game.tileSize),furni.height=3*game.tileSize,furni.width=3*game.tileSize),5==this.data.blocks&&(furni.texture=game.render.newTexture(game.render.tilesets.furni,sx,sy,2*game.tileSize,2*game.tileSize),furni.height=2*game.tileSize,furni.width=2*game.tileSize),4==this.data.blocks)switch(game.tools.direction){case 0:furni.texture=game.render.newTexture(game.render.tilesets.furni,sx+game.tileSize+game.tileSize,sy,game.tileSize,128),furni.height=128,furni.width=game.tileSize;break;case 1:furni.texture=game.render.newTexture(game.render.tilesets.furni,sx+game.tileSize,sy,game.tileSize,128),furni.height=128,furni.width=game.tileSize;break;case 2:furni.texture=game.render.newTexture(game.render.tilesets.furni,sx+game.tileSize+game.tileSize+game.tileSize,sy,game.tileSize,128),furni.height=128,furni.width=game.tileSize;break;case 3:furni.texture=game.render.newTexture(game.render.tilesets.furni,sx,sy,game.tileSize,128),furni.height=128,furni.width=game.tileSize}!0===this.data.data.dismantle&&void 0!==this.collide?!1===this.collide.built?(this.collide.destroy(),game.world.removeObject(this.collide.id)):this.collide.data.dismantle=!0:(furni.x=x,furni.y=y,void 0!==this.data&&(void 0!==this.data.offsetX&&(furni.x=x-this.data.offsetX),void 0!==this.data.offsetY&&(furni.y=y-this.data.offsetY)),furni.alpha=.25,furni.offset=1,furni.data.direction=game.tools.direction,!0===this.data.data.standArea&&(furni.data.standArea={x:this.standArea.x+game.tileSize,y:this.standArea.y}),!0===this.data.data.standArea2&&(furni.data.standArea2={x:this.standArea2.x+game.tileSize,y:this.standArea2.y}),!0===this.data.data.standArea3&&(furni.data.standArea3={x:this.standArea3.x,y:this.standArea3.y}),!0===this.data.data.standArea4&&(furni.data.standArea4={x:this.standArea4.x,y:this.standArea4.y}),furni.itemid=this.data.id,void 0!==this.data.data.frames?(frames=[],frames.push(furni.texture),texture=game.render.newTexture(game.render.tilesets.furni,sx+64,sy,game.tileSize,128),frames.push(texture),texture=game.render.newTexture(game.render.tilesets.furni,sx+64,sy,game.tileSize,128),frames.push(furni.texture),texture=game.render.newTexture(game.render.tilesets.furni,sx+64+64,sy,game.tileSize,128),frames.push(texture),newFurni=new WorldObjectAnim(furni.x,furni.y,frames),newFurni.width=furni.width,newFurni.tutNumber=furni.tutNumber,newFurni.height=furni.height,game.world.defaultBuildFunction(newFurni),game.render.objectLayer.addChild(newFurni),newFurni.animationSpeed=.01*Math.random()+.01,newFurni.play(),newFurni.itemid=this.data.id,furni=newFurni,furni.name=tool.name,furni.readName=tool.readName,furni.alpha=.25):(game.render.objectLayer.addChild(furni),console.log("===AD FURNI==="),console.log(furni)),furni.data=game.clone(this.data.data),game.world.addObject(furni),game.world.attachStandAreas(furni),game.isTut&&game.tools.setActiveTool("select"))}},newTool.onMouseMove=function(x,y){var tileAcross=0;tileAcross=1==this.data.blocks?this.data.across+game.tools.direction:this.data.across;var tileDown=this.data.down,sx=(tileAcross-1)*game.tileSize,sy=(tileDown-1)*game.tileSize;Math.floor(x/game.tileSize),Math.floor(y/game.tileSize);x=game.atGridPos(game.gridPos(x)),y=4==this.data.blocks?game.atGridPos(game.gridPos(y-64)):game.atGridPos(game.gridPos(y));var w=game.tileSize,h=game.tileSize;if(!0===this.createFurni?(this.standArea={},this.standArea2={},this.standArea3={},this.standArea4={},this.furni=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.furni,sx,sy,w,h)),this.furni.alpha=1,game.render.objectLayer.addChild(this.furni),!(this.createFurni=!1)===this.data.data.standArea&&(this.standArea=game.render.window(16,16,32,32,65280),game.render.objectLayer.addChild(this.standArea)),!0===this.data.data.standArea2&&(this.standArea2=game.render.window(16,16,32,32,255),game.render.objectLayer.addChild(this.standArea2)),!0===this.data.data.standArea3&&(this.standArea3=game.render.window(16,16,32,32,255),game.render.objectLayer.addChild(this.standArea3)),!0===this.data.data.standArea4&&(this.standArea4=game.render.window(16,16,32,32,255),game.render.objectLayer.addChild(this.standArea4))):this.furni.texture=game.render.newTexture(game.render.tilesets.furni,sx,sy,w,h),!0===this.data.data.standArea)switch(game.tools.direction){case 0:this.standArea.x=x,this.standArea.y=y+game.tileSize;break;case 1:this.standArea.x=x,this.standArea.y=y-game.tileSize;break;case 2:this.standArea.x=x+game.tileSize,this.standArea.y=y;break;case 3:this.standArea.x=x-game.tileSize,this.standArea.y=y}if(!0===this.data.data.standArea2)switch(game.tools.direction){case 0:this.standArea2.x=x,this.standArea2.y=y-game.tileSize;break;case 1:this.standArea2.x=x,this.standArea2.y=y+game.tileSize;break;case 2:this.standArea2.x=x-game.tileSize,this.standArea2.y=y;break;case 3:this.standArea2.x=x+game.tileSize,this.standArea2.y=y}if(!0===this.data.data.standArea3)switch(game.tools.direction){case 0:this.standArea3.x=x,this.standArea3.y=y;break;case 1:this.standArea3.x=x+game.tileSize,this.standArea3.y=y;break;case 2:this.standArea3.x=x,this.standArea3.y=y-16;break;case 3:this.standArea3.x=x,this.standArea3.y=y+game.tileSize}if(!0===this.data.data.standArea4)switch(game.tools.direction){case 0:this.standArea4.x=x+game.tileSize,this.standArea4.y=y+game.tileSize;break;case 1:this.standArea4.x=x,this.standArea4.y=y-game.tileSize;break;case 2:this.standArea4.x=x-game.tileSize,this.standArea4.y=y+game.tileSize;break;case 3:this.standArea4.x=x,this.standArea4.y=y+game.tileSize+game.tileSize}if(this.lastsweep&&(this.canCommit=!0,this.furni.tint=16777215),2==this.data.blocks)switch(game.tools.direction){case 0:this.furni.texture=game.render.newTexture(game.render.tilesets.furni,sx+game.tileSize,sy+game.tileSize,128,game.tileSize),this.furni.height=game.tileSize,this.furni.width=128;break;case 1:this.furni.texture=game.render.newTexture(game.render.tilesets.furni,sx+game.tileSize,sy,128,game.tileSize),this.furni.height=game.tileSize,this.furni.width=128;break;case 2:this.furni.texture=game.render.newTexture(game.render.tilesets.furni,sx+game.tileSize+game.tileSize+game.tileSize,sy,game.tileSize,128),this.furni.height=128,this.furni.width=game.tileSize;break;case 3:this.furni.texture=game.render.newTexture(game.render.tilesets.furni,sx,sy,game.tileSize,128),this.furni.height=128,this.furni.width=game.tileSize}if(3==this.data.blocks&&(this.furni.texture=game.render.newTexture(game.render.tilesets.furni,sx+1,sy,4*game.tileSize,4*game.tileSize),this.furni.height=4*game.tileSize,this.furni.width=4*game.tileSize),5==this.data.blocks&&(this.furni.texture=game.render.newTexture(game.render.tilesets.furni,sx,sy,2*game.tileSize,2*game.tileSize),this.furni.height=2*game.tileSize,this.furni.width=2*game.tileSize),4==this.data.blocks)switch(game.tools.direction){case 0:this.furni.texture=game.render.newTexture(game.render.tilesets.furni,sx+game.tileSize+game.tileSize,sy,game.tileSize,128),this.furni.height=128,this.furni.width=game.tileSize;break;case 1:this.furni.texture=game.render.newTexture(game.render.tilesets.furni,sx+game.tileSize,sy,game.tileSize,128),this.furni.height=128,this.furni.width=game.tileSize;break;case 2:this.furni.texture=game.render.newTexture(game.render.tilesets.furni,sx+game.tileSize+game.tileSize+game.tileSize,sy,game.tileSize,128),this.furni.height=128,this.furni.width=game.tileSize;break;case 3:this.furni.texture=game.render.newTexture(game.render.tilesets.furni,sx,sy,game.tileSize,128),this.furni.height=128,this.furni.width=game.tileSize}var canWallBuild=!0;if(!0!==this.data.data.wallBuild&&(4==this.data.blocks?3<=game.drawMatrix[game.gridPos(x)][game.gridPos(y+64)][0]&&2<=game.drawMatrix[game.gridPos(x)][game.gridPos(y+64)][1]&&(canWallBuild=!1,"allowwall"==this.data.collide&&"brickholder"==game.world.objects[i].name&&(canWallBuild=!0)):3<=game.drawMatrix[game.gridPos(x)][game.gridPos(y)][0]&&2<=game.drawMatrix[game.gridPos(x)][game.gridPos(y)][1]&&(canWallBuild=!1,"allowwall"==this.data.collide&&"brickholder"==game.world.objects[i].name&&(canWallBuild=!0))),0==game.world.objects.length&&(this.lastsweep=!0),this.canCommit=this.lastsweep&&canWallBuild,this.lastsweep&&canWallBuild?this.furni.tint=16777215:this.furni.tint=16711680,0<game.world.objects.length){checkIncrementer=10,(isNaN(this.collisionCheckId)||null==this.collisionCheckId||0==this.collisionCheckId)&&(this.fullsweep=!0,this.collisionCheckId=0);var startId=this.collisionCheckId,endId=this.collisionCheckId+checkIncrementer;endId>game.world.objects.length?(this.collisionCheckId=0,endId-=endId-game.world.objects.length):this.collisionCheckId=endId,game.debug("Last sweep: "+this.lastsweep+"check world objects Start: "+startId+"End: "+endId);for(var i=startId;i<endId;i++)void 0!==game.world.objects[i]&&(game.world.objects[i].tint=16777215,!0!==game.world.objects[i].data.buildFloor||"brickholder"==game.world.objects[i].name?"allowwall"!=this.data.collide||"brickholder"!=game.world.objects[i].name?(game.world.rCollision(this.furni,game.world.objects[i])||game.world.rCollision(this.standArea,game.world.objects[i]))&&(!0===this.data.data.dismantle?(this.canCommit=!0,game.world.objects[i].tint=65280,this.collide=game.world.objects[i]):(this.fullsweep=!1,game.world.objects[i].tint=16711680)):game.debug("brickholder 2"):game.debug("brickholder 1"));endId==game.world.objects.length&&(this.lastsweep=this.fullsweep)}else this.canCommit=!0;void 0!==this.data.offsetX?this.furni.x=x-this.data.offsetX:this.furni.x=x,void 0!==this.data.offsetY?this.furni.y=y-this.data.offsetY:this.furni.y=y,console.log("---UHHH-----")},newTool.deactivate=function(){void 0!==this.furni&&this.furni.destroy(),(this.createFurni=!0)===this.data.data.standArea&&void 0!==this.standArea&&(this.standArea.destroy(),game.world.removeObject(this.standArea.id)),!0===this.data.data.standArea2&&void 0!==this.standArea2&&(this.standArea2.destroy(),game.world.removeObject(this.standArea2.id)),!0===this.data.data.standArea3&&void 0!==this.standArea&&(this.standArea3.destroy(),game.world.removeObject(this.standArea3.id)),!0===this.data.data.standArea4&&void 0!==this.standArea4&&(game.world.removeObject(this.standArea4.id),this.standArea4.destroy())},newTool.onMouseUp=function(x,y){},this.activeTool=newTool},this.setStaffTool=function(tool){var newTool=new Tool(tool.name);newTool.data=tool,newTool.createFurni=!0,newTool.canCommit=!0,newTool.onMouseDown=function(x,y){if(!game.spend(this.data.cost))return game.pooraf({data:{pay:this.data.cost},x:x,y:y}),0;game.ouching({data:{pay:this.data.cost},x:x,y:y}),life=game.ai.createLife(x,y,this.data.across,this.data.down),life.data=game.clone(this.data.data),life.data.across=this.data.across,life.data.down=this.data.down,life.data.job=this.data.name},newTool.onMouseMove=function(x,y){var tileDown=this.data.down,sx=0*game.tileSize,sy=(tileDown-1)*game.tileSize;Math.floor(x/game.tileSize),Math.floor(y/game.tileSize);x=game.atGridPos(game.gridPos(x)),y=game.atGridPos(game.gridPos(y));var w=game.tileSize,h=game.tileSize;!0===this.createFurni?(this.standArea={},this.standArea2={},this.standArea3={},this.standArea4={},this.furni=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.skins,sx,sy,w,h)),this.furni.alpha=.5,game.render.objectLayer.addChild(this.furni),this.createFurni=!1):this.furni.texture=game.render.newTexture(game.render.tilesets.skins,sx,sy,w,h),this.furni.x=x,this.furni.y=y},newTool.onMouseUp=function(x,y){},newTool.deactivate=function(){void 0!==this.furni&&void 0!==this.furni.destroy&&this.furni.destroy(),this.createFurni=!0},this.activeTool=newTool},this.setActiveTool=function(name){game.cursorUnHide(),-1!=this.activeToolIndex&&game.tools.deactivate();for(var i=0;i<this.tools.length;i++){if(game.debug("Is "+this.tools[i].name+" === "+name),this.tools[i].name==name){this.activeToolIndex=i,this.activeTool=this.tools[i],void 0!==this.tools[i].activated&&this.tools[i].activated();break}this.activeToolIndex=-1,game.debug("Cant find tool: "+name)}},this.deactivate=function(){void 0!==this.activeTool&&this.activeTool.deactivate()},this.mouseDown=function(x,y){this.inBounds(x,y)&&(this.mouseDownX=x,this.mouseDownY=y,!(this.isMouseDown=!0)!==this.activeTool&&void 0!==this.activeTool.onMouseDown&&this.activeTool.onMouseDown(x,y))},this.mouseX=0,this.mouseY=0,this.mouseMove=function(x,y){this.mouseX=x,this.mouseY=y},this.inBounds=function(x,y){return 0<x&&0<y&&x<game.mapDimension*game.tileSize&&y<game.mapDimension*game.tileSize},this.mouseUp=function(x,y){this.inBounds(x,y)&&(this.isMouseDown=!1,(game.quickRender=!1)!==this.activeTool&&void 0!==this.activeTool.onMouseUp&&this.activeTool.onMouseUp(x,y))},this.init=function(){game.render.draw.plugins.interaction.on("mousedown",function(e){game.ui.mouseDown(e)}),game.render.draw.plugins.interaction.on("mousemove",function(e){game.ui.mouseMove(e)}),game.render.draw.plugins.interaction.on("mouseup",function(e){game.ui.mouseUp(e)}),game.debug("Tools loaded")}}function UI(game){(this.garbageBin=void 0)===this.garbageBin&&(this.garbageBin=document.createElement("div"),this.garbageBin.style.display="none",document.body.appendChild(this.garbageBin)),this.discardElement=function(element){this.garbageBin.appendChild(element),this.garbageBin.innerHTML=""},game.debug("UI loading"),this.mouseDownX=0,this.mouseDownY=0,this.clicked=!1,this._PADDING_SMALL=10,this._PADDING_MEDIUM=25,this._PADDING_LARGE=50,this._VIEWPORT_BOTTOM=RENDER_HEIGHT,this._VIEWPORT_RIGHT=RENDER_WIDTH,this._MAX_VIEWPORT_WIDTH=960,this._MAX_VIEWPORT_HEIGHT=480,this.init=function(){this.cache={"/view_item.php":"view_item.php?v=1","/game_frame_top.php":"game_frame_top.php?v=1"}},this.render=function(delta){},this.tick=function(){},this.stageMousePos=function(stage,mX,mY){var scale=game.camera.scale;return{x:Math.floor(mX-game.camera.offsetX)/scale,y:Math.floor(mY-game.camera.offsetY)/scale}},this.mouseDown=function(e){var mouse=game.ui.stageMousePos(game.stageUI,e.data.global.x,e.data.global.y);game.ui.mouseDownX=mouse.x,game.ui.mouseDownY=mouse.y,!1===game.ui.clicked&&game.tools.mouseDown(mouse.x,mouse.y),game.ui.clicked=!1},this.mouseMove=function(e){var mouse=game.ui.stageMousePos(game.stageUI,e.data.global.x,e.data.global.y);game.mouseX=mouse.x,game.mouseY=mouse.y,game.tools.mouseMove(mouse.x,mouse.y)},this.mouseUp=function(e){if(!1===game.ui.clicked){var mouse=game.ui.stageMousePos(game.stageUI,e.data.global.x,e.data.global.y);game.tools.mouseUp(mouse.x,mouse.y)}game.ui.clicked=!1},this.purge=function(d){var i,l,n,a=d.attributes;if(a)for(i=a.length-1;0<=i;i-=1)"function"==typeof d[n=a[i].name]&&(d[n]=null);if(a=d.childNodes)for(l=a.length,i=0;i<l;i+=1)purge(d.childNodes[i])},this.rebindHover=function(el){$(el).unbind("hover"),$(el).hover(function(){console.debug("in"),game.OverGameUI=!0},function(){console.debug("out"),game.OverGameUI=!1})},this.rebindUI=function(el){$(el).draggable({cancel:".ui-window .ui-window-container"}),$("div, p").disableSelection();var boxes=$(".ui-window");boxes.click(function(){console.debug("zcheck");var el=$(this),max=0;boxes.each(function(){var z=parseInt($(this).css("z-index"),10);z=isNaN(z)?0:z,max=Math.max(max,z)}),el.css("z-index",max+1)}),$(".ui-window-top-bar h4").click(function(){console.debug("zcheck");$(this);var max=0;parent=$(this).parent().parent(),$(".ui-window").each(function(){var z=parseInt($(this).css("z-index"),10);z=isNaN(z)?0:z,max=Math.max(max,z)}),parent.css("z-index",max+1)}),$(el).find(".x").click(function(){$(this).parent().parent().parent().css("display","none"),frame=$(this).parent().parent().parent().find("iframe")[0],frame.contentWindow.location.reload(),setTimeout(function(){frame.remove()},1e3),$(this).find(".ui-draggable").draggable("destroy"),$(this).off(),$(this).parent().parent().parent().find("*").unbind(),game.ui.purge($(this).parent().parent().parent()[0]),$(this).parent().parent().parent().remove()}),$(el).find(".x-hide").click(function(){$(this).parent().parent().parent().css("display","none")})},this.resizeFrameFromChild=function(frameId){var iFrameID=$(this).parent().find("#"+frameId);iFrameID&&(iFrameID.height="",iFrameID.height=iFrameID.contentWindow.document.body.scrollHeight+"px")},this.iframeLoaded=function(iframe){var iFrameID=iframe;iFrameID&&(iFrameID.height="",iFrameID.height=iFrameID.contentWindow.document.body.scrollHeight+"px")},this.test=function(src){el=$("#ui-window").clone(!0),el.css("display","block"),el.removeAttr("id"),void 0!==this.cache[src]&&(src=this.cache[src]),iframe=el.find("iframe"),iframe.attr("src",src),$(body).append(el),this.rebindUI(el),this.rebindHover(el)},this.transparent=function(name,src){console.log("Trans:"+name),null==document.getElementById(name)?(console.log("Crate new"),el=$("#ui-window-transparent").clone(!0),el.css("display","block"),el.attr("id",name),void 0!==this.cache[src]&&(src=this.cache[src]),iframe=el.find("iframe"),iframe.attr("src",src),$("#overall").append(el),this.rebindUI(el)):console.log("Exists")},this.showInfoWindow=function(){el=$("#view_item"),el.css("display","block")},$("#close-game-log").click(function(){game.ui.hideGameLog()}),this.showGameLog=function(){$("#game-log").css("height",game.ui._VIEWPORT_BOTTOM-100+"px"),el=$("#game-log"),el.css("display","block")},this.hideGameLog=function(){el=$("#game-log"),el.css("display","none")},this.furniWindow=function(){uiFrame=$("#furni-window"),uiFrame.css("display","block")},this.infoWindow=function(name,src){el=$("#ui-window-container"),void 0!==this.cache[src]&&(src=this.cache[src]),iframe=el.find("iframe"),iframe.attr("src",src),el.attr("id",name),$("#overall").append(el),this.rebindUI(el),this.rebindHover(el)},this.topWindow=function(src){el=$("#ui-window-info"),el.css("display","block"),void 0!==this.cache[src]&&(src=this.cache[src]),iframe=el.find("iframe"),iframe.attr("src",src),$(body).append(el),this.rebindHover(el)}}function World(game){this.currentHour=0,this.lastHour=0,this.objects=[],this.index={},this.addObject=function(objectToAdd){this.objects.push(objectToAdd),!1!==objectToAdd.built&&this.addToIndex(objectToAdd.name,objectToAdd)},this.addToIndex=function(indexName,objectToAdd){game.debug("Adding "+objectToAdd.name+" to index: "+indexName),void 0===this.index[indexName]&&(this.index[indexName]={}),void 0===(this.index[indexName][objectToAdd.id]=objectToAdd).indexes&&(objectToAdd.indexes=[]),objectToAdd.indexes.push(indexName)},this.removeRemnants=function(object){void 0!==object.standArea&&object.standArea.destroy(),void 0!==object.standArea2&&object.standArea2.destroy(),void 0!==object.standArea3&&object.standArea3.destroy(),void 0!==object.standArea4&&object.standArea4.destroy()},this.finalDestroy=function(object){this.removeObject(object.id),this.removeFromAllIndexes(object),this.removeRemnants(object),object.destroy()},this.newFurniFromObject=function(furni,x,y){console.debug("rubbish at"+x+" "+y);var furniObj=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.furni,64*(furni.across-1),64*(furni.down-1),64,64));return furniObj.name=furni.name,furniObj.readName=furni.readName,furniObj.height=furni.height,furniObj.width=furni.width,furniObj.data=game.clone(furni.data),game.render.objectLayer.addChild(furniObj),game.world.addObject(furniObj),furniObj},this.furniFromObject=function(furni){var furniObj=new WorldObject(furni.x,furni.y,game.render.newTexture(furni.tileSetName,furni.framex,furni.framey,furni.width,furni.height));furniObj.name=furni.name,furniObj.readName=furni.readName,furniObj.built=furni.built,furniObj.height=furni.height,furniObj.width=furni.width,furniObj.data=game.clone(furni.data),furniObj.alpha=furni.alpha,game.render.objectLayer.addChild(furniObj),game.world.addObject(furniObj),void 0!==game.onBuildFunctions[furniObj.data.buildFunction]&&game.onBuildFunctions[furniObj.data.buildFunction](furniObj)},this.quickObject=function(across,down,x,y,w,h,tileset){return sx=(across-1)*game.tileSize,sy=(down-1)*game.tileSize,void 0===tileset&&(tileset=game.render.tilesets.furni),object=new WorldObject(x,y,game.render.newTexture(tileset,sx,sy,w,h)),object.width=w,object.height=h,object},this.removeObject=function(id){for(var i=0;i<this.objects.length;i++)if(this.objects[i].id==id){this.objects.splice(i,1);break}},this.removeFromAllIndexes=function(object){if(void 0!==object.indexes){if(0===object.indexes.length)return 1;for(var k=0;k<object.indexes.length;k++)this.removeFromIndex(object.indexes[k],object)}},this.isInIndex=function(indexName,object){return void 0!==this.index[indexName]&&void 0!==this.index[indexName][object.id]},this.removeFromIndex=function(indexName,object,destroy){void 0===destroy&&(destroy=!0),game.debug("Remove from: "+indexName+" - "+object.id),void 0!==this.index[indexName]&&void 0!==this.index[indexName][object.id]&&(destroy?this.index[indexName][object.id].destroy():this.index[indexName][object.id]="",delete this.index[indexName][object.id])},this.rooms=[],this.init=function(){this.currentTime=game.stats.time,game.debug("Loading world"),this.timeFunctions=[];for(var i=0;i<=23;i++)this.timeFunctions.push([]);game.debug(this.timeFunctions),game.debug("Loaded world"),game.deSpawn=new WorldObject(1,1)},this.raining=!1,this.startRain=function(){this.raining=!0,emitterContainer=new PIXI.Container,emitterContainer.displayGroup=game.render.lifeLayer,game.render.baseStage.addChild(emitterContainer),this.rain=new PIXI.particles.Emitter(emitterContainer,[game.render.cache[game.render.tilesets.rain].clone()],{alpha:{start:.5,end:.5},scale:{start:1,end:1},color:{start:"ffffff",end:"ffffff"},speed:{start:1,end:500},startRotation:{min:65,max:65},rotationSpeed:{min:0,max:0},lifetime:{min:5,max:5},blendMode:"normal",frequency:1,emitterLifetime:0,maxParticles:1e3,pos:{x:0,y:0},addAtBack:!1,spawnType:"rect",spawnRect:{x:0,y:0,w:1280,h:720}})},this.rainTick=function(){!0===game.world.raining&&this.rain.update(1)},this.distance=function(x1,y1,x2,y2){return x2||(x2=0),y2||(y2=0),Math.sqrt((x2-x1)*(x2-x1)+(y2-y1)*(y2-y1))},this.tick=function(){this.lastHour!=this.currentHour&&(game.debug("New hour"),!0===game.started&&game.debug("Saving game"),this.runTimeFunctions(this.currentHour)),this.lastHour=this.currentHour},this.runTimeFunctions=function(hour){for(var i=0;i<this.timeFunctions[hour].length;i++)this.timeFunctions[hour][i].run()},this.addTimeFunction=function(time,data,callFunction){this.timeFunctions[time].push({time:time,name:data.id,data:data,run:callFunction})},this.removeTimeFunction=function(time,data){for(var i=0;i<this.timeFunctions[time].length;i++)if(this.timeFunctions[time][i].name==data.id){this.timeFunctions[time].splice(i,1);break}},this.render=function(){for(destroyItem in game.world.index.destroy)destroyItem=game.world.index.destroy[destroyItem],this.finalDestroy(destroyItem);this.rainTick(),this.tick()},this.markRemoveObject=function(item){item.alpha=0,item.built=!1,item.markedForDestroy=!0,this.addToIndex("destroy",item)},this.rCollision=function(obj1,obj2){return void 0!==obj1.collisionWidth?rect1={x:obj1.x,y:obj1.y,width:obj1.collisionWidth,height:obj1.collisionHeight}:rect1=obj1,void 0!==obj2.collisionWidth?rect2={x:obj2.x,y:obj2.y,width:obj2.collisionWidth,height:obj2.collisionHeight}:rect2=obj2,rect1.x<rect2.x+rect2.width&&rect1.x+rect1.width>rect2.x&&rect1.y<rect2.y+rect2.height&&rect1.height+rect1.y>rect2.y}}function GameAudio(){this.lastFile="coinspin.mp3",this.playing=!0,this.init=function(){this.player=document.getElementById("audio"),this.bitMax=_AUDIO.length},this.loadAudio=function(callback){console.debug("callback for audio bits: "+callback),this.bitsReady=callback,this.loadBits()},this.sounds={},this.mute=function(){for(audio in this.playing=!1,game.audio.sounds)game.audio.sounds[audio].muted=!0},this.unMute=function(){for(audio in this.playing=!0,game.audio.sounds)!0!==game.audio.sounds[audio].mute&&(game.audio.sounds[audio].muted=!1)},this.loadAudioFile=function(name,file,volume,loop){audio=new Audio,audio.src=game.folder+"audio/"+file,audio.canPlayThrough=function(){this.removeEventListener("canplaythrough",this.canPlayThrough),this.removeEventListener("load",this.canPlayThrough),console.log("canplaythrough"),game.audio.loadedFiles++,game.audio.loadedFiles===_AUDIO.length&&(void 0!==game.audio.bitsReady?(console.log("audio bits complete"),game.audio.bitsReady=void 0):console.log("audio bits complete but no callback"))},/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&void 0!==game.audio.bitsReady&&(game.audio.bitsReady(),game.audio.bitsReady=void 0),console.log("Audio file: "+file),file==game.audio.lastFile&&(console.log("Saw last"),console.log("audio bits complete"),game.audio.bitsReady()),audio.addEventListener("canplaythrough",audio.canPlayThrough,!1),audio.addEventListener("load",audio.canPlayThrough,!1),3<audio.readyState&&audio.canPlayThrough(),audio.volume=volume,!0===loop&&("boolean"==typeof audio.loop?audio.loop=!0:audio.addEventListener("ended",function(){this.currentTime=0,this.playOnce()},!1)),this.sounds[name]=audio},this.loadedFiles=0,this.bitNumber=0,this.bitMax=0,this.loadLoop=function(){game.debug("Audio Bits: "+this.bitNumber),this.bitNumber<this.bitMax?(audioFile=_AUDIO[this.bitNumber],name=audioFile[0],file=audioFile[1],volume=audioFile[2],loop=audioFile[3]||!1,game.render.loadingText("Loading audio: "+name),game.audio.loadAudioFile(name,file,volume,loop),game.audio.bitNumber++):game.audio.loading=!1},this.loading=!0,this.loadBits=function(){!function loadloop(){!0===game.audio.loading&&(game.audio.loadLoop(),window.requestAnimationFrame(loadloop))}(),game.debug("Loading Audio Bits")}}Audio.prototype.isEnded=function(){return this.duration===this.currentTime||0===this.played.length},Audio.prototype.playMany=function(){window.chrome&&this.load(),this.playOnce()},Audio.prototype.playOnce=function(){game.audio.playing&&this.play()};function Saves(game){this.generateScreenshot=function(download){},this.unload=function(callback){console.log("##############Unloading##############"),console.log("Objects: "+game.world.objects.length);for(var l=0;l<game.tempObjects.length;l++)game.tempObjects[l].destroy();for(l=0;l<game.flashingLights.length;l++)game.flashingLights[l].destroy();for(l=0;l<game.rotatingLights.length;l++)game.rotatingLights[l].destroy();game.flashingLights=[],game.rotatingLights=[];for(var d=0;d<game.world.objects.length;d++)console.debug("Destroy: "+game.world.objects[d].id),game.world.markRemoveObject(game.world.objects[d]);for(l=0;l<game.ai.life.length;l++)game.ai.life[l].destroy(),!1!==game.ai.life[l].animRender&&void 0!==game.ai.life[l].animRender&&game.ai.life[l].animRender.destroy(),!1!==game.ai.life[l].tagline&&void 0!==game.ai.life[l].tagline&&game.ai.life[l].tagline.destroy();game.world.objects=[],game.ai.life=[],TWEEN.removeAll(),wait=callback()},this.save=function(){console.log("Save function"),this.saveReady()},this.remoteLoad=function(){game.wmapi.plot.load(game.plotid,function(plotData){game.saves.load(plotData)})},this.remoteSave=function(savefile,screenshot,saveslot){game.wmapi.plot.save(game.plotid,savefile)},this.saveReady=function(){console.log("Save ready"),saveFile=this.createSaveFile(),localStorage.setItem(game.saveFile,saveFile)},this.createSaveFile=function(){var saveFile={drawMatrix:game.drawMatrix,life:game.ai.life,objects:game.world.objects,settings:game.settings,cash:game.cash,isOpen:game.isOpen};return JSON.stringify(saveFile)},this.saveGame=function(){this.save()},this.load=function(load){if(this.unload(function(){}),"string"==typeof load){console.log("Loading save from string"),game.debug(load);load=JSON.parse(load)}(game.saveFile=load).items=load.objects,game.saveItems=load.items,"string"==typeof game.saveFile.savefile&&(load=JSON.parse(game.saveFile.savefile)),game.debug("SETTINGS: "+load.settings),console.log(load),!1!==load.settings&&void 0!==load.settings&&(game.settings=game.clone(load.settings));for(var i=0;i<game.ai.life.length;i++)game.ai.removeLifeAtIndex(i);void 0!==load.cash&&(game.cash=load.cash);for(i=0;i<load.life.length;i++){var life=load.life[i];console.log("Load life"),console.log(life),void 0!==life.data.patient?eLife=game.ai.createLife(life.x,life.y,life.data.body.across,life.data.body.down,!0,life.data.patient.female,life.data.body.hat,life.data.body.head,life.data.patient.rawName):eLife=game.ai.createLife(life.x,life.y,life.data.across,life.data.down),eLife.data=game.clone(life.data),eLife.giveJob(eLife.data.job)}void 0!==load.isOpen&&(game.isOpen=load.isOpen),void 0!==load.vars&&void 0!==load.vars.drawMatrix&&(load.drawMatrix=load.vars.drawMatrix),game.drawMatrix=load.drawMatrix;for(var blockMatrix=[],y=0;y<game.drawMatrix.length;y++){xMatrix=[];for(var x=0;x<game.drawMatrix[y].length;x++)3<=game.drawMatrix[x][y][0]?xMatrix.push(1):xMatrix.push(0);console.debug(xMatrix),blockMatrix.push(xMatrix)}for(i=0;i<game.ai.maxWorkers;i++)game.ai.pathFinders[i].postMessage(["creategrid",blockMatrix]);for(itemid in load=[],game.grid.needRedraw=!0,game.grid.drawn=!1,game.grid.drawWalls(),game.render.render(),console.debug("------ITEMS------"),console.debug(load.items),console.debug("------ITEMS------"),game.saveItems){var furni=game.saveItems[itemid];if(void 0!==furni.across&&(furni.framex=64*(furni.across-1),furni.framey=64*(furni.down-1)),5==furni.blocks&&(furni.height=2*game.tileSize,furni.width=2*game.tileSize),void 0!==furni.x){console.log("---FURNI----"),console.debug(furni),furni.tileSetName=game.folder+furni.tileSetName;var furniObj=new WorldObject(furni.x,furni.y,game.render.newTexture(furni.tileSetName,furni.framex,furni.framey,furni.width,furni.height));furniObj.name=furni.name,furniObj.readName=furni.readName,furniObj.built=!0,furniObj.height=furni.height,furniObj.width=furni.width,furniObj.data=game.clone(furni.data),furniObj.alpha=1,furniObj.x=furni.x,furniObj.y=furni.y,furniObj.itemid=itemid,furniObj.direction=furni.direction,game.render.objectLayer.addChild(furniObj),console.log("---FURNIOBJ----"),console.debug(furniObj),game.world.addObject(furniObj),void 0!==furniObj.data?void 0!==furniObj.data.buildFunction&&void 0!==game.onBuildFunctions[furniObj.data.buildFunction]&&game.onBuildFunctions[furniObj.data.buildFunction](furniObj):furniObj.data={},game.world.defaultBuildFunction(furniObj),console.log("----Loading objects----"),console.log(furniObj),game.clearLog()}}setTimeout(function(){game.grid.needRedraw=!0,game.grid.drawn=!1,game.grid.drawWalls()},1e4),game.ai.pathFinders[1].postMessage(["getgrid"]),game.render.hideLoad()},this.loadGame=function(){load=function(){saveFile=localStorage.getItem(game.saveFile),console.debug(saveFile),game.saves.load(saveFile)},this.unload(load)}}var tool=function(){game.tutStep=-1,game.endTutorial=function(){game.ui.closeTutorial()},game.showTutorial=function(){null!=game.ui.tuts&&(void 0===game.ui.tuts[game.tutStep]?(game.debug("Can't find tut step: "+game.tutStep),game.endTutorial()):game.ui.tuts[game.tutStep]())},game.nextTutorial=function(){game.tutStep++,game.showTutorial()},game.tut=function(number){return game.tutStep===number&&(game.nextTutorial(),!0)},game.completedTutorial=function(){text="You have completed the tutorial, you can now move on to the full game!",game.ui.notification(text,function(){game.ui.challengeMenu()})}};bootStrap.push(tool);var extend=function(){game.ai.createInteractionsIndex()};bootStrap.push(extend);var extend=function(){game.ai.statuses.calc=function(life){life.calcattempts++,500<life.calcattempts&&(life.calcattempts=0,life.status="wait")},game.ai.statuses.arrived=function(life){life.status="wait"},game.ai.statuses.destroy=function(life){life.status="destroying",void 0!==life.tween&&life.tween.stop(),game.ai.removeLife(life.id)},game.ai.statuses.running=function(life){life.walkAlongPath()},game.ai.statuses.stationaryanim=function(life){}};bootStrap.push(extend);bootStrap.push(function(){game.checkMissionComplete=function(missionName){return!!game.checkMission(missionName)&&(void 0!==game.missions[missionName]?(mission=game.clone(game.missions[missionName]),delete game.missions[missionName]):mission={pay:0},!(game.settings.locked["challenge_"+missionName]=!1))},game.checkMission=function(missionName){return safetyReturn=!0,void 0===game.missions[missionName]?(game.debug("Can't check if "+missionName+" is complete, its undefined"),safetyReturn):void 0===game.missions[missionName].checkMission?(game.debug("Can't check if "+missionName+" is complete, its undefined, there is no checkMission function"),safetyReturn):(isComplete=game.missions[missionName].checkMission(),game.debug(missionName+" is complete: "+isComplete),isComplete)},game.pickLevel=function(level,newGame){if(levelLoad=level,game.debug("New level: "+level),void 0===newGame&&(newGame=!0),void 0===game.challenges[level])return game.debug("Cant find level:"+level),!1;level=game.challenges[level],game.missions={};for(var i=0;i<level.challenges.length;i++)void 0!==game.allMissions[level.challenges[i]]?(void 0!==game.settings.locked["challenge_"+level.challenges[i]]&&!0!==newGame||(game.settings.locked["challenge_"+level.challenges[i]]=!0),!0===game.settings.locked["challenge_"+level.challenges[i]]&&(game.allMissions[level.challenges[i]].name=level.challenges[i],game.missions[level.challenges[i]]=game.clone(game.allMissions[level.challenges[i]]))):game.debug("Can't find mission: "+level.challenges[i]);return void 0!==level.load&&level.load(),game.settings.level=levelLoad,!0===game.started?game.ui.showMainUI():game.ui.hideMainUI(),game.ui.updateAll(),!0}});var tool=function(){var inventory={items:{},addItem:function(item,amount){void 0===amount&&(amount=1),void 0===this.items[item]&&(this.items[item]=0),this.items[item]+=amount},removeItem:function(item,amount){void 0===amount&&(amount=1),void 0===this.items[item]&&(this.items[item]=0),this.items[item]-=amount},getItem:function(item){return void 0!==this.items[item]&&this.items[item]},getItems:function(){return this.items}};game.globalInventory=game.clone(inventory)};bootStrap.push(tool);var tool=function(){!1!==game.selector&&void 0!==game.selector?(game.selector.x=game.atGridPos(gotoX),game.selector.y=game.atGridPos(gotoY)):(game.selector=new PIXI.Graphics,game.selector.beginFill(65280,0),game.selector.lineStyle(2,16777215),game.selector.drawRect(0,0,game.tileSize,game.tileSize),game.render.lifeLayer.addChild(game.selector),game.selector.visible=!1);var newTool=new Tool("select");newTool.selectedLife=function(life){life.selected=!0,game.ui.addUI("selected-life",life,function(life){var panelX=life.x+16,panelY=life.y-16,offsetY=0;game.ui.panel1(panelX,panelY,100,100),offsetY+=20,game.ui.text1(life.name,panelX+10,panelY+offsetY),offsetY+=20,game.ui.text1("Age: "+life.age,panelX+10,panelY+offsetY)},function(){},function(){},function(){},life.x,life.y,64,64)},newTool.onMouseDown=function(e){game.mouseDown=!0,this.mouseDownX=e.clientX,this.mouseDownY=e.clientY;gridX=game.gridPos(game.mouseX),gridY=game.gridPos(game.mouseY),console.log(["Sho",gridX,gridY]),tileType=game.grid.getTileType(gridX,gridY),console.log(e),show={},show.name="Tile: "+tileType,game.selector.x=game.atGridPos(gridX),game.selector.y=game.atGridPos(gridY),game.selector.visible=!0,game.ui.showItemInfo(show)},newTool.onMouseMove=function(e){game.cursorUnHide()},newTool.onMouseUp=function(e){game.mouseDown=!1},newTool.deactivate=function(e){game.selector.visible=!1},game.tools.addTool(newTool),game.tools.setActiveTool("select")};bootStrap.push(tool);var tool=function(){var newTool=new Tool("markroom");newTool.rectangle=!1,newTool.mouseDown=!1,newTool.hoverBricks=[],newTool.wallHolder=function(x,y){var sx=0*game.tileSize,sy=6*game.tileSize,bricks=(Math.floor(x/game.tileSize),Math.floor(y/game.tileSize),new WorldObject(x,y,game.render.newTexture(game.render.tilesets.background,sx,sy,64,64)));bricks.data.buildWall=!0,bricks.x=x,bricks.y=y,game.render.world.addChild(bricks),this.hoverBricks.push(bricks)},newTool.onMouseDown=function(e){newTool.mouseDown=!0,this.rectangle=new PIXI.Graphics,game.render.world.addChild(this.rectangle),this.startX=0,this.startY=0,this.endX=0,this.endY=0},newTool.rooms=[],newTool.onMouseMove=function(x,y){var stagePos={x:x,y:y};if(!0===this.mouseDown)startX=game.atGridPos(game.gridPos(game.tools.mouseDownX)),startY=game.atGridPos(game.gridPos(game.tools.mouseDownY)),endX=game.atGridPos(game.gridPos(stagePos.x)),endY=game.atGridPos(game.gridPos(stagePos.y)),!1!==this.rectangle&&(this.rectangle.destroy(),this.rectangle=!1),this.rectangle=new PIXI.Graphics,this.rectangle.beginFill(16777215),this.rectangle.alpha=.2,this.rectangle.id=game.randID(),this.rectangle.drawRect(startX,startY,endX-startX,endY-startY),game.render.world.addChild(this.rectangle),game.world.removeObject(this.rectangle.id);else{for(var i=0;i<this.hoverBricks.length;i++)this.hoverBricks[i].destroy();startX=game.atGridPos(game.gridPos(game.tools.mouseDownX)),startY=game.atGridPos(game.gridPos(game.tools.mouseDownY)),endX=game.atGridPos(game.gridPos(stagePos.x)),endY=game.atGridPos(game.gridPos(stagePos.y)),this.wallHolder(endX,endY)}},newTool.onMouseUp=function(x,y){if(!0===this.mouseDown){!1!==this.rectangle&&(this.rectangle.destroy(),this.rectangle=!1),this.mouseDown=!1;var stagePos={x:x,y:y};startX=game.atGridPos(game.gridPos(game.tools.mouseDownX)),startY=game.atGridPos(game.gridPos(game.tools.mouseDownY)),endX=game.atGridPos(game.gridPos(stagePos.x)),endY=game.atGridPos(game.gridPos(stagePos.y)),this.startX=startX,this.startY=startY,this.endX=endX,this.endY=endY,room=new PIXI.Graphics,this.rooms.push(room),room.beginFill(16777215),room.tint=2728872,room.alpha=1,room.id=game.randID(),room.drawRect(startX,startY,endX-startX,endY-startY),game.render.world.addChild(room)}},newTool.activated=function(){},newTool.deactivate=function(){for(var i=0;i<this.hoverBricks.length;i++)this.hoverBricks[i].destroy();!1!==this.rectangle&&(this.rectangle.destroy(),this.rectangle=!1),console.debug("deactivate"),game.ui.markroomActive=!1;for(var b=0;b<this.rooms.length;b++)void 0!==this.rooms[b].destroy&&(this.rooms[b].visible=!1),game.world.removeObject(this.rooms[b].id);this.rooms=[]},game.tools.addTool(newTool)};bootStrap.push(tool);var textStyles=function(){grayText="#9b9fa5",game.render.textStyles["win-title"]={fontFamily:"Bungee",fontSize:24,fill:"#38b64d",strokeThickness:0},game.render.textStyles["win-text"]={fontFamily:"Bungee",fontSize:20,fill:"#38b64d",wordWrap:!0,strokeThickness:0,wordWrapWidth:260},game.render.textStyles.time={fontFamily:"Aldrich",fontSize:24,fill:"#FFFFFF",fontWeight:"bold",strokeThickness:0},game.render.textStyles["sign-closed"]={fontFamily:"Bungee",fontSize:16,fill:"#bf4e50",strokeThickness:0},game.render.textStyles["sign-open"]={fontFamily:"Bungee",fontSize:16,fill:"#38b64d",strokeThickness:0},game.render.textStyles["happy-peeps"]={fontFamily:"Bungee",fontSize:16,fill:"#FFFFFF",strokeThickness:0},game.render.textStyles["menu-title-red"]={fontFamily:"Bungee",fontSize:42,fill:"#FFFFFF",padding:10},game.render.textStyles["menu-title-red-shadow"]={fontFamily:"Bungee",fontSize:50,fill:"#000000",padding:10,fontWeight:"bold",stroke:"#CCCCCC",strokeThickness:2},game.render.textStyles["menu-title"]={fontFamily:"Aldrich",fontSize:28,fill:"#FFFFFF",fontWeight:"bold",strokeThickness:0},game.render.textStyles["standard-title"]={fontFamily:"Aldrich",fontSize:18,fill:"#FFFFFF",fontWeight:"bold",strokeThickness:0},game.render.textStyles["button-text-green"]={fontFamily:"Aldrich",fontSize:14,fill:"#FFFFFF",fontWeight:"bold",strokeThickness:0},game.render.textStyles.standard={fontFamily:"Aldrich",fontSize:12,fill:"#FFFFFF",fontWeight:"bold",strokeThickness:0},game.render.textStyles.small={fontFamily:"Aldrich",fontSize:10,fill:"#FFFFFF",fontWeight:"bold",strokeThickness:0},game.render.textStyles["small-item-title"]={fontFamily:"Aldrich",fontSize:10,fill:"#FFFFFF",fontWeight:"bold",strokeThickness:0,wordWrap:!0,wordWrapWidth:50,align:"center"},game.render.textStyles["small-pawn-title"]={fontFamily:"Aldrich",fontSize:16,fill:"#FFFFFF",strokeThickness:0,wordWrap:!0,wordWrapWidth:100,align:"center"},game.render.textStyles["small-item-title-disabled"]={fontFamily:"Aldrich",fontSize:10,fill:grayText,fontWeight:"bold",strokeThickness:0,wordWrap:!0,wordWrapWidth:50,align:"center"},game.render.textStyles["smallish-bold"]={fontFamily:"Aldrich",fontSize:14,fill:"#FFFFFF",fontWeight:"bold",strokeThickness:0},game.render.textStyles.smallish={fontFamily:"Aldrich",fontSize:14,fill:"#FFFFFF",fontWeight:"normal",strokeThickness:0},game.render.textStyles.itemtitle={fontFamily:"Aldrich",fontSize:20,fill:"#00f6dd",strokeThickness:0},game.render.textStyles.cash={fontFamily:"Aldrich",fontSize:22,fill:"#2cd633",strokeThickness:0},game.render.textStyles["med-cash"]={fontFamily:"Aldrich",fontSize:18,fill:"#2cd633",strokeThickness:0},game.render.textStyles.smallcash={fontFamily:"Aldrich",fontSize:16,fill:"#2cd633",fontWeight:"bold",strokeThickness:0},game.render.textStyles.redcash={fontFamily:"Aldrich",fontSize:22,fill:"#732323",strokeThickness:0},game.render.textStyles.helptext={fontFamily:"Aldrich",fontSize:14,fill:"#000000",wordWrap:!0,wordWrapWidth:260,strokeThickness:0},game.render.textStyles.whitedesc={fontFamily:"Aldrich",fontSize:14,fill:"#ffffff",wordWrap:!0,wordWrapWidth:260,strokeThickness:0},game.render.textStyles.longerwhitedesc={fontFamily:"Aldrich",fontSize:14,fill:"#ffffff",wordWrap:!0,wordWrapWidth:600,strokeThickness:0}};bootStrap.push(textStyles);bootStrap.push(function(){game.ui.updateAll=function(){game.ui.mainUI(),!0!==game.started&&game.ui.hideMainUI(),game.tools.closeMenus(),game.ui.hideItemInfo(),game.ui.hideAlmanac(),game.ui.closeUpgradesMenu(),game.ui.closeMissionsMenu()}});var tool=function(){game.ui.largeLabel=function(x,y,k){return labelKV=game.render.text(k,"smallish-bold"),labelKV.x=x,labelKV.y=y,labelKV},game.ui.labelValue=function(x,y,k,v){return labelKV=game.render.text(k+": "+v,"button-text-green"),labelKV.x=x,labelKV.y=y,labelKV},game.ui.closeButton=function(x,y,closeFunction,stage){return sx=1344,sy=320,xButton=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,64,64)),void 0!==closeFunction&&(xButton.closeFunction=closeFunction),xButton.width=64,xButton.height=64,xButton.displayGroup=game.render.uiLayer,void 0===stage?game.render.baseStage.addChild(xButton):stage.addChild(xButton),xButton.interactive=!0,game.attachCursorEvents(xButton),xButton.on("pointerdown",function(){game.ui.clicked=!0,game.audio.sounds.blonk.playOnce(),void 0!==this.closeFunction&&this.closeFunction(),this.destroy()}),xButton},game.ui.greenButton=function(text,x,y,clickFunction,clickData,stage){return sw=100,sh=64,sx=1088,sy=384,button=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,sw,sh)),void 0!==clickFunction&&(button.clickFunction=clickFunction),button.width=sw,button.height=sh,button.interactive=!0,game.attachCursorEvents(button),button.on("pointerdown",function(){game.audio.sounds.blonk.playOnce(),void 0!==this.clickFunction&&this.clickFunction(clickData)}),button.on("pointerover",function(){game.audio.sounds.tack.playOnce(),this.filters=[new PIXI.filters.OutlineFilter(2,13421772)]}),button.on("pointerout",function(){this.filters=null}),button.displayGroup=game.render.uiLayer,null==stage?game.render.baseStage.addChild(button):stage.addChild(button),unlockText=game.render.text(text,"button-text-green"),unlockText.x=button.x+button.width/2+2.5,unlockText.y=button.y+unlockText.height/2+5,unlockText.anchor.set(.5),unlockText.displayGroup=game.render.uiLayer,null==stage?game.render.baseStage.addChild(unlockText):stage.addChild(unlockText),[button,unlockText]},game.ui.upArrow=function(){return sx=19*game.tileSize,sy=5*game.tileSize,arrow=new WorldObject(-10,-10,game.render.newTexture(game.render.tilesets.gui,sx,sy,32,32)),arrow.width=32,arrow.height=32,arrow.interactive=!0,game.attachCursorEvents(arrow),arrow},game.ui.downArrow=function(){return sx=20*game.tileSize,sy=5*game.tileSize,arrow=new WorldObject(-10,-10,game.render.newTexture(game.render.tilesets.gui,sx,sy,32,32)),arrow.width=32,arrow.height=32,arrow.interactive=!0,game.attachCursorEvents(arrow),arrow}};bootStrap.push(tool);bootStrap.push(function(){game.ui.almanacContents=[],game.ui.hideAlmanac=function(){for(var i=0;i<game.ui.almanacContents.length;i++)game.ui.almanacContents[i].destroy(),game.ui.almanacContents[i]=void 0;game.ui.almanacContents=[]},game.ui.canIncreaseMarketing=function(amount){return!(game.ui.calcBudget()+amount>game.settings.marketing.maxBudget)},game.ui.canDecreaseMarketing=function(amount){return!(game.ui.calcBudget()+amount>game.settings.marketing.maxBudget)},game.ui.calcBudget=function(){return 10*game.settings.marketing.custBudget+5*game.settings.marketing.decreaseRuffians+15*game.settings.marketing.increasePros},game.ui.showAlmanac=function(){game.ui.hideAlmanac(),game.ui.hideItemInfo(),void 0===game.settings.marketing&&(game.settings.marketing={},game.settings.marketing.custBudget=0,game.settings.marketing.increasePros=0,game.settings.marketing.decreaseRuffians=0,game.settings.marketing.maxBudget=250);var y=100;sx=0,sy=0,windowW=game.ui._MAX_VIEWPORT_WIDTH,windowH=game.ui._MAX_VIEWPORT_HEIGHT,windowX=game.ui._VIEWPORT_RIGHT/2-windowW/2,windowY=game.ui._VIEWPORT_BOTTOM/2-windowH/2,windowYTop=30,x=windowX,y=windowY,0===game.ui.almanacContents.length&&(game.ui.almanacContents.push(game.render.window(0,0,game.ui._VIEWPORT_RIGHT,game.ui._VIEWPORT_BOTTOM,0,.8)),game.ui.almanacContents.push(game.render.window(25,25,game.ui._VIEWPORT_RIGHT-50,game.ui._VIEWPORT_BOTTOM-50,0,.5))),windowTitle=game.render.text("Data","menu-title-red"),windowTitle.x=windowX+windowW/2-windowTitle.width/2,windowTitle.y=windowYTop,game.ui.almanacContents.push(windowTitle),game.render.baseStage.addChild(windowTitle),y=100,x=64,maxBudget=game.settings.marketing.maxBudget,windowText=game.render.text("Max Budget: $"+maxBudget,"standard-title"),windowText.x=x,windowText.y=y,game.ui.almanacContents.push(windowText),game.render.baseStage.addChild(windowText),y+=50,budget=game.ui.calcBudget(),windowText=game.render.text("Marketing Budget: $"+budget,"standard-title"),windowText.x=x,windowText.y=y,game.ui.almanacContents.push(windowText),game.render.baseStage.addChild(windowText),y+=50,upArrow=game.ui.upArrow(),upArrow.x=x,upArrow.y=y-25,game.render.baseStage.addChild(upArrow),upArrow.on("pointerdown",function(){game.settings.marketing.custBudget<100&&game.ui.canIncreaseMarketing(10)&&(game.settings.marketing.custBudget++,game.ui.showAlmanac())}),downArrow=game.ui.downArrow(),downArrow.x=x,downArrow.y=y+5,game.render.baseStage.addChild(downArrow),downArrow.on("pointerdown",function(){0<game.settings.marketing.custBudget&&(game.settings.marketing.custBudget--,game.ui.showAlmanac())}),game.ui.almanacContents.push(upArrow),game.ui.almanacContents.push(downArrow),windowText=game.render.text(game.settings.marketing.custBudget+"%","standard-title"),windowText.x=x+50,windowText.y=y,game.ui.almanacContents.push(windowText),game.render.baseStage.addChild(windowText),windowText=game.render.text("Convince customers to bring more cash (1% = $10)","standard-title"),windowText.x=x+50+50,windowText.y=y,game.ui.almanacContents.push(windowText),game.render.baseStage.addChild(windowText),y+=80,upArrow=game.ui.upArrow(),upArrow.x=x,upArrow.y=y-25,game.render.baseStage.addChild(upArrow),upArrow.on("pointerdown",function(){game.settings.marketing.decreaseRuffians<100&&game.ui.canIncreaseMarketing(10)&&(game.settings.marketing.decreaseRuffians++,game.ui.showAlmanac())}),downArrow=game.ui.downArrow(),downArrow.x=x,downArrow.y=y+5,game.render.baseStage.addChild(downArrow),downArrow.on("pointerdown",function(){0<game.settings.marketing.decreaseRuffians&&(game.settings.marketing.decreaseRuffians--,game.ui.showAlmanac())}),game.ui.almanacContents.push(upArrow),game.ui.almanacContents.push(downArrow),windowText=game.render.text(game.settings.marketing.decreaseRuffians+"%","standard-title"),windowText.x=x+50,windowText.y=y,game.ui.almanacContents.push(windowText),game.render.baseStage.addChild(windowText),windowText=game.render.text("Attract friendlier customers (1% = $5)","standard-title"),windowText.x=x+50+50,windowText.y=y,game.ui.almanacContents.push(windowText),game.render.baseStage.addChild(windowText),y+=80,upArrow=game.ui.upArrow(),upArrow.x=x,upArrow.y=y-25,game.render.baseStage.addChild(upArrow),upArrow.on("pointerdown",function(){game.settings.marketing.increasePros<100&&game.ui.canIncreaseMarketing(10)&&(game.settings.marketing.increasePros++,game.ui.showAlmanac())}),downArrow=game.ui.downArrow(),downArrow.x=x,downArrow.y=y+5,game.render.baseStage.addChild(downArrow),downArrow.on("pointerdown",function(){0<game.settings.marketing.increasePros&&(game.settings.marketing.increasePros--,game.ui.showAlmanac())}),game.ui.almanacContents.push(upArrow),game.ui.almanacContents.push(downArrow),windowText=game.render.text(game.settings.marketing.increasePros+"%","standard-title"),windowText.x=x+50,windowText.y=y,game.ui.almanacContents.push(windowText),game.render.baseStage.addChild(windowText),windowText=game.render.text("Attract experienced customers (1% = $15)","standard-title"),windowText.x=x+50+50,windowText.y=y,game.ui.almanacContents.push(windowText),game.render.baseStage.addChild(windowText),closeFunction=function(){game.ui.clicked=!0,game.ui.hideAlmanac()},game.ui.almanacContents.push(game.ui.closeButton(game.ui._VIEWPORT_RIGHT-70,30,closeFunction))}});var tool=function(){game.ui.notificationContents=[],game.ui.notificationColor="red",game.ui.notification=function(text,closeFunctionCallback){game.track.event("Notification",text);sx=0,"red"==game.ui.notificationColor?(sy=1344,game.ui.notificationColor="blue"):(sy=1536,game.ui.notificationColor="red");var x=game.ui._VIEWPORT_RIGHT/2-224,y=game.ui._VIEWPORT_BOTTOM/2-96;return windowX=x,windowY=y,0===game.ui.notificationContents.length?(game.ui.notificationContents.push(game.render.window(0,0,game.ui._VIEWPORT_RIGHT,game.ui._VIEWPORT_BOTTOM,0,.8)),this.r=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,448,192)),this.r.width=448,this.r.height=192,this.r.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(this.r),game.ui.notificationContents.push(this.r),upgradeName=game.render.text(text,"helptext"),upgradeName.x=x+150,upgradeName.y=y+60,game.ui.notificationContents.push(upgradeName),game.render.baseStage.addChild(upgradeName)):this.r.visible=!0,closeFunction=function(){game.play=!0;for(var i=0;i<game.ui.notificationContents.length;i++)game.ui.notificationContents[i].destroy(),game.ui.notificationContents[i]=void 0;game.ui.notificationContents=[],void 0!==closeFunctionCallback&&closeFunctionCallback()},game.ui.notificationContents.push(game.ui.closeButton(windowX+448-25,windowY,closeFunction)),game.render.render(),game.play=!1,this.r},game.ui.yesno=function(text,yes,no,showX){return game.ui.aOrB(text,yes,no,_LANG.YES,_LANG.NO,showX)},game.ui.changeStage=function(){for(var i=0;i<game.ui.notificationContents.length;i++)game.ui.notificationContents[i].destroy(),game.ui.notificationContents[i]=void 0;game.ui.notificationContents=[],oui=function(){game.started=!1,game.ui.clicked=!0,game.ui.closeTutorial(),game.ui.hideItemInfo(),game.ui.challengeMenu()},nom=function(){},game.ui.yesno(_LANG.SWITCH_STAGES,oui,nom,!0)},game.ui.winStage=function(text){game.apis.ng.unlockMedal("Completed 1st challenge!");for(var i=0;i<game.ui.notificationContents.length;i++)game.ui.notificationContents[i].destroy(),game.ui.notificationContents[i]=void 0;game.ui.notificationContents=[],game.ui.closeTutorial(),game.ui.hideItemInfo(),game.track.event("Win Stage",text);sx=0,sy=1728,game.ui.notificationColor="blue";var x=game.ui._VIEWPORT_RIGHT/2-224,y=game.ui._VIEWPORT_BOTTOM/2-96;windowX=x,windowY=y,0===game.ui.notificationContents.length?(game.ui.notificationContents.push(game.render.window(0,0,game.ui._VIEWPORT_RIGHT,game.ui._VIEWPORT_BOTTOM,0,.8)),this.r=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,448,192)),this.r.width=448,this.r.height=192,this.r.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(this.r),game.ui.notificationContents.push(this.r),innerText=game.render.text(_LANG.CHALLENGE_COMPLETE,"win-title"),innerText.x=x+224,innerText.y=y+32,innerText.anchor.set(.5),game.ui.notificationContents.push(innerText),game.render.baseStage.addChild(innerText),innerText=game.render.text(text,"win-text"),innerText.x=x+224,innerText.y=y+32+32+32,innerText.anchor.set(.5),game.ui.notificationContents.push(innerText),game.render.baseStage.addChild(innerText),closeFunction=function(){game.play=!0;for(var i=0;i<game.ui.notificationContents.length;i++)game.ui.notificationContents[i].destroy(),game.ui.notificationContents[i]=void 0;game.ui.notificationContents=[]},closeFunctionYes=function(){game.ui.challengeMenu();for(var i=0;i<game.ui.notificationContents.length;i++)game.ui.notificationContents[i].destroy(),game.ui.notificationContents[i]=void 0;game.ui.notificationContents=[]},goButton=game.ui.greenButton(_LANG.CONTINUE,this.r.x+this.r.width-100,15+this.r.y+this.r.height,closeFunctionYes,level),game.ui.notificationContents.push(goButton[0]),game.ui.notificationContents.push(goButton[1]),goButton=game.ui.greenButton(_LANG.KEEP_PLAYING,this.r.x,15+this.r.y+this.r.height,closeFunction,level),game.ui.notificationContents.push(goButton[0]),game.ui.notificationContents.push(goButton[1])):this.r.visible=!0},game.ui.earntCash=function(text,cash){game.audio.sounds.win.playOnce();for(var i=0;i<game.ui.notificationContents.length;i++)game.ui.notificationContents[i].destroy(),game.ui.notificationContents[i]=void 0;game.ui.notificationContents=[],game.ui.closeTutorial(),game.ui.hideItemInfo(),game.track.event("Earnt Cash",text);sx=0,sy=1728,game.ui.notificationColor="blue";var x=game.ui._VIEWPORT_RIGHT/2-224,y=game.ui._VIEWPORT_BOTTOM/2-96;windowX=x,windowY=y,0===game.ui.notificationContents.length?(game.ui.notificationContents.push(game.render.window(0,0,game.ui._VIEWPORT_RIGHT,game.ui._VIEWPORT_BOTTOM,0,.8)),this.r=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,448,192)),this.r.width=448,this.r.height=192,this.r.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(this.r),game.ui.notificationContents.push(this.r),innerText=game.render.text(_LANG.TASK_COMPLETE,"win-title"),innerText.x=x+224,innerText.y=y+32,innerText.anchor.set(.5),game.ui.notificationContents.push(innerText),game.render.baseStage.addChild(innerText),innerText=game.render.text(_LANG.CASH_REWARD+"$"+cash,"cash"),innerText.x=x+224,innerText.y=y+32+32+32,innerText.anchor.set(.5),game.ui.notificationContents.push(innerText),game.render.baseStage.addChild(innerText),closeFunctionYes=function(){game.ui.clicked=!0,game.play=!0,game.tut(11);for(var i=0;i<game.ui.notificationContents.length;i++)game.ui.notificationContents[i].destroy(),game.ui.notificationContents[i]=void 0;game.ui.notificationContents=[]},goButton=game.ui.greenButton(_LANG.CONTINUE,this.r.x+this.r.width-100,15+this.r.y+this.r.height,closeFunctionYes),game.ui.notificationContents.push(goButton[0]),game.ui.notificationContents.push(goButton[1])):this.r.visible=!0,game.render.render(),game.play=!1},game.ui.aOrB=function(text,a,b,aText,bText,showX){game.track.event("a or b",text);sx=0,"red"==game.ui.notificationColor?(sy=1344,game.ui.notificationColor="blue"):(sy=1344,game.ui.notificationColor="red");var x=game.ui._VIEWPORT_RIGHT/2-224,y=game.ui._VIEWPORT_BOTTOM/2-96;windowX=x,windowY=y,0===game.ui.notificationContents.length?(game.ui.notificationContents.push(game.render.window(0,0,game.ui._VIEWPORT_RIGHT,game.ui._VIEWPORT_BOTTOM,0,.8)),this.r=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,448,192)),this.r.width=448,this.r.height=192,this.r.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(this.r),game.ui.notificationContents.push(this.r),upgradeName=game.render.text(text,"helptext"),upgradeName.x=x+150,upgradeName.y=y+60,game.ui.notificationContents.push(upgradeName),game.render.baseStage.addChild(upgradeName)):this.r.visible=!0,closeFunction=function(){game.play=!0;for(var i=0;i<game.ui.notificationContents.length;i++)game.ui.notificationContents[i].destroy(),game.ui.notificationContents[i]=void 0;game.ui.notificationContents=[],void 0!==b&&b()},!(closeFunctionYes=function(){game.play=!0;for(var i=0;i<game.ui.notificationContents.length;i++)game.ui.notificationContents[i].destroy(),game.ui.notificationContents[i]=void 0;game.ui.notificationContents=[],void 0!==a&&a()})!==showX&&game.ui.notificationContents.push(game.ui.closeButton(windowX+448-25,windowY,closeFunction)),goButton=game.ui.greenButton(aText,this.r.x+this.r.width-100,15+this.r.y+this.r.height,closeFunctionYes),game.ui.notificationContents.push(goButton[0]),game.ui.notificationContents.push(goButton[1]),goButton=game.ui.greenButton(bText,this.r.x,15+this.r.y+this.r.height,closeFunction),game.ui.notificationContents.push(goButton[0]),game.ui.notificationContents.push(goButton[1]),game.render.render(),game.play=!1},game.ui.largeNotification=function(text,closeFunctionCallback){console.debug("NOTIFICATION");sx=512,sy=320,game.ui.notificationColor="blue";var x=game.ui._VIEWPORT_RIGHT/2-224,y=game.ui._VIEWPORT_BOTTOM/2-192;windowX=x,windowY=y,0===game.ui.notificationContents.length?(game.ui.notificationContents.push(game.render.window(0,0,game.ui._VIEWPORT_RIGHT,game.ui._VIEWPORT_BOTTOM,0,.8)),this.r=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,448,384)),this.r.width=448,this.r.height=384,this.r.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(this.r),game.ui.notificationContents.push(this.r),upgradeName=game.render.text(text,"helptext"),upgradeName.x=x+150,upgradeName.y=y+60,game.ui.notificationContents.push(upgradeName),game.render.baseStage.addChild(upgradeName)):this.r.visible=!0,closeFunction=function(){game.play=!0;for(var i=0;i<game.ui.notificationContents.length;i++)game.ui.notificationContents[i].destroy(),game.ui.notificationContents[i]=void 0;game.ui.notificationContents=[],void 0!==closeFunctionCallback&&closeFunctionCallback()},game.ui.notificationContents.push(game.ui.closeButton(windowX+448-25,windowY,closeFunction)),game.render.render(),game.play=!1}};bootStrap.push(tool);var tool=function(){game.ui.bottomPage=1;for(var activatedFunction=function(){if(game.tools.deactivate(),void 0!==this.tutNumbers)for(var t=0;t<this.tutNumbers.length&&!game.tut(this.tutNumbers[t]);t++);var pointerDown1=function(){game.ui.clicked=!0,game.tools.setFurniTool(this.tool)},pointerDown2=function(){game.ui.clicked=!0,game.tools.setStaffTool(this.tool)},pointerDown3=function(){game.ui.clicked=!0,game.tools.setSquaringTool(this.tool)},pointerDown4=function(){game.ui.clicked=!0,game.tools.setSquaringTool(this.tool)},pointerDown5=function(){game.ui.clicked=!0,game.tools.setActiveTool(this.tool.name)},pointerLocked=function(){(game.ui.clicked=!0)===game.settings.locked.upgrades?game.ui.notification("You must unlock this item first"):game.ui.showUpgradeMenu()},furniOver=function(){game.ui.showItemInfo(this.tool)};if(game.ui.reShowItemInfo(),"planning"==this.name)return game.tools.setActiveTool("markroom"),!1;0<game.tools.menuButtons.length&&game.tools.closeMenus();var x=0,y=0;!0===this.rotate&&(x=game.ui._VIEWPORT_BOTTOM<600?350:270,y=game.ui._VIEWPORT_BOTTOM-260,sx=17*game.tileSize,sy=3*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,64,64)),staticImage.x=x+46,staticImage.y=y,staticImage.width=64,staticImage.height=64,staticImage.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(staticImage),staticImage.readName=_LANG.ROTATE,staticImage.interactive=!0,game.attachCursorEvents(staticImage),staticImage.on("pointerdown",function(){game.ui.clicked=!0,3<=game.tools.direction?game.tools.direction=0:game.tools.direction++}),staticImage.on("pointerover",function(){game.ui.showItemInfo(this)}),game.tools.menuButtons.push(staticImage)),x=game.ui._PADDING_SMALL,y=game.ui._VIEWPORT_BOTTOM-64-game.ui._PADDING_SMALL-game.ui._PADDING_SMALL;var h=100;closeX=850,closeY=y-h-32,this.window=game.render.window(x,y-h-10,850,h,4079166,.99);var tools=this.toolContents;game.debug("Boostrap tools UI"),x+=game.ui._PADDING_SMALL+game.ui._PADDING_SMALL+game.ui._PADDING_SMALL,y=y-h+game.ui._PADDING_SMALL;var offsetPage=10*game.ui.bottomPage,offsetPageStart=10*game.ui.bottomPage-10;offsetPage>tools.length&&(offsetPage=tools.length),1<game.ui.bottomPage?alpha=1:alpha=0,sx=19*game.tileSize,sy=5*game.tileSize,upArrow=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,32,32)),upArrow.alpha=alpha,upArrow.width=32,upArrow.height=32,upArrow.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(upArrow),upArrow.tool=this,upArrow.x=10,upArrow.y=game.ui._VIEWPORT_BOTTOM-167,upArrow.interactive=!0,game.attachCursorEvents(upArrow),game.tools.menuButtons.push(upArrow),upArrow.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(upArrow),1<game.ui.bottomPage&&upArrow.on("pointerdown",function(){game.ui.clicked=!0,game.ui.bottomPage--,this.tool.activated()}),offsetPageStart+10<tools.length?alpha=1:alpha=0,sx=20*game.tileSize,sy=5*game.tileSize,downArrow=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,32,32)),downArrow.alpha=alpha,downArrow.width=32,downArrow.height=32,downArrow.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(downArrow),downArrow.tool=this,downArrow.x=10,downArrow.y=game.ui._VIEWPORT_BOTTOM-130,downArrow.interactive=!0,game.attachCursorEvents(downArrow),game.tools.menuButtons.push(downArrow),downArrow.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(downArrow),offsetPageStart+10<tools.length&&downArrow.on("pointerdown",function(){game.ui.clicked=!0,game.ui.bottomPage++,this.tool.activated()}),x+=15;for(var sw=64,sh=64,i=offsetPageStart;i<offsetPage;i++){switch(tools[i].blocks){case 1:sh=sw=64,sx=(tools[i].across-1)*sw,sy=(tools[i].down-1)*game.lifeTileSize;break;case 2:sw=64,sh=128,sx=(tools[i].across-1)*sw,sy=(tools[i].down-1)*game.lifeTileSize;break;case 3:sh=sw=192,sx=64*(tools[i].across-1),sy=64*(tools[i].down-1);break;case 4:sw=64,sh=128,sx=(tools[i].across-1)*sw,sy=(tools[i].down-1)*game.lifeTileSize;break;case 5:sh=sw=128,sx=64*(tools[i].across-1),sy=(tools[i].down-1)*game.lifeTileSize}switch(containerWindow=game.render.window(x-7.5,y+7.5,64,64),this.name){case"furni":case"walls":furniView=new WorldObject(x,y+15,game.render.newTexture(game.render.tilesets.furni,sx,sy,sw,sh));break;case"floors":furniView=new WorldObject(x,y+15,game.render.newTexture(game.render.tilesets.background,sx,sy,sw,sh));break;case"staff":sx=tools[i].across*sw,furniView=new WorldObject(x,y+15,game.render.newTexture(game.render.tilesets.skins,sx,sy,sw,sh)),furniView.x+=0;break;default:furniView=new WorldObject(x,y+15,game.render.newTexture(game.render.tilesets.furni,sx,sy,sw,sh))}switch(tools[i].blocks){case 1:furniView.width=48,furniView.height=48;break;case 2:furniView.width=32,furniView.height=48,furniView.x+=8;break;case 3:furniView.width=48,furniView.height=48;break;case 4:furniView.width=32,furniView.height=48,furniView.x+=8}if(furniView.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(containerWindow),furniView.tool=tools[i],furniView.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(furniView),furniView.interactive=!0,game.attachCursorEvents(furniView),furniView.on("pointerover",furniOver),game.isLocked(tools[i].codename)){furniView.alpha=.5;var genToolButton=game.render.text(tools[i].readName,"small-item-title-disabled",game.render.uiLayer);furniView.on("pointerdown",pointerLocked)}else{genToolButton=game.render.text(tools[i].readName,"small-item-title",game.render.uiLayer);switch(this.name){case"furni":furniView.on("pointerdown",pointerDown1);break;case"staff":furniView.on("pointerdown",pointerDown2);break;case"floors":furniView.on("pointerdown",pointerDown3);break;case"walls":furniView.on("pointerdown",pointerDown4);break;case"planning":furniView.on("pointerdown",pointerDown5);break;default:furniView.on("pointerdown",pointerDown1)}}genToolButton.x=x+24,genToolButton.y=y-2.5,genToolButton.anchor.set(.5,.5),game.tools.menuButtons.push(genToolButton),game.tools.menuButtons.push(furniView),game.tools.menuButtons.push(containerWindow),x+=80}game.tools.menuWindows.push(this.window),game.tools.menuButtons.push(game.ui.closeButton(closeX,closeY,function(){game.tools.setActiveTool("select"),game.tools.closeMenus()})),game.ui.showItemInfo(this)},deactivateFunction=function(){game.ui.bottomPage=1,"planning"==this.name&&game.grid.hideRooms()},menus=game.ui.data.menus,j=0;j<menus.length;j++){var toolName=menus[j].name,toolContents=menus[j].tools,newTool=new Tool(toolName);newTool.hoverBricks=[],newTool.toolContents=toolContents,newTool.window={},newTool.buttons=[],newTool.readName=menus[j].readName,newTool.tutNumbers=menus[j].tutNumbers,newTool.description=menus[j].description,newTool.rotate=menus[j].rotate||!1,newTool.activated=activatedFunction,newTool.deactivate=deactivateFunction,game.tools.addTool(newTool)}};bootStrap.push(tool);var ui=function(){game.ui.mainUIComponents=[],game.ui.hideMainUI=function(){if(0!==game.ui.mainUIComponents.length){for(var d=0;d<game.ui.mainUIComponents.length;d++)game.ui.mainUIComponents[d].alpha=0;game.ui.mainUIComponents=[]}},game.ui.showMainUI=function(){if(0!==game.ui.mainUIComponents.length){for(var d=0;d<game.ui.mainUIComponents.length;d++)game.ui.mainUIComponents[d].alpha=1;game.ui.mainUIComponents=[]}},game.ui.mainUI=function(){if(0!==game.ui.mainUIComponents.length){for(var d=0;d<game.ui.mainUIComponents.length;d++)game.ui.mainUIComponents[d].destroy();game.ui.mainUIComponents=[]}var x=5,y=100;sx=19*game.tileSize,sy=3*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,64,64)),staticImage.x=x,staticImage.y=y,staticImage.width=64,staticImage.height=64,staticImage.displayGroup=game.render.uiLayer,!0===game.settings.locked.game_log&&(staticImage.alpha=.5),game.render.baseStage.addChild(staticImage),game.ui.mainUIComponents.push(staticImage),staticImage.readName=_LANG.GAMELOG,staticImage.interactive=!0,game.attachCursorEvents(staticImage),staticImage.on("pointerdown",function(){(game.ui.clicked=!0)===game.settings.locked.game_log?game.ui.notification("You have not unlocked the game log yet"):game.ui.showGameLog()}),staticImage.on("pointerover",function(){game.ui.showItemInfo(this)}),y+=74,sx=18*game.tileSize,sy=3*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,64,64)),staticImage.x=x,staticImage.y=y,staticImage.width=64,staticImage.height=64,staticImage.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(staticImage),game.ui.mainUIComponents.push(staticImage),staticImage.readName=_LANG.UPGRADES,staticImage.interactive=!0,game.attachCursorEvents(staticImage),!0===game.settings.locked.upgrades&&(staticImage.alpha=.5),staticImage.on("pointerdown",function(){(game.ui.clicked=!0)===game.settings.locked.upgrades?game.ui.notification("You have not unlocked upgrades yet"):(game.ui.showUpgradeMenu(),game.tut(16))}),staticImage.on("pointerover",function(){game.ui.showItemInfo(this)}),y+=74,sx=21*game.tileSize,sy=3*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,64,64)),staticImage.x=x,staticImage.y=y,missionsY=staticImage.y,staticImage.width=64,staticImage.height=64,staticImage.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(staticImage),!0===game.settings.locked.missions&&(staticImage.alpha=.5),game.ui.mainUIComponents.push(staticImage),staticImage.readName=_LANG.MISSIONS,staticImage.interactive=!0,game.attachCursorEvents(staticImage),staticImage.on("pointerdown",function(){(game.ui.clicked=!0)===game.settings.locked.missions?game.ui.notification("You have not unlocked missions yet"):(game.ui.missionsMenu(),game.tut(10))}),staticImage.on("pointerover",function(){game.ui.showItemInfo(this)}),y+=74,sx=20*game.tileSize,sy=3*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,64,64)),staticImage.x=x,staticImage.y=y,staticImage.width=64,staticImage.height=64,staticImage.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(staticImage),!0===game.settings.locked.hire_staff&&(staticImage.alpha=.5),game.ui.mainUIComponents.push(staticImage),staticImage.readName=_LANG.STAFF,staticImage.interactive=!0,game.attachCursorEvents(staticImage),staticImage.on("pointerdown",function(){(game.ui.clicked=!0)===game.settings.locked.hire_staff?game.ui.notification("You have not unlocked hiring staff yet"):game.ui.availablePatientsMenu()}),staticImage.on("pointerover",function(){game.ui.showItemInfo(this)});var menus=game.ui.data.menus;game.debug("Boostrap tools UI");var pointerDown=function(){!0!==game.settings.locked[this.toolName]?(game.tools.activeMenu=this.toolName,game.ui.clicked=!0,game.tools.setActiveTool(this.toolName)):(game.ui.clicked=!0,game.ui.notification(_LANG.MUST_UNLOCK_TOOL))};x=game.ui._PADDING_SMALL+game.ui._PADDING_SMALL,y=game.ui._VIEWPORT_BOTTOM-64-game.ui._PADDING_SMALL,window=game.render.window(0,y+32,RENDER_WIDTH,64+game.ui._PADDING_SMALL+game.ui._PADDING_SMALL,2697513);for(var i=0;i<menus.length;i++)menu=menus[i],sx=(menu.across-1)*game.tileSize,sy=(menu.down-1)*game.tileSize,genToolButton=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,64,64)),genToolButton.x=x,genToolButton.y=y,genToolButton.interactive=!0,game.attachCursorEvents(genToolButton),genToolButton.toolName=menu.name,genToolButton.readName=menu.readName,!0===game.settings.locked[genToolButton.toolName]&&(genToolButton.alpha=.5),genToolButton.on("pointerdown",pointerDown),genToolButton.on("pointerover",function(){game.ui.showItemInfo(this)}),genToolButton.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(genToolButton),game.ui.mainUIComponents.push(genToolButton),x+=70;x=game.ui._VIEWPORT_RIGHT-150,y=game.ui._VIEWPORT_BOTTOM-75,sx=37*game.tileSize,sy=0*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,192,64)),staticImage.x=x,staticImage.y=y,staticImage.width=192,staticImage.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(staticImage),game.ui.mainUIComponents.push(staticImage);x=5,y=10;sx=17*game.tileSize,sy=4*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,192,64)),staticImage.x=x,staticImage.y=y,staticImage.width=192,staticImage.height=64,staticImage.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(staticImage),game.ui.mainUIComponents.push(staticImage);this.toolContents;x+=35,y+=19,game.ui.cash=game.render.text("0","cash",game.render.uiLayer),game.ui.cash.x=x,game.ui.cash.y=y,game.ui.cash.interactive=!0,game.attachCursorEvents(game.ui.cash),game.ui.cash.readName=_LANG.CASH,game.ui.cash.on("pointerover",function(){game.ui.showItemInfo(this)}),x=game.ui._VIEWPORT_RIGHT-40,y=25,y=15,sx=27*game.tileSize,sy=5*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,32,32)),staticImage.x=x-45,staticImage.y=y,staticImage.width=32,staticImage.height=32,staticImage.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(staticImage),game.ui.mainUIComponents.push(staticImage),staticImage.interactive=!0,game.attachCursorEvents(staticImage),staticImage.on("pointerdown",function(){game.ui.clicked=!0,game.saves.saveGame(),game.ui.notification("Game saved!")}),staticImage.readName=_LANG.SAVE,staticImage.on("pointerover",function(){game.ui.showItemInfo(this)}),sx=28*game.tileSize,sy=5*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,32,32)),staticImage.x=x,staticImage.y=y,staticImage.width=32,staticImage.height=32,staticImage.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(staticImage),game.ui.mainUIComponents.push(staticImage),!(staticImage.interactive=!0)===game.audio.playing&&(staticImage.visible=!1),game.attachCursorEvents(staticImage),staticImage.on("pointerdown",function(){(game.ui.clicked=!0)===game.audio.playing&&(this.visible=!1,game.audio.unMuteButton.visible=!0,game.audio.mute())}),staticImage.readName=_LANG.MUTE,staticImage.on("pointerover",function(){game.ui.showItemInfo(this)}),game.audio.muteButton=staticImage,sx=29*game.tileSize,sy=5*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,32,32)),staticImage.x=x,staticImage.y=y,staticImage.width=32,staticImage.height=32,!0===game.audio.playing&&(staticImage.visible=!1),staticImage.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(staticImage),game.ui.mainUIComponents.push(staticImage),staticImage.interactive=!0,game.attachCursorEvents(staticImage),staticImage.on("pointerdown",function(){!(game.ui.clicked=!0)===game.audio.playing&&(this.visible=!1,game.audio.muteButton.visible=!0,game.audio.unMute())}),staticImage.readName=_LANG.UNMUTE,staticImage.on("pointerover",function(){game.ui.showItemInfo(this)}),game.audio.unMuteButton=staticImage,!1===game.settings.locked.missions&&(y=missionsY+42,x=70,sx=31*game.tileSize,sy=5*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,32,32)),staticImage.x=x-32,staticImage.y=y,staticImage.width=32,staticImage.height=32,staticImage.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(staticImage),game.ui.missionCountText=game.render.text("0","small"),game.ui.missionCountText.x=staticImage.x+17,game.ui.missionCountText.y=staticImage.y+15,game.ui.missionCountText.anchor.set(.5),game.ui.mainUIComponents.push(game.ui.missionCountText),game.render.baseStage.addChild(game.ui.missionCountText),game.ui.mainUIComponents.push(staticImage)),y=10,sx=21*game.tileSize,sy=0*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,64,64)),staticImage.readName="Join Discord for Help!",staticImage.interactive=!0,game.attachCursorEvents(staticImage),staticImage.on("pointerover",function(){game.ui.showItemInfo(this)}),staticImage.on("pointerdown",function(){window.open("https://discord.gg/NB2QbS3")}),staticImage.width=64,staticImage.height=64,staticImage.x=210,staticImage.y=y,staticImage.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(staticImage),game.ui.mainUIComponents.push(staticImage),y=10,sx=17*game.tileSize,sy=0*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,128,64)),staticImage.readName=_LANG.LEAVERSHAPPY,staticImage.interactive=!0,staticImage.on("pointerover",function(){game.ui.showItemInfo(this)}),staticImage.width=128,staticImage.height=64,staticImage.x=284,staticImage.y=y,staticImage.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(staticImage),game.ui.happyPeeps=game.render.text("0","happy-peeps"),game.ui.happyPeeps.x=staticImage.x+55,game.ui.happyPeeps.y=staticImage.y+30,game.ui.happyPeeps.anchor.set(.5),game.render.baseStage.addChild(game.ui.happyPeeps),game.ui.mainUIComponents.push(staticImage),game.ui.mainUIComponents.push(game.ui.happyPeeps),y=10,sx=19*game.tileSize,sy=0*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,128,64)),staticImage.readName=_LANG.MAX_PEEPS,staticImage.interactive=!0,staticImage.on("pointerover",function(){game.ui.showItemInfo(this)}),staticImage.width=128,staticImage.height=64,staticImage.x=374,staticImage.y=y,staticImage.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(staticImage),game.ui.maxPeeps=game.render.text("0","happy-peeps"),game.ui.maxPeeps.x=staticImage.x+55,game.ui.maxPeeps.y=staticImage.y+30,game.ui.maxPeeps.anchor.set(.5),game.render.baseStage.addChild(game.ui.maxPeeps),game.ui.mainUIComponents.push(staticImage),game.ui.mainUIComponents.push(game.ui.maxPeeps),this.timeText=game.render.text(game.stats.makeTime(this.gameTime),"time",game.render.uiLayer),this.timeText.x=x-40,this.timeText.anchor.set(.5,.5),this.timeText.y=40,this.timeText.alpha=0,game.ui.mainUIComponents.push(this.timeText),game.ui.mainUIComponents.push(game.ui.cash),maxPeeps=game.propCount(game.world.index.pinball)+game.propCount(game.world.index.arcade),game.ui.cash.text=" "+game.cash,game.ui.happyPeeps.text=game.settings.happyPeeps+"%",game.ui.maxPeeps.text=""+maxPeeps,game.ui.timeText.text=game.stats.makeTime(game.stats.gameTime)},game.ui.mainUI(),game.tickers.push(function(){maxPeeps=game.propCount(game.world.index.pinball)+game.propCount(game.world.index.arcade),game.ui.cash.text=" "+game.fCash(game.cash),game.ui.happyPeeps.text=Math.round(game.settings.happyPeeps)+"%",game.ui.maxPeeps.text=""+maxPeeps,game.ui.timeText.text=game.stats.makeTime(game.stats.gameTime),5<game.propCount(game.missions)?missionCount=5:missionCount=game.propCount(game.missions),void 0!==game.ui.missionCountText&&(game.ui.missionCountText.text=missionCount)})};bootStrap.push(ui);var tool=function(){game.ui.showItemInfoItems=[],game.ui.hideItemInfo=function(){for(var i=0;i<game.ui.showItemInfoItems.length;i++)game.ui.showItemInfoItems[i].destroy();game.ui.showItemInfoItems=[]},game.ui.itemShowing={},game.ui.reShowItemInfo=function(){game.ui.showItemInfo(game.ui.itemShowing)},game.ui.showItemInfo=function(item){if(game.ui.hideItemInfo(),game.ui.itemShowing=item,game.ui._VIEWPORT_BOTTOM<600)var x=85;else x=10;if(game.tools.bottomMenuOpen())var y=game.ui._VIEWPORT_BOTTOM-300;else y=game.ui._VIEWPORT_BOTTOM-200;this.window=game.render.window(x,y,300,100,3618615);this.toolContents;game.debug("Boostrap tools UI"),x+=game.ui._PADDING_SMALL,y+=game.ui._PADDING_SMALL,b=0,blocks=[],blocks.push(game.render.text(item.readName,"itemtitle",game.render.uiLayer)),blocks[b].x=x,blocks[b].y=y,void 0!==item.cost&&(x+=blocks[b].width+10,b++,blocks.push(game.render.text("$"+item.cost,"cash",game.render.uiLayer)),blocks[b].x=x,blocks[b].y=y,x-=blocks[b-1].width+10),b++,y+=25,null!==item.name&&(blocks.push(game.render.text("[Type: "+item.name+"]","smallish",game.render.uiLayer)),blocks[b].x=x,blocks[b].y=y,y+=25,b++),void 0!==item.data&&(void 0!==item.data.pay&&(blocks.push(game.render.text("Pays: $"+item.data.pay,"smallcash",game.render.uiLayer)),blocks[b].x=x,blocks[b].y=y,x-=blocks[b-1].width+10),b++),console.debug(item),game.ui.showItemInfoItems=blocks,game.ui.showItemInfoItems.push(this.window),blocks=[]}};bootStrap.push(tool);var tool=function(){game.ui.upgradeMenuContents=[],game.ui.upgradesPage=1,game.ui.closeUpgradesMenu=function(){for(var i=0;i<game.ui.upgradeMenuContents.length;i++)game.ui.upgradeMenuContents[i].destroy(),game.ui.upgradeMenuContents[i]=void 0;game.ui.upgradeMenuContents=[]},game.ui.showUpgradeMenu=function(){game.ui.closeUpgradesMenu(),game.ui.hideItemInfo();var y=100,sw=1,sh=1;if(sx=0,sy=0,windowW=1e3,windowH=650,windowX=game.ui._VIEWPORT_RIGHT/2-windowW/2,windowY=game.ui._VIEWPORT_BOTTOM/2-windowH/2,windowYTop=windowY,x=windowX,y=windowY,0===game.ui.upgradeMenuContents.length){windowTitle=game.render.text(_LANG.UPGRADES,"menu-title-red"),windowTitle.x=windowX+windowW/2-windowTitle.width/2,windowTitle.y=windowYTop+40+10,game.ui.upgradeMenuContents.push(game.render.window(windowX,windowY,windowW,windowH,0,.8)),game.ui.upgradeMenuContents.push(game.render.window(windowX+40,windowY+40,windowW-40-40,windowH-40-40,0,.5)),this.r=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,sw,sh)),this.r.width=sw,this.r.height=sh,this.r.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(this.r),game.ui.upgradeMenuContents.push(this.r),game.render.baseStage.addChild(windowTitle),game.ui.upgradeMenuContents.push(windowTitle);var currentCol=1,startX=x+75,startY=windowYTop+60+40,offsetPage=6*game.ui.upgradesPage,offsetPageStart=6*game.ui.upgradesPage-6;offsetPage>game.upgrades.tier1.length&&(offsetPage=game.upgrades.tier1.length),1<game.ui.upgradesPage?alpha=1:alpha=0,sx=20*game.tileSize,sy=6*game.tileSize,y=x=10,upArrow=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,64,64)),upArrow.alpha=alpha,upArrow.width=64,upArrow.height=64,upArrow.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(upArrow),upArrow.x=windowX+40+20,upArrow.y=windowY+windowH-40-40-40,upArrow.interactive=!0,game.attachCursorEvents(upArrow),game.ui.upgradeMenuContents.push(upArrow),upArrow.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(upArrow),1<game.ui.upgradesPage&&upArrow.on("pointerdown",function(){game.ui.clicked=!0,game.ui.upgradesPage--,game.ui.closeUpgradesMenu(),game.ui.showUpgradeMenu()}),offsetPageStart+6<game.upgrades.tier1.length?alpha=1:alpha=0,sx=21*game.tileSize,sy=6*game.tileSize,downArrow=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,64,64)),downArrow.alpha=alpha,downArrow.width=64,downArrow.height=64,downArrow.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(downArrow),downArrow.x=windowX+windowW-40-40-40,downArrow.y=windowY+windowH-40-40-40,downArrow.interactive=!0,game.attachCursorEvents(downArrow),game.ui.upgradeMenuContents.push(downArrow),downArrow.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(downArrow),offsetPageStart+6<game.upgrades.tier1.length&&downArrow.on("pointerdown",function(){game.ui.clicked=!0,game.ui.upgradesPage++,game.ui.closeUpgradesMenu(),game.ui.showUpgradeMenu()}),x+=15;sw=64,sh=64;offsetPageStart+6<game.propCount(game.challenges)?alpha=1:alpha=0,x=startX,y=startY;for(var t=offsetPageStart;t<offsetPage;t++)upgrade=game.upgrades.tier1[t],game.ui.upgradeMenuContents.push(game.render.window(x,y+40,64,64,0,.8)),sx=64*(upgrade.across-1),sy=64*(upgrade.down-1),upgradeIcon=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,64,64)),upgradeIcon.width=64,upgradeIcon.height=64,upgradeIcon.x=x,upgradeIcon.y=y+40,game.ui.upgradeMenuContents.push(game.render.window(x-15,y+10,420,120,0,.5)),upgradeIcon.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(upgradeIcon),game.ui.upgradeMenuContents.push(upgradeIcon),!0===game.settings.locked[upgrade.name]?(upgradeCost=game.render.text("$"+upgrade.cost,"smallcash"),upgradeCost.x=x,upgradeCost.y=y+20,game.render.baseStage.addChild(upgradeCost),sw=100,sh=64,sx=1088,sy=384,unlockButton=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,sw,sh)),unlockButton.x=x+80,unlockButton.y=y+85,unlockButton.width=sw,unlockButton.height=sh,unlockButton.upgrade=upgrade,unlockButton.interactive=!0,game.attachCursorEvents(unlockButton),unlockButton.on("pointerdown",function(){if(game.ui.clicked=!0,game.cash<this.upgrade.cost)game.ui.notification(_LANG.CANT_AFFORD);else{if(game.track.event("Upgrade",this.upgrade.readName),this.upgrade.runFunction(),!game.spend(this.upgrade.cost))return game.pooraf({data:{pay:this.upgrade.cost},x:this.x,y:this.y}),0;game.ouching({data:{pay:this.upgrade.cost},x:this.x,y:this.y}),game.ui.showUpgradeMenu()}}),unlockButton.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(unlockButton),unlockText=game.render.text(_LANG.UPGRADE,"button-text-green"),unlockText.x=unlockButton.x+unlockButton.width/2+2.5,unlockText.y=unlockButton.y+unlockText.height/2+5,unlockText.anchor.set(.5),unlockText.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(unlockText),game.ui.upgradeMenuContents.push(upgradeCost),game.ui.upgradeMenuContents.push(unlockButton),game.ui.upgradeMenuContents.push(unlockText),void 0!==upgrade.d1&&(unlockedText=game.render.text(upgrade.d1,"smallish"),unlockedText.x=x+85,unlockedText.y=y+60,game.render.baseStage.addChild(unlockedText),game.ui.upgradeMenuContents.push(unlockedText))):(unlockedText=game.render.text(_LANG.UNLOCKED,"smallcash"),unlockedText.x=x+85,unlockedText.y=y+60,game.render.baseStage.addChild(unlockedText),game.ui.upgradeMenuContents.push(unlockedText)),console.debug(upgrade.readName),upgradeName=game.render.text(upgrade.readName,"standard-title"),upgradeName.x=x+85,upgradeName.y=y+40,game.render.baseStage.addChild(upgradeName),game.ui.upgradeMenuContents.push(upgradeName),2===currentCol?(currentCol=1,y+=150,x=startX):(currentCol++,x+=450)}else this.r.visible=!0;game.ui.upgradeMenuContents.push(game.ui.closeButton(windowX+windowW-40,windowY,game.ui.closeUpgradesMenu))}};bootStrap.push(tool);var tool=function(){game.ui.showElecInfo=[],game.ui.hideElecFurniInfo=function(){for(var i=0;i<game.ui.showElecInfo.length;i++)game.ui.showElecInfo[i].destroy();game.ui.showElecInfo=[],game.ui.furniPriceTemp={}},game.ui.furniPriceTemp={},game.ui.showElecFurniInfo=function(item){if(game.ui.hideElecFurniInfo(),1==game.settings.locked.elec_prices)return!1;"BROKEN"!==item.data.status&&(item.data.status="OPERATIONAL");var elecStatus="OFF";game.world.isInIndex("on",item)&&(elecStatus="ON");void 0!==item.data.elecUnits&&(electUnits=item.data.elecUnits),statusText=game.langConvert(item.data.status),textStyle="standard";var sw=4*game.tileSize,sh=5*game.tileSize,y=100,x=game.ui._VIEWPORT_RIGHT/2-sw/2;windowX=x,windowY=y,windowW=sw,windowH=sh,infoWindow=game.world.quickObject(9,1,x,y,sw,sh,game.render.tilesets.gui),infoWindow.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(infoWindow),game.ui.showElecInfo.push(infoWindow),windowText=game.render.text(item.readName),windowText.x=windowX+25,windowText.y=windowY+25,windowText.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(windowText),game.ui.showElecInfo.push(windowText),windowText=game.render.text("Status: "+statusText,textStyle),windowText.x=windowX+25,windowText.y=windowY+50,windowText.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(windowText),game.ui.showElecInfo.push(windowText),windowText=game.render.text("Electricity: "+elecStatus,textStyle),windowText.x=windowX+25,windowText.y=windowY+75,windowText.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(windowText),game.ui.showElecInfo.push(windowText),windowText=game.render.text("Electricity units: 0",textStyle),windowText.x=windowX+25,windowText.y=windowY+100,windowText.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(windowText),game.ui.showElecInfo.push(windowText),windowText=game.render.text("Earnt: $"+game.fCash(100),textStyle),windowText.x=windowX+25,windowText.y=windowY+125,windowText.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(windowText),game.ui.showElecInfo.push(windowText),windowText=game.render.text("Taken: "+item.taken,textStyle),windowText.x=windowX+25,windowText.y=windowY+125+25,windowText.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(windowText),game.ui.showElecInfo.push(windowText),windowText=game.render.text("$"+game.fCashShort(item.data.pay),"med-cash"),windowText.x=windowX+windowW-100,windowText.y=windowY+windowH-80,windowText.anchor.set(.5),windowText.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(windowText),game.ui.showElecInfo.push(windowText),game.ui.furniPriceTemp=windowText,x=windowX+windowW-65,y=windowY+windowH-110,sx=19*game.tileSize,sy=5*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,32,32)),staticImage.furni=item,staticImage.x=x,staticImage.y=y,staticImage.width=32,staticImage.height=32,staticImage.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(staticImage),game.ui.showElecInfo.push(staticImage),staticImage.interactive=!0,game.attachCursorEvents(staticImage),staticImage.on("pointerdown",function(){game.ui.clicked=!0,4.9<this.furni.data.pay?this.furni.data.pay+=1:this.furni.data.pay+=.1,game.ui.furniPriceTemp.text="$"+game.fCashShort(this.furni.data.pay)}),x=windowX+windowW-65,y=windowY+windowH-80,sx=20*game.tileSize,sy=5*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,32,32)),staticImage.furni=item,staticImage.x=x,staticImage.y=y,staticImage.width=32,staticImage.height=32,staticImage.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(staticImage),game.ui.showElecInfo.push(staticImage),staticImage.interactive=!0,game.attachCursorEvents(staticImage),staticImage.on("pointerdown",function(){game.ui.clicked=!0,0<this.furni.data.pay&&(5<this.furni.data.pay?this.furni.data.pay-=1:this.furni.data.pay-=.1,game.ui.furniPriceTemp.text="$"+game.fCashShort(this.furni.data.pay))});game.ui.showElecInfo.push(game.ui.closeButton(windowX+windowW,windowY,function(){game.ui.hideElecFurniInfo()}))}};bootStrap.push(tool);var tool=function(){game.ui.mainMenuContents=[],game.ui.closeMainMenu=function(){for(var i=0;i<game.ui.mainMenuContents.length;i++)game.ui.mainMenuContents[i].destroy(),game.ui.mainMenuContents[i]=void 0;game.ui.mainMenuContents=[]},game.ui.mainMenu=function(text,closeFunctionCallback){game.ui.hideMainUI(),console.debug("NOTIFICATION");var y;if(sx=0,sy=0,windowW=game.ui._MAX_VIEWPORT_WIDTH,windowH=game.ui._MAX_VIEWPORT_HEIGHT,windowX=game.ui._VIEWPORT_RIGHT/2-windowW/2,windowY=game.ui._VIEWPORT_BOTTOM/2-windowH/2,windowYTop=30,x=windowX,y=windowY,0===game.ui.mainMenuContents.length){game.ui.mainMenuContents.push(game.render.window(0,0,game.ui._VIEWPORT_RIGHT,game.ui._VIEWPORT_BOTTOM,16777215,.35)),w=350,h=250,shadow=game.render.window(game.ui._VIEWPORT_RIGHT/2-w/2,game.ui._VIEWPORT_BOTTOM/2-h/2,w,h,0,.5);var blurFilter=new PIXI.filters.BlurFilter;shadow.filters=[blurFilter],shadow.blur=20,game.ui.mainMenuContents.push(shadow),game.ui.mainMenuContents.push(game.render.window(game.ui._VIEWPORT_RIGHT/2-w/2,game.ui._VIEWPORT_BOTTOM/2-h/2,w,h,5618135,1)),this.r=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,1,1)),this.r.width=1,this.r.height=1,this.r.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(this.r),game.ui.mainMenuContents.push(this.r),windowTitleShadow=game.render.text("Arcade Builder","menu-title-red-shadow"),windowTitleShadow.x=windowX+windowW/2-windowTitleShadow.width/2,windowTitleShadow.y=windowY-10,windowTitleShadow.filters=[blurFilter],game.ui.mainMenuContents.push(windowTitleShadow),game.render.baseStage.addChild(windowTitleShadow),windowTitle=game.render.text("Arcade Builder","menu-title-red"),windowTitle.x=windowX+windowW/2-windowTitle.width/2,windowTitle.y=windowY-10,game.ui.mainMenuContents.push(windowTitle),game.render.baseStage.addChild(windowTitle),windowText=game.render.text(_LANG.NEW_GAME,"menu-title"),windowText.x=windowX+windowW/2-windowText.width/2,windowText.y=windowY+180,game.ui.mainMenuContents.push(windowText),game.render.baseStage.addChild(windowText),windowText.interactive=!0,game.attachCursorEvents(windowText),windowText.on("pointerup",function(){null!==localStorage.getItem(game.saveFile)?(game.track.event("New game","Has save"),console.log("Has save")):game.track.event("New game","Has no save"),game.ui.clicked=!0,game.audio.sounds.blonk.playOnce(),game.ui.closeMainMenu(),game.ui.challengeMenu()}),null!==localStorage.getItem(game.saveFile)&&(windowText=game.render.text(_LANG.CONTINUE,"menu-title"),windowText.x=windowX+windowW/2-windowText.width/2,windowText.y=windowY+180+70,game.ui.mainMenuContents.push(windowText),game.render.baseStage.addChild(windowText),windowText.interactive=!0,game.attachCursorEvents(windowText),windowText.on("pointerup",function(){game.track.event("Load game","Loading game"),game.ui.clicked=!0,game.saves.loadGame(),game.audio.sounds.blonk.playOnce(),game.ui.closeMainMenu(),game.started=!0,game.ui.updateAll()})),sx=28*game.tileSize,sy=5*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,32,32)),staticImage.x=game.ui._VIEWPORT_RIGHT-50,staticImage.y=10,staticImage.width=32,staticImage.height=32,staticImage.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(staticImage),game.ui.mainUIComponents.push(staticImage),staticImage.interactive=!0,game.attachCursorEvents(staticImage),staticImage.on("pointerdown",function(){(game.ui.clicked=!0)===game.audio.playing&&(this.visible=!1,game.audio.unMuteButton.visible=!0,game.audio.mute())}),game.ui.mainUIComponents.push(staticImage),game.audio.muteButton=staticImage,sx=29*game.tileSize,sy=5*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,32,32)),staticImage.x=game.ui._VIEWPORT_RIGHT-50,staticImage.y=10,staticImage.width=32,staticImage.height=32,staticImage.visible=!1,staticImage.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(staticImage),game.ui.mainUIComponents.push(staticImage),staticImage.interactive=!0,game.attachCursorEvents(staticImage),staticImage.on("pointerdown",function(){!(game.ui.clicked=!0)===game.audio.playing&&(this.visible=!1,game.audio.muteButton.visible=!0,game.audio.unMute())}),game.ui.mainUIComponents.push(staticImage),game.audio.unMuteButton=staticImage}else this.r.visible=!0}};bootStrap.push(tool);var tool=function(){game.ui.gameMenuContents=[],game.ui.closeGameMenu=function(){for(var i=0;i<game.ui.gameMenuContents.length;i++)game.ui.gameMenuContents[i].destroy(),game.ui.gameMenuContents[i]=void 0;game.ui.gameMenuContents=[]},game.ui.gameMenu=function(){console.debug("NOTIFICATION");sx=512,sy=1344,game.ui.notificationColor="blue";var x=game.ui._VIEWPORT_RIGHT/2-288,y=game.ui._VIEWPORT_BOTTOM/2-224;windowX=x,windowY=y,windowW=576,windowH=448,0===game.ui.gameMenuContents.length?(game.ui.gameMenuContents.push(game.render.window(0,0,game.ui._VIEWPORT_RIGHT,game.ui._VIEWPORT_BOTTOM,0,.8)),this.r=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,576,448)),this.r.width=576,this.r.height=448,this.r.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(this.r),game.ui.gameMenuContents.push(this.r),windowText=game.render.text("Challenges","menu-title"),windowText.x=windowX+windowW/2-windowText.width/2,windowText.y=windowY+70+70,windowText.interactive=!0,windowText.on("pointerup",function(){game.ui.clicked=!0,game.ui.closeGameMenu(),game.ui.changeStage()}),game.ui.gameMenuContents.push(windowText),game.render.baseStage.addChild(windowText),windowText=game.render.text("Close","menu-title"),windowText.x=windowX+windowW/2-windowText.width/2,windowText.y=windowY+140+70,game.ui.gameMenuContents.push(windowText),game.render.baseStage.addChild(windowText),windowText.interactive=!0,windowText.on("pointerup",function(){game.ui.clicked=!0,game.ui.closeGameMenu()})):this.r.visible=!0}};bootStrap.push(tool);var tool=function(){game.ui.challengeMenuContents=[],game.ui.challengePage=1,game.ui.closeChallengeMenu=function(){for(var i=0;i<game.ui.challengeMenuContents.length;i++)game.ui.challengeMenuContents[i].destroy(),game.ui.challengeMenuContents[i]=void 0;game.ui.challengeMenuContents=[]},game.ui.challengeMenu=function(){game.ui.closeUpgradesMenu(),game.ui.hideItemInfo();var y=100,sw=1,sh=1;if(sx=0,sy=0,windowW=game.ui._MAX_VIEWPORT_WIDTH,windowH=game.ui._MAX_VIEWPORT_HEIGHT,windowX=game.ui._VIEWPORT_RIGHT/2-windowW/2,windowY=game.ui._VIEWPORT_BOTTOM/2-windowH/2,windowYTop=30,x=windowX,y=windowY,0===game.ui.challengeMenuContents.length){game.ui.challengeMenuContents.push(game.render.window(0,0,game.ui._VIEWPORT_RIGHT,game.ui._VIEWPORT_BOTTOM,0,.8)),game.ui.challengeMenuContents.push(game.render.window(50,25,game.ui._VIEWPORT_RIGHT-100,game.ui._VIEWPORT_BOTTOM-50,0,.5)),this.r=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,sw,sh)),this.r.width=sw,this.r.height=sh,this.r.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(this.r),game.ui.challengeMenuContents.push(this.r),windowTitle=game.render.text(_LANG.CHALLENGES,"menu-title-red"),windowTitle.x=windowX+windowW/2-windowTitle.width/2,windowTitle.y=windowYTop,game.ui.challengeMenuContents.push(windowTitle),game.render.baseStage.addChild(windowTitle),yOffset=35,windowY=windowYTop+65;var itemsPerPage=Math.floor(game.ui._VIEWPORT_BOTTOM/100),offsetPage=game.ui.challengePage*itemsPerPage,offsetPageStart=game.ui.challengePage*itemsPerPage-itemsPerPage;offsetPage>game.propCount(game.challenges)&&(offsetPage=game.propCount(game.challenges)),1<game.ui.challengePage?alpha=1:alpha=0,sx=20*game.tileSize,sy=6*game.tileSize,y=x=10,upArrow=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,64,64)),upArrow.alpha=alpha,upArrow.width=64,upArrow.height=64,upArrow.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(upArrow),upArrow.x=50,upArrow.y=game.ui._VIEWPORT_BOTTOM-100,upArrow.interactive=!0,game.attachCursorEvents(upArrow),game.ui.challengeMenuContents.push(upArrow),upArrow.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(upArrow),1<game.ui.challengePage&&upArrow.on("pointerdown",function(){game.ui.clicked=!0,game.ui.challengePage--,game.ui.closeChallengeMenu(),game.ui.challengeMenu()}),offsetPageStart+itemsPerPage<game.propCount(game.challenges)?alpha=1:alpha=0,sx=21*game.tileSize,sy=6*game.tileSize,downArrow=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,64,64)),downArrow.alpha=alpha,downArrow.width=64,downArrow.height=64,downArrow.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(downArrow),downArrow.x=game.ui._VIEWPORT_RIGHT-100,downArrow.y=game.ui._VIEWPORT_BOTTOM-100,downArrow.interactive=!0,game.attachCursorEvents(downArrow),game.tools.menuButtons.push(downArrow),downArrow.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(downArrow),offsetPageStart+itemsPerPage<game.propCount(game.challenges)&&downArrow.on("pointerdown",function(){game.ui.clicked=!0,game.ui.challengePage++,game.ui.closeChallengeMenu(),game.ui.challengeMenu()}),x+=15;sw=64,sh=64;offsetPageStart+itemsPerPage<game.propCount(game.challenges)?alpha=1:alpha=0,lHandSide=100;for(var i=offsetPageStart;i<offsetPage;i++)level=Object.keys(game.challenges)[i],challenge=game.challenges[level],windowText=game.render.text(challenge.name,"standard-title"),windowText.x=lHandSide,windowText.y=windowY+yOffset,game.ui.challengeMenuContents.push(windowText),game.render.baseStage.addChild(windowText),windowText=game.render.text(challenge.description,"standard"),windowText.x=lHandSide,windowText.y=windowY+yOffset+20,game.ui.challengeMenuContents.push(windowText),game.render.baseStage.addChild(windowText),!0===game.settings.locked[level]?(sx=30*game.tileSize,sy=5*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,45,45)),staticImage.x=game.ui._VIEWPORT_RIGHT-170,staticImage.y=windowY+yOffset+5,staticImage.width=45,staticImage.height=45,staticImage.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(staticImage),game.ui.challengeMenuContents.push(staticImage),windowText=game.render.text(_LANG.HOW_TO_UNLOCK+challenge.requires,"standard"),windowText.x=lHandSide,windowText.y=windowY+yOffset+35,game.ui.challengeMenuContents.push(windowText),game.render.baseStage.addChild(windowText)):(startLevel=function(level){game.ui.clicked=!0,game.ui.closeChallengeMenu(),game.saves.unload(function(){game.pickLevel(level)})},goButton=game.ui.greenButton(_LANG.START,game.ui._VIEWPORT_RIGHT-(100+lHandSide),windowY+yOffset+5,startLevel,level),game.ui.challengeMenuContents.push(goButton[0]),game.ui.challengeMenuContents.push(goButton[1])),yOffset+=65}else this.r.visible=!0}};bootStrap.push(tool);var tool=function(){game.ui.missionsMenuContents=[],game.ui.closeMissionsMenu=function(){for(var i=0;i<game.ui.missionsMenuContents.length;i++)game.ui.missionsMenuContents[i].destroy(),game.ui.missionsMenuContents[i]=void 0;game.ui.missionsMenuContents=[]},game.ui.missionsMenu=function(){console.debug("NOTIFICATION"),game.ui.closeUpgradesMenu(),game.ui.hideItemInfo();var y;if(sx=0,sy=0,windowW=game.ui._MAX_VIEWPORT_WIDTH,windowH=game.ui._MAX_VIEWPORT_HEIGHT,windowYTop=50,windowX=game.ui._VIEWPORT_RIGHT/2-windowW/2,windowY=game.ui._VIEWPORT_BOTTOM/2-windowH/2,x=windowX,y=windowX,0===game.ui.missionsMenuContents.length){for(var m in game.ui.missionsMenuContents.push(game.render.window(0,0,game.ui._VIEWPORT_RIGHT,game.ui._VIEWPORT_BOTTOM,0,.7)),game.ui.missionsMenuContents.push(game.render.window(25,25,game.ui._VIEWPORT_RIGHT-50,game.ui._VIEWPORT_BOTTOM-50,0,.5)),this.r=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,1,1)),this.r.width=1,this.r.height=1,this.r.displayGroup=game.render.uiLayer,game.render.baseStage.addChild(this.r),game.ui.missionsMenuContents.push(this.r),windowTitle=game.render.text(_LANG.MISSIONS,"menu-title-red"),windowTitle.x=windowX+windowW/2-windowTitle.width/2,windowTitle.y=windowYTop,game.ui.missionsMenuContents.push(windowTitle),game.render.baseStage.addChild(windowTitle),yOffset=130,limit=5,game.missions.length<limit&&(limit=game.missions.length),checkComplete=function(mission){game.ui.clicked=!0,console.debug("checking: "+mission.name),isComplete=game.checkMissionComplete(mission.name),game.ui.closeMissionsMenu(),game.ui.missionsMenu(),!1===isComplete?game.ui.notification(_LANG.MISSION_INCOMPLETE):(console.debug(mission),game.ui.earntCash("",mission.payout),game.gain(mission.payout),0===game.propCount(game.missions)&&game.ui.winStage(_LANG.WINTUT))},limit=5,counter=0,game.missions)if(game.ui.missionsMenuContents.push(game.render.window(90,windowYTop+yOffset,game.ui._VIEWPORT_RIGHT-200,80,0,.5)),mission=game.missions[m],windowText=game.render.text(mission.description,"longerwhitedesc"),windowText.x=100,windowText.y=windowYTop+yOffset+5,windowText.textWidth=10,game.ui.missionsMenuContents.push(windowText),game.render.baseStage.addChild(windowText),goButton=game.ui.greenButton(_LANG.COMPLETE,game.ui._VIEWPORT_RIGHT-240,windowYTop+yOffset+25,checkComplete,mission),game.ui.missionsMenuContents.push(goButton[0]),game.ui.missionsMenuContents.push(goButton[1]),yOffset+=85,counter++,counter===limit)break;closeFunction=function(){game.ui.clicked=!0,game.ui.closeMissionsMenu(),game.tut(12)},game.ui.missionsMenuContents.push(game.ui.closeButton(game.ui._VIEWPORT_RIGHT-70,30,closeFunction))}else this.r.visible=!0}};bootStrap.push(tool);var tool=function(){game.ui.tutorialContents=[],game.ui.closeTutorial=function(){for(var b=0;b<game.ui.tutorialContents.length;b++)if(void 0!==game.ui.tutorialContents[b]&&null!==game.ui.tutorialContents[b]&&void 0!==game.ui.tutorialContents[b].destroy){try{game.ui.tutorialContents[b].destroy()}catch(e){game.ui.tutorialContents[b].visible=!1}game.ui.tutorialContents[b]=void 0}game.ui.tutorialContents=[],void 0!==game.ui.tutArrow&&(game.ui.tutArrow.visible=!1,void 0===game.ui.tutArrow.tweenUp&&(game.ui.tutArrow.tweenUp.stop(),game.ui.tutArrow.tweenDown.stop()))},game.ui.showTutorial=function(message,x,y,arrowX,arrowY,arrowRotate,objectLayerArrow){game.ui.closeTutorial(),game.ui.hideItemInfo();var sx=0,sy=1536;game.ui.notificationColor="red",void 0===x&&(x=game.ui._VIEWPORT_RIGHT/2-224),void 0===y&&(y=game.ui._VIEWPORT_BOTTOM/2-96),void 0===arrowX&&(arrowX=10),void 0===arrowY&&(arrowY=10),void 0===arrowRotate&&(arrowRotate=0),windowX=x,windowY=y,0===game.ui.tutorialContents.length?(this.r=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,448,192)),this.r.width=448,this.r.height=192,this.r.displayGroup=game.render.uiLayer,game.render.aboveAll.addChild(this.r),game.ui.tutorialContents.push(this.r),upgradeName=game.render.text(message,"helptext"),upgradeName.x=x+150,upgradeName.y=y+60,game.ui.tutorialContents.push(upgradeName),game.render.aboveAll.addChild(upgradeName),sx=23*game.tileSize,sy=4*game.tileSize,staticImage=new WorldObject(x,y,game.render.newTexture(game.render.tilesets.gui,sx,sy,64,64)),staticImage.x=arrowX,staticImage.y=arrowY,staticImage.width=64,staticImage.anchor.set(.5),staticImage.height=64,!0===objectLayerArrow?game.render.objectLayer.addChild(staticImage):(staticImage.displayGroup=game.render.uiLayer,game.render.aboveAll.addChild(staticImage)),game.ui.tutArrow=staticImage,game.ui.tutArrow.rotation=arrowRotate*(Math.PI/180),staticImage.readName=_LANG.MISSIONS,arrow=game.ui.tutArrow,void 0===arrow.tweenUp&&(arrow.tweenUp=new TWEEN.Tween(arrow).to({x:"+25"},1e3),arrow.tweenUp.easing(TWEEN.Easing.Quadratic.InOut),arrow.tweenDown=new TWEEN.Tween(arrow).to({x:"-25"},1e3),arrow.tweenDown.easing(TWEEN.Easing.Quadratic.InOut),arrow.tweenUp.chain(arrow.tweenDown),arrow.tweenDown.chain(arrow.tweenUp),arrow.tweenUp.start())):this.r.visible=!0}};bootStrap.push(tool);var ui=function(){};bootStrap.push(ui);var tool=function(){game.ui.availablePatientsMenuContents=[],game.ui.activePatientID=0,game.ui.activeAvailablePatient=!1,game.ui.lookingAtJobs="manager",game.ui.closeAvailablePatientsMenu=function(){!1!==game.ui.activeAvailablePatient&&(game.ui.activeAvailablePatient.visible=!1);for(var i=0;i<game.ui.availablePatientsMenuContents.length;i++)void 0!==game.ui.availablePatientsMenuContents[i].destroy?(game.ui.availablePatientsMenuContents[i].destroy(),game.ui.availablePatientsMenuContents[i]=void 0):(game.debug("Undefined destroy"),console.log(game.ui.availablePatientsMenuContents[i]));game.ui.availablePatientsMenuContents=[]},game.ui.availablePatientsMenu=function(){game.ui.closeAvailablePatientsMenu(),console.debug("Available patients"),game.ui.closeUpgradesMenu(),game.ui.hideItemInfo();var y=100;sx=0,sy=0,windowW=500,windowH=450,"manager"===game.ui.lookingAtJobs&&game.ui.availablePatientsMenuContents.push(game.render.window(0,0,game.ui._VIEWPORT_RIGHT,game.ui._VIEWPORT_BOTTOM,4950438,1,void 0,game.render.aboveAll)),windowX=game.ui._VIEWPORT_RIGHT/2-windowW/2,windowY=game.ui._VIEWPORT_BOTTOM/2-windowH/2,windowYTop=windowY+50,game.ui.availablePatientsMenuContents.push(game.render.window(windowX,windowY,windowW,windowH,0,.7,void 0,game.render.aboveAll)),game.ui.availablePatientsMenuContents.push(game.render.window(windowX+20,windowY+20,windowW-40,windowH-40,0,.7,void 0,game.render.aboveAll));"manager"!==game.ui.lookingAtJobs&&game.ui.availablePatientsMenuContents.push(game.ui.closeButton(windowX+windowW-25,windowYTop-75,function(){game.ui.closeAvailablePatientsMenu()},game.render.aboveAll)),"manager"!==game.ui.lookingAtJobs&&(clickFunction=function(){game.ui.lookingAtJobs="builder",game.ui.activePatientID=0,game.ui.availablePatientsMenu()},startX=windowX+150,clickData={},builderMenu=game.ui.greenButton("Builder",startX,windowY-35,clickFunction,clickData,game.render.aboveAll),game.ui.availablePatientsMenuContents.push(builderMenu[0]),game.ui.availablePatientsMenuContents.push(builderMenu[1]),clickFunction=function(){game.ui.lookingAtJobs="janitor",game.ui.activePatientID=0,game.ui.availablePatientsMenu()},clickData={},builderMenu=game.ui.greenButton("Janitor",startX+125,windowY-35,clickFunction,clickData,game.render.aboveAll),game.ui.availablePatientsMenuContents.push(builderMenu[0]),game.ui.availablePatientsMenuContents.push(builderMenu[1])),_LANG.PATIENTS="Pick a "+game.ui.lookingAtJobs,windowTitle=game.render.text(_LANG.PATIENTS,"menu-title-red"),windowTitle.x=windowX+40,windowTitle.y=windowYTop,game.ui.availablePatientsMenuContents.push(windowTitle),game.render.aboveAll.addChild(windowTitle),null==game.patients.availablePatients[game.ui.lookingAtJobs]&&(game.patients.availablePatients[game.ui.lookingAtJobs]=[]),void 0===game.patients.availablePatients[game.ui.lookingAtJobs][game.ui.activePatientID]||(showPatient=game.patients.availablePatients[game.ui.lookingAtJobs][game.ui.activePatientID],game.ui.activeAvailablePatient=showPatient,showPatient.visible=!0,showPatient.x=windowX+40,showPatient.y=windowY+50+50+20,game.ui.availablePatientsMenuContents.push(game.render.window(showPatient.x,showPatient.y,64,72,0,.7,void 0,game.render.aboveAll)),game.render.aboveAll.addChild(showPatient),lastX=showPatient.x+72,lastY=showPatient.y,lbl=game.ui.largeLabel(lastX,lastY,showPatient.data.patient.name,showPatient.data.patient.love),lastY+=32,game.render.aboveAll.addChild(lbl),game.ui.availablePatientsMenuContents.push(lbl),lbl=game.ui.labelValue(lastX,lastY,"History",showPatient.data.patient.bio,showPatient.data.patient.love),lastY+=32,game.render.aboveAll.addChild(lbl),game.ui.availablePatientsMenuContents.push(lbl),lbl=game.ui.labelValue(lastX,lastY,"Skill Level",showPatient.data.patient.love),game.render.aboveAll.addChild(lbl),game.ui.availablePatientsMenuContents.push(lbl),lastY+=32,lbl=game.ui.labelValue(lastX,lastY,"Energy Level",showPatient.data.patient.compliance),game.render.aboveAll.addChild(lbl),game.ui.availablePatientsMenuContents.push(lbl),lastY+=32,lbl=game.ui.labelValue(lastX,lastY,"Speed",showPatient.data.patient.creativity),game.render.aboveAll.addChild(lbl),game.ui.availablePatientsMenuContents.push(lbl),lastY+=32,lbl=game.ui.labelValue(lastX,lastY,"Skill",showPatient.data.patient.skill),game.render.aboveAll.addChild(lbl),game.ui.availablePatientsMenuContents.push(lbl),0!==game.ui.activePatientID&&(text="Back",x=lastX-20,y=lastY+100,clickFunction=function(ops){game.ui.activePatientID--,id=ops[0],console.log("Get patient: "+id),game.ui.closeAvailablePatientsMenu(),game.ui.availablePatientsMenu()},clickData=[game.ui.activePatientID],btn=game.ui.greenButton(text,x,y,clickFunction,clickData,game.render.aboveAll),game.ui.availablePatientsMenuContents.push(btn[0]),game.ui.availablePatientsMenuContents.push(btn[1])),text="READY",x=lastX+100,y=lastY+100,clickFunction=function(ops){id=ops[0],console.log("Get patient: "+id),game.patients.addPatientToWorld(game.ui.lookingAtJobs,game.ui.activePatientID),"manager"===game.ui.lookingAtJobs&&(game.ui.lookingAtJobs="builder"),game.ui.activePatientID=0,game.ui.clicked=!0,game.ui.closeAvailablePatientsMenu()},clickData=[game.ui.activePatientID],btn=game.ui.greenButton(text,x,y,clickFunction,clickData,game.render.aboveAll),game.ui.availablePatientsMenuContents.push(btn[0]),game.ui.availablePatientsMenuContents.push(btn[1]),game.ui.activePatientID!==game.patients.availablePatients[game.ui.lookingAtJobs].length-1&&(text="Next",x=lastX+200+20,y=lastY+100,clickFunction=function(ops){game.ui.activePatientID++,id=ops[0],console.log("Get patient: "+id),game.ui.closeAvailablePatientsMenu(),game.ui.availablePatientsMenu()},clickData=[game.ui.activePatientID],btn=game.ui.greenButton(text,x,y,clickFunction,clickData,game.render.aboveAll),game.ui.availablePatientsMenuContents.push(btn[0]),game.ui.availablePatientsMenuContents.push(btn[1])))}};bootStrap.push(tool);var tool=function(){game.ui.pawnMenuContents=[],game.ui.currentPatientID=0,game.ui.currentPatient=!1,game.ui.closePawnMenu=function(){!1!==game.ui.currentPatient&&(game.ui.currentPatient.visible=!1);for(var i=0;i<game.ui.pawnMenuContents.length;i++)void 0!==game.ui.pawnMenuContents[i].destroy?(game.ui.pawnMenuContents[i].destroy(),game.ui.pawnMenuContents[i]=void 0):(game.debug("Undefined destroy"),console.log(game.ui.pawnMenuContents[i]));!1!==game.ui.currentPatient&&void 0!==game.ui.currentPatient&&void 0!==game.ui.currentPatient.destroy&&game.ui.currentPatient.destroy(),game.ui.pawnMenuContents=[]},game.ui.pawnMenu=function(){game.ui.closePawnMenu(),console.debug("Available patients"),game.ui.closeUpgradesMenu(),game.ui.hideItemInfo();var y=100;sx=0,sy=0,windowW=700,windowH=550,windowX=game.ui._VIEWPORT_RIGHT/2-windowW/2,windowY=game.ui._VIEWPORT_BOTTOM/2-windowH/2,windowYTop=windowY+50,game.ui.pawnMenuContents.push(game.render.window(windowX,windowY,windowW,windowH,0,.7)),game.ui.pawnMenuContents.push(game.render.window(windowX+20,windowY+20,windowW-40,windowH-40,0,.7)),_LANG.PATIENTS="Residents",windowTitle=game.render.text(_LANG.PATIENTS,"menu-title-red"),windowTitle.x=windowX+40,windowTitle.y=windowYTop,game.ui.pawnMenuContents.push(windowTitle),game.render.baseStage.addChild(windowTitle),closeFunction=function(){game.ui.clicked=!0,game.ui.closePawnMenu()},game.ui.pawnMenuContents.push(game.ui.closeButton(windowX+windowW-40,windowY,closeFunction)),0===game.ai.life.length?(lbl=game.ui.largeLabel(windowX+40,windowY+140,"No patients, please check your referrals"),game.render.baseStage.addChild(lbl),game.ui.pawnMenuContents.push(lbl)):(showPatient=game.ai.life[game.ui.currentPatientID],game.ui.activeAvailablePatient=showPatient,showPatient=game.ai.createLifePhoto(showPatient.data.across,showPatient.data.down,showPatient.data.female,showPatient.data.body.hat,showPatient.data.body.head),game.ui.currentPatient=showPatient,showPatient.visible=!0,showPatient.x=windowX+40,showPatient.y=windowY+50+50+20,game.ui.pawnMenuContents.push(game.render.window(showPatient.x,showPatient.y,64,72,0,.7)),game.render.baseStage.addChild(showPatient),lastX=showPatient.x+72,lastY=showPatient.y,lbl=game.ui.labelValue(lastX,lastY,"Name",game.ui.activeAvailablePatient.data.patient.name),lastY+=32,game.render.baseStage.addChild(lbl),game.ui.pawnMenuContents.push(lbl),lbl=game.ui.labelValue(lastX,lastY,"History",game.ui.activeAvailablePatient.data.patient.bio),lastY+=32,game.render.baseStage.addChild(lbl),game.ui.pawnMenuContents.push(lbl),lbl=game.ui.labelValue(lastX,lastY,"Emotional Level",game.ui.activeAvailablePatient.data.patient.love),game.render.baseStage.addChild(lbl),game.ui.pawnMenuContents.push(lbl),lastY+=32,lbl=game.ui.labelValue(lastX,lastY,"Compliace Level",game.ui.activeAvailablePatient.data.patient.compliance),game.render.baseStage.addChild(lbl),game.ui.pawnMenuContents.push(lbl),lastY+=32,lbl=game.ui.labelValue(lastX,lastY,"Creativity Level",game.ui.activeAvailablePatient.data.patient.creativity),game.render.baseStage.addChild(lbl),game.ui.pawnMenuContents.push(lbl),0!==game.ui.currentPatientID&&(text="Back",x=windowX+40,y=windowY+windowH-80,clickFunction=function(ops){game.ui.currentPatientID--,id=ops[0],console.log("Get patient: "+id),game.ui.closePawnMenu(),game.ui.pawnMenu()},clickData=[game.ui.activePatientID],btn=game.ui.greenButton(text,x,y,clickFunction,clickData),game.ui.pawnMenuContents.push(btn[0]),game.ui.pawnMenuContents.push(btn[1])),game.ui.currentPatientID!==game.ai.life.length-1&&(text="Next",x=windowX+windowW-140,y=windowY+windowH-80,clickFunction=function(ops){game.ui.currentPatientID++,id=ops[0],console.log("Get patient: "+id),game.ui.closePawnMenu(),game.ui.pawnMenu()},clickData=[game.ui.activePatientID],btn=game.ui.greenButton(text,x,y,clickFunction,clickData),game.ui.pawnMenuContents.push(btn[0]),game.ui.pawnMenuContents.push(btn[1])))}};bootStrap.push(tool);bootStrap.push(function(){game.ui.htmlPawn=!1,game.ui.htmlPawnInfo=function(pawn){game.ui.htmlPawn=pawn,$("#pawn-info").show()},$(".hide-parent").click(function(){$(this).parent().hide(),game.ui.htmlPawn=!1}),game.ui.htmlPawnRefresh=0,game.ui.htmlPawnJobs=function(){if(game.ui.htmlPawnRefresh<100)return game.ui.htmlPawnRefresh++,!1;if((game.ui.htmlPawnRefresh=0)==game.ui.htmlPawn)return!1;var pawn=game.ui.htmlPawn;if($("#pawn-jobs").empty(),$("#pawn-jobs").append("<br />Status:"+pawn.status),$("#pawn-jobs").append("<br />Job Count:"+pawn.jobs.length),$("#pawn-jobs").append("<br />Phase Attempts:"+pawn.phaseAttempts),0<pawn.jobs.length){var distance=game.world.distance(pawn.x,pawn.y,pawn.jobs[0].x,pawn.jobs[0].y);$("#pawn-jobs").append("<br />Distance to job:"+distance)}for(i=0;i<pawn.jobs.length;i++)job=pawn.jobs[i],jobType=job.job,jobName=job.name,jobString=job.job+" "+job.name,$("#pawn-jobs").append("<li>"+jobString+"</li>")},game.tickers.push(game.ui.htmlPawnJobs)});bootStrap.push(function(){game.resources=game.globalInventory.items,game.ui.resourceCounters={},game.ee.addListener("game-start",function(){console.log("All resources"),xOffset=game.ui._VIEWPORT_RIGHT-200,yOffset=100,title=game.render.text("Resources","small-text"),title.x=xOffset,title.y=yOffset-25,game.render.aboveAll.addChild(title),game.ui.createResourceText()}),game.ui.createResourceText=function(){for(resource in xOffset=game.ui._VIEWPORT_RIGHT-200,yOffset=100,game.resources)void 0===game.ui.resourceCounters[resource]&&(count=game.resources[resource],title=game.render.text(resource+": "+count,"small-text"),title.x=xOffset,title.y=yOffset,game.render.aboveAll.addChild(title),game.ui.resourceCounters[resource]=title),yOffset},game.tickers.push(function(){for(resource in game.ui.createResourceText(),game.resources)count=game.resources[resource],game.ui.resourceCounters[resource].text=resource+": "+count,yOffset})});bootStrap.push(function(){game.ui.tuts=[],game.ui.tut1Complete=function(){game.settings.locked.upgrades=!1,game.ui.updateAll()},game.ui.tutLevel1=function(){game.tutStep=-1,game.ui.tuts.push(function(){closeTut1=function(){game.ui.clicked=!0,game.nextTutorial()},goButton=game.ui.greenButton(_LANG.OKAY,448,307,closeTut1),game.ui.showTutorial(_LANG.TUT1,100,100,goButton[0].x+120,goButton[0].y+16,0),game.ui.tutorialContents.push(goButton[0]),game.ui.tutorialContents.push(goButton[1]),game.settings.tut1Complete=!0}),game.ui.tuts.push(function(){closeTut1=function(){game.ui.clicked=!0,game.nextTutorial()},goButton=game.ui.greenButton(_LANG.OKAY,448,307,closeTut1),game.ui.showTutorial(_LANG.TUT2,100,100,goButton[0].x+120,goButton[0].y+16,0),game.ui.tutorialContents.push(goButton[0]),game.ui.tutorialContents.push(goButton[1])}),game.ui.tuts.push(function(){game.unlock("machines"),game.unlock("changemachine"),game.ui.showTutorial(_LANG.TUT3,320,game.ui._VIEWPORT_BOTTOM-270,300,game.ui._VIEWPORT_BOTTOM-50,0)}),game.ui.tuts.push(function(){game.ui.showTutorial(_LANG.TUT4,500,game.ui._VIEWPORT_BOTTOM-320,200,game.ui._VIEWPORT_BOTTOM-130,0)}),game.ui.tuts.push(function(){game.unlock("sunwars"),game.ui.showTutorial(_LANG.TUT5,100,100,-100,-100,0)}),game.ui.tuts.push(function(){closeTut1=function(){game.ui.clicked=!0,game.nextTutorial()},goButton=game.ui.greenButton(_LANG.OKAY,448,307,closeTut1),game.ui.showTutorial(_LANG.TUT6,100,100,goButton[0].x+120,goButton[0].y+16,0),game.ui.tutorialContents.push(goButton[0]),game.ui.tutorialContents.push(goButton[1])}),game.ui.tuts.push(function(){game.ui.showTutorial(_LANG.TUT7,320,game.ui._VIEWPORT_BOTTOM-270,300,game.ui._VIEWPORT_BOTTOM-50,0)}),game.ui.tuts.push(function(){game.cash=200,game.ui.showTutorial(_LANG.TUT8,500,game.ui._VIEWPORT_BOTTOM-320,264,game.ui._VIEWPORT_BOTTOM-130,0)}),game.ui.tuts.push(function(){game.ui.showTutorial(_LANG.TUT9,100,100,-100,-100,0)}),game.ui.tuts.push(function(){closeTut1=function(){game.ui.clicked=!0,game.nextTutorial()},goButton=game.ui.greenButton(_LANG.OKAY,448,307,closeTut1),game.ui.showTutorial(_LANG.TUT10,100,100,goButton[0].x+120,goButton[0].y+16,0),game.ui.tutorialContents.push(goButton[0]),game.ui.tutorialContents.push(goButton[1])}),game.ui.tuts.push(function(){game.settings.locked.missions=!1,game.ui.updateAll(),game.ui.showTutorial(_LANG.TUT11,100,100,70,300,0)}),game.ui.tuts.push(function(){game.ui.showTutorial(_LANG.TUT12,game.ui._VIEWPORT_RIGHT-448,1,game.ui._VIEWPORT_RIGHT-290,220,180)}),game.ui.tuts.push(function(){game.camera.newOffsetX=-50,game.camera.newOffsetY=-50,game.ui.showTutorial(_LANG.TUT13,game.ui._VIEWPORT_RIGHT-576,1,game.ui._VIEWPORT_RIGHT-100,50,180)}),game.ui.tuts.push(function(){sign=game.world.index.openSign[Object.keys(game.world.index.openSign)[0]],game.ui.showTutorial(_LANG.TUT14,100,100,sign.x-32,sign.y+16,180,!0)}),game.ui.tuts.push(function(){game.ui.closeTutorial()}),game.ui.tuts.push(function(){closeTut1=function(){game.ui.clicked=!0,game.nextTutorial()},goButton=game.ui.greenButton(_LANG.OKAY,448,307,closeTut1),game.ui.showTutorial(_LANG.TUT16,100,100,goButton[0].x+120,goButton[0].y+16,0),game.ui.tutorialContents.push(goButton[0]),game.ui.tutorialContents.push(goButton[1])}),game.ui.tuts.push(function(){closeTut1=function(){game.ui.clicked=!0,game.nextTutorial()},game.ui.showTutorial(_LANG.TUT17,100,100,70,220,0),game.ui.tutorialContents.push(goButton[0]),game.ui.tutorialContents.push(goButton[1]),game.ui.tut1Complete(),game.unlock("floors"),game.unlock("walls"),game.unlock("furni"),game.unlock("staff"),game.unlock("tables")})}});var checker=function(){game.jobs.jobCheckers.push(function(checking){if(!0===checking.data.buildWall)return game.world.addToIndex("build",checking),checking.jobCount++,checking.jobLevel=0,checking.job="build-wall",checking.workerRole="builder",checking.assigned=!1,checking.phase=0,checking.failed=!1,checking.failedCount=0,checking.timeSincePhaseBegan=0,checking.executeJob=function(worker){var continueExec=worker.checkPhases();if(!1===continueExec)return!1;"calc"==worker.status&&(continueExec=!1),0===worker.jobs[0].phase&&!0===continueExec&&worker.phaseWalk(worker.jobs[0]),1===worker.jobs[0].phase&&!0===continueExec&&(build=worker.newPhaseArrived(worker.jobs[0],128),build&&(worker.path.length=0,"hammer"!=worker.anim&&0===worker.path.length&&(worker.anim="hammer",worker.animLength=1.5,worker.animComplete=function(){game.grid.updateTile(game.gridPos(this.jobs[0].x),game.gridPos(this.jobs[0].y)),this.jobs[0].data.buildWall=!1,game.world.removeFromIndex("build",this.jobs[0],!1),game.world.markRemoveObject(this.jobs[0]),this.shiftJob()}))),this.phase},!0})};bootStrap.push(checker);var checker=function(){game.jobs.jobCheckers.push(function(checking){!0===checking.data.bulldoze&&(checking.jobCount++,checking.jobLevel=0,checking.job="dismantle-furni",checking.workerRole="builder",checking.assigned=!1,checking.phase=0,checking.failed=!1,checking.failedCount=0,checking.timeSincePhaseBegan=0,checking.executeJob=function(worker){var continueExec=worker.checkPhases();if(!1===continueExec)return!1;"calc"==worker.status&&(continueExec=!1),0===worker.jobs[0].phase&&!0===continueExec&&worker.phaseWalk(worker.jobs[0]),1===worker.jobs[0].phase&&!0===continueExec&&(arrived=worker.phaseArrived(worker.jobs[0]),arrived&&(game.grid.floorTile(game.gridPos(worker.jobs[0].x),game.gridPos(worker.jobs[0].y),1,1),worker.jobs[0].data.bulldoze=!1,game.world.markRemoveObject(worker.jobs[0]),worker.shiftJob()))})})};bootStrap.push(checker);var checker=function(){game.jobs.jobCheckers.push(function(checking){if(!0===checking.data.buildFloor)return game.world.addToIndex("build",checking),checking.jobCount++,checking.jobLevel=0,checking.job="build-floor",checking.workerRole="builder",checking.assigned=!1,checking.phase=0,checking.failed=!1,checking.failedCount=0,checking.timeSincePhaseBegan=0,checking.executeJob=function(worker){var continueExec=worker.checkPhases();if(!1===continueExec)return!1;"calc"==worker.status&&(continueExec=!1),0===worker.jobs[0].phase&&!0===continueExec&&worker.phaseWalk(worker.jobs[0]),1===worker.jobs[0].phase&&!0===continueExec&&(build=worker.newPhaseArrived(worker.jobs[0]),build&&"hammer"!=worker.anim&&0===worker.path.length&&(worker.anim="hammer",worker.animLength=.2,worker.animComplete=function(){game.grid.floorTile(game.gridPos(this.jobs[0].x),game.gridPos(this.jobs[0].y),this.jobs[0].data.across,this.jobs[0].data.down),this.jobs[0].data.buildFloor=!1,game.world.removeFromIndex("build",this.jobs[0],!1),game.world.markRemoveObject(this.jobs[0]),this.shiftJob()})),this.phase},!0})};bootStrap.push(checker);var checker=function(){game.jobs.jobCheckers.push(function(checking){if(!0===checking.data.buildFurni)return game.world.addToIndex("build",checking),checking.jobCount++,checking.jobLevel=0,checking.job="build-furni",checking.workerRole="builder",checking.assigned=!1,checking.phase=0,checking.failed=!1,checking.failedCount=0,checking.timeSincePhaseBegan=0,checking.executeJob=function(worker){var continueExec=worker.checkPhases();if(!1===continueExec)return!1;"calc"==worker.status&&(continueExec=!1),0===worker.jobs[0].phase&&!0===continueExec&&worker.phaseWalk(worker.jobs[0]),1===worker.jobs[0].phase&&!0===continueExec&&(build=worker.phaseArrived(worker.jobs[0]),build&&"hammer"!=worker.anim&&0===worker.path.length&&(worker.anim="hammer",worker.animLength=3,worker.animComplete=function(){try{console.debug(this),this.jobs[0].built=!0,this.jobs[0].alpha=1,this.jobs[0].assigned=!1,this.jobs[0].data.buildFurni=!1,game.tut(worker.jobs[0].data.tutNumber)&&game.render.redraw(),void 0!==game.onBuildFunctions[this.jobs[0].data.buildFunction]&&(console.log("Run build functions"),game.onBuildFunctions[this.jobs[0].data.buildFunction](this.jobs[0])),!0===this.jobs[0].killOnBuild&&game.world.markRemoveObject(worker.jobs[0]),game.world.removeFromIndex("build",worker.jobs[0],!1),console.debug(this.jobs[0]),this.shiftJob()}catch(e){console.log(e)}}))},!0})};bootStrap.push(checker);var checker=function(){game.jobs.jobCheckers.push(function(checking){!0===checking.data.buildDoor&&(checking.jobCount++,checking.jobLevel=0,checking.job="build-door",checking.workerRole="builder",checking.assigned=!1,checking.phase=0,checking.failed=!1,checking.failedCount=0,checking.timeSincePhaseBegan=0,checking.executeJob=function(worker){var continueExec=worker.checkPhases();if(!1===continueExec)return!1;"calc"==worker.status&&(continueExec=!1),0===worker.jobs[0].phase&&!0===continueExec&&worker.phaseWalk(worker.jobs[0]),1===worker.jobs[0].phase&&!0===continueExec&&(build=worker.phaseArrived(worker.jobs[0]),build&&"hammer"!=worker.anim&&0===worker.path.length&&(worker.anim="hammer",worker.animLength=.2,worker.animComplete=function(){this.jobs[0].phase=2,console.debug(this.jobs[0].phase)})),2===worker.jobs[0].phase&&!0===continueExec&&(worker.jobs[0].built=!0,worker.jobs[0].alpha=1,game.grid.removeWall(game.gridPos(worker.jobs[0].x+2),game.gridPos(worker.jobs[0].y+2)),game.ai.updateOppositeGrid(game.gridPos(worker.jobs[0].x+2),game.gridPos(worker.jobs[0].y+2),!0),!(worker.jobs[0].data.buildDoor=!1)===worker.jobs[0].data.killOnBuild&&game.world.markRemoveObject(worker.jobs[0]),void 0!==worker.jobs[0].data.buildTicker&&(worker.jobs[0].tick=worker.jobs[0].data.buildTicker),worker.shiftJob())})})};bootStrap.push(checker);var checker=function(){game.jobs.jobCheckers.push(function(checking){!0===checking.data.dismantle&&(checking.jobCount++,checking.jobLevel=0,checking.job="dismantle-furni",checking.workerRole="builder",checking.assigned=!1,checking.phase=0,checking.failed=!1,checking.failedCount=0,checking.timeSincePhaseBegan=0,checking.executeJob=function(worker){return worker.jobs[0].data.dismantle=!1,game.world.markRemoveObject(worker.jobs[0]),worker.shiftJob(),!1})})};bootStrap.push(checker);var checker=function(){game.jobs.jobCheckers.push(function(checking){"cleaner"===checking.data.job&&(checking.jobCount++,checking.jobLevel=0,checking.job="cleaner",checking.workerRole="janitor",checking.assigned=!1,checking.phase=0,checking.failed=!1,checking.failedCount=0,checking.timeSincePhaseBegan=0,checking.executeJob=function(worker){var continueExec=worker.checkPhases();if(!1===continueExec)return!1;"calc"==worker.status&&(continueExec=!1),0===worker.jobs[0].phase&&!0===continueExec&&worker.phaseWalk(worker.jobs[0]),1===worker.jobs[0].phase&&!0===continueExec&&(arrived=worker.phaseArrived(worker.jobs[0]),arrived&&"sweep"!=worker.anim&&0===worker.path.length&&(worker.anim="sweep",worker.animLength=3,worker.animComplete=function(){try{this.jobs[0].phase=2}catch(e){game.debug("Error in anim sweep: "+e)}})),2===worker.jobs[0].phase&&!0===continueExec&&(game.globalInventory.addItem(worker.jobs[0].name,worker.jobs[0].data.amount),worker.jobs[0].data.dismantle=!1,worker.jobs[0].data.job="done",game.world.markRemoveObject(worker.jobs[0]),worker.shiftJob("cleanup success"))})})};bootStrap.push(checker);var checker=function(){game.jobs.jobCheckers.push(function(checking){"miner"===checking.data.job&&(checking.jobCount++,checking.jobLevel=0,checking.job="mine",checking.workerRole="miner",checking.assigned=!1,checking.phase=0,checking.failed=!1,checking.failedCount=0,checking.timeSincePhaseBegan=0,checking.executeJob=function(worker){var continueExec=worker.checkPhases();if(game.llog("jobs","Execute mining job, Phase "+worker.jobs[0].phase+" Continue exec: "+continueExec),!1===continueExec)return!1;"calc"==worker.status&&(continueExec=!1),0===worker.jobs[0].phase&&!0===continueExec&&worker.phaseWalk(worker.jobs[0]),1===worker.jobs[0].phase&&!0===continueExec&&(build=worker.phaseArrived(worker.jobs[0],130),build&&"hammer"!=worker.anim&&0===worker.path.length&&(worker.anim="hammer",worker.animLength=5,worker.animComplete=function(){try{console.log("Set phase"),this.jobs[0].phase=2}catch(e){game.debug("Error in anim mine: "+e)}})),2===worker.jobs[0].phase&&!0===continueExec&&(game.grid.floorTile(game.gridPos(worker.jobs[0].x),game.gridPos(worker.jobs[0].y),1,1),worker.jobs[0].data.job=!1,game.world.markRemoveObject(worker.jobs[0]),trash={x:worker.jobs[0].x,y:worker.jobs[0].y,height:64,width:64,framex:1920,framey:320,tileSetName:"/png/furni.png",built:!0,id:"rb",data:{amount:100,ref:"00",job:"cleaner"},name:"stone",alpha:1},game.world.furniFromObject(trash),worker.shiftJob("mine success"))})})};bootStrap.push(checker);var checker=function(){game.ai.taskCheckers.push(function(checking){!0===checking.data.customer&&"gohome"!=checking.data.need&&(checking.jobCount++,checking.jobLevel=0,checking.task="randomtask",checking.phase=0,checking.failed=!1,checking.hasTask=!0,checking.failedCount=0,checking.timeSincePhaseBegan=0,checking.executeTask=function(){var continueExec=this.checkPhases();if(!1===(this.continueExec=continueExec))return!1;if("calc"==this.status&&(continueExec=!1),0===this.phase&&!0===continueExec)if(void 0===game.world.index[checking.data.need])console.debug("No "+checking.data.need),this.data.happiness--,this.phase=10,checking.hasTask=!1,this.data.lastThought="No "+checking.data.need,game.gameLog("A customer can't find an available "+checking.data.need,"red"),anim="no"+checking.data.need,void 0!==game.ai.anims[anim]&&(this.phase=0,this.anim=anim,this.animLength=2,this.animComplete=function(){game.ai.calcNeeds(this)});else for(var item in game.world.index[checking.data.need])if(!0===(item=game.world.index[checking.data.need][item]).built){if(void 0!==item.takenTime)if(item.takenTime>Math.floor(Date.now()/1e3)-30){if(!0===item.taken&&!1!==item.data.canBeTaken){if(void 0===this.gotoObj)continue;if(this.gotoObj.id!==item.id)continue}}else console.log("Releasing "+item.name);this.gotoObj=item,console.log("Set "+this.gotoObj.id+" to taken"),this.gotoObj.taken=!0,this.gotoObj.takenTime=Math.floor(Date.now()/1e3),(stand=void 0)!==this.gotoObj.data.standArea&&(stand=1),void 0!==this.gotoObj.data.standArea2&&(stand=2),void 0!==this.gotoObj.data.standArea3&&(stand=3),void 0!==this.gotoObj.data.standArea4&&(stand=4),console.log("Phase walk to "+this.gotoObj.name),this.phaseWalk(this.gotoObj,!0,stand),640<this.x&&640<this.y&&(void 0===game.trashAt&&(game.trashAt={}),trashRef=Math.round(this.x)+"-"+Math.round(this.y),!0!==game.trashAt[trashRef]&&(game.trashAt[trashRef]=!0,3===game.rand(0,25)&&(trash={x:this.x,y:this.y,height:64,width:64,framex:1920,framey:256,tileSetName:"png/furni.png",built:!0,id:"rb",data:{ref:trashRef,buildFloor:!1,cleanup:!0},name:"trash",alpha:1},game.world.furniFromObject(trash)),5===game.rand(0,25)&&(trash={x:this.x,y:this.y,height:64,width:64,framex:1856,framey:256,tileSetName:"png/furni.png",built:!0,id:"rb",data:{ref:trashRef,buildFloor:!1,cleanup:!0},name:"trash",alpha:1},game.world.furniFromObject(trash)),3===game.rand(0,25)&&(trash={x:this.x,y:this.y,height:64,width:64,framex:1984,framey:256,tileSetName:"png/furni.png",built:!0,id:"rb",data:{ref:trashRef,buildFloor:!1,cleanup:!0},name:"trash",alpha:1},game.world.furniFromObject(trash))));break}1===this.phase&&!0===continueExec&&(arrived=this.newPhaseArrived(this.gotoObj,256),arrived&&(!1!==this.anim&&void 0!==this.anim||0!==this.path.length||(game.ai.runInteractions(this,this.gotoObj),this.faceTowards(this.gotoObj),void 0!==this.gotoObj.data.runAnim?(this.anim=this.gotoObj.data.runAnim,game.debug("New anim: "+this.anim)):void 0!==this.gotoObj.data.anim?this.gotoObj.data.anim:this.anim="noanim",this.animLength=5,this.animComplete=function(){game.ai.runPostInteractions(this,this.gotoObj),this.gotoObj.taken=!1,this.gotoObj=void 0,this.status="wait",this.hasTask=!1,this.executeTask=!1}))),1<this.phase&&!0===continueExec&&(!1!==this.anim&&void 0!==this.anim||0!==this.path.length||null!=this.gotoObj&&!0===this.gotoObj.taken&&(this.gotoObj.taken=!1,this.gotoObj=void 0))})})};bootStrap.push(checker);var checker=function(){game.ai.taskCheckers.push(function(checking){!0===checking.data.customer&&"gohome"===checking.data.need&&(checking.jobCount++,checking.jobLevel=0,checking.task="gohome",checking.phase=0,checking.failed=!1,checking.hasTask=!0,checking.failedCount=0,checking.timeSincePhaseBegan=0,checking.executeTask=function(){var continueExec=this.checkPhases();if(!1===continueExec)return!1;"calc"==this.status&&(continueExec=!1),0===this.phase&&!0===continueExec&&this.phaseWalk(game.deSpawn,!0),1===this.phase&&!0===continueExec&&(arrived=this.phaseArrived(game.deSpawn,65),arrived&&"destroy"!==this.status&&(this.status="destroy",this.hasTask=!1,this.anim="noanim",this.goHome=!1,void 0!==this.data.happiness&&void 0===this.data.feedback&&(this.data.feedback=!0,50<=this.data.happiness?(game.gameLog("A customer left happy!","green"),game.settings.happyPeeps+=.1):(game.gameLog("A customer left unhappy!","red"),game.settings.happyPeeps-=.1))))})})};bootStrap.push(checker);var anims=function(){game.ai.anims.noanim=function(life){},game.ai.anims.hammer=function(life){game.audio.sounds.ratchet.isEnded()&&(life.currentAudio=game.audio.sounds.ratchet,life.currentAudio.playOnce()),!1===life.animRender?(tileAcross=30,tileDown=1,sx=(tileAcross-1)*game.tileSize,sy=(tileDown-1)*game.tileSize,life.animRender=new WorldObject(life.x,life.y,game.render.newTexture(game.render.tilesets.skins,sx,sy,64,64)),life.animRender.x=life.x+32,life.animRender.y=life.y+32,life.animRender.anchor.set(.2,.2),game.render.lifeLayer.addChild(life.animRender)):(life.animRender.x=life.x+32,life.animRender.y=life.y+32,life.animRender.rotation=Math.sin(life.animTicker/5)*game.speed*(1-game.delta))},game.ai.anims.sweep=function(life){game.audio.sounds.ratchet.isEnded()&&(life.currentAudio=game.audio.sounds.ratchet,life.currentAudio.playOnce()),!1===life.animRender?(tileAcross=31,tileDown=1,sx=(tileAcross-1)*game.tileSize,sy=(tileDown-1)*game.tileSize,life.animRender=new WorldObject(life.x,life.y,game.render.newTexture(game.render.tilesets.skins,sx,sy,64,64)),life.animRender.x=life.x+32,life.animRender.y=life.y+32,life.animRender.anchor.set(.2,.2),game.render.lifeLayer.addChild(life.animRender)):(life.animRender.x=life.x+32,life.animRender.y=life.y+32,life.animRender.rotation=Math.sin(life.animTicker/5)*game.speed)},game.ai.anims.snack=function(life){!1===life.animRender?(life.face("right"),tileAcross=30,tileDown=5,sx=(tileAcross-1)*game.tileSize,sy=(tileDown-1)*game.tileSize,life.animRender=new WorldObject(life.x,life.y,game.render.newTexture(game.render.tilesets.skins,sx,sy,64,64)),life.animRender.x=life.x,life.animRender.y=life.y,life.animRender.anchor.set(0,0),game.render.lifeLayer.addChild(life.animRender)):(life.animRender.x=life.x+32,life.animRender.y=life.y+32,life.animRender.rotation=Math.cos(life.animTicker/15)*game.speed)},game.ai.anims.drink=function(life){!1===life.animRender?(life.face("right"),tileAcross=30,tileDown=6,sx=(tileAcross-1)*game.tileSize,sy=(tileDown-1)*game.tileSize,life.animRender=new WorldObject(life.x,life.y,game.render.newTexture(game.render.tilesets.skins,sx,sy,64,64)),life.animRender.x=life.x,life.animRender.y=life.y,life.animRender.anchor.set(0,0),game.render.lifeLayer.addChild(life.animRender)):(life.animRender.x=life.x+32,life.animRender.y=life.y+32,life.animRender.rotation=Math.cos(life.animTicker/15)*game.speed)},game.ai.anims.happy=function(life){!1===life.animRender?(tileAcross=30,tileDown=2,sx=(tileAcross-1)*game.tileSize,sy=(tileDown-1)*game.tileSize,life.animRender=new WorldObject(life.x,life.y,game.render.newTexture(game.render.tilesets.skins,sx,sy,64,64)),life.animRender.anchor.set(.5,.5),game.render.lifeLayer.addChild(life.animRender)):(life.animRender.x=life.x+32,life.animRender.y=life.y-16,maxScale=50,0===life.animFrame&&(life.animFrame=100),2===game.rand(0,25)&&(life.animRender.visible=!0),2===game.rand(0,50)&&(life.animRender.visible=!1))},game.ai.anims.angry=function(life){!1===life.animRender?(tileAcross=6,tileDown=24,sx=(tileAcross-1)*game.tileSize,sy=(tileDown-1)*game.tileSize,life.animRender=new WorldObject(life.x,life.y,game.render.newTexture(game.render.tilesets.skins,sx,sy,64,64)),life.animRender.anchor.set(.5,.5),game.render.lifeLayer.addChild(life.animRender)):(life.animRender.x=life.x+32,life.animRender.y=life.y-16,maxScale=50,0===life.animFrame&&(life.animFrame=100),2===game.rand(0,25)&&(life.animRender.visible=!0),2===game.rand(0,50)&&(life.animRender.visible=!1))},game.ai.anims.badprice=function(life){!1===life.animRender?(tileAcross=31,tileDown=7,sx=(tileAcross-1)*game.tileSize,sy=(tileDown-1)*game.tileSize,life.animRender=new WorldObject(life.x,life.y,game.render.newTexture(game.render.tilesets.skins,sx,sy,64,64)),life.animRender.anchor.set(.5,.5),game.render.lifeLayer.addChild(life.animRender)):(life.animRender.x=life.x+32,life.animRender.y=life.y-16,maxScale=50,0===life.animFrame&&(life.animFrame=100),2===game.rand(0,25)&&(life.animRender.visible=!0),2===game.rand(0,50)&&(life.animRender.visible=!1))},game.ai.anims.nofood=function(life){!1===life.animRender?(tileAcross=32,tileDown=7,sx=(tileAcross-1)*game.tileSize,sy=(tileDown-1)*game.tileSize,life.animRender=new WorldObject(life.x,life.y,game.render.newTexture(game.render.tilesets.skins,sx,sy,64,64)),life.animRender.anchor.set(.5,.5),game.render.lifeLayer.addChild(life.animRender)):(life.animRender.x=life.x+32,life.animRender.y=life.y-16,maxScale=50,0===life.animFrame&&(life.animFrame=100),2===game.rand(0,25)&&(life.animRender.visible=!0),2===game.rand(0,50)&&(life.animRender.visible=!1))},game.ai.anims.notoilet=function(life){!1===life.animRender?(tileAcross=33,tileDown=7,sx=(tileAcross-1)*game.tileSize,sy=(tileDown-1)*game.tileSize,life.animRender=new WorldObject(life.x,life.y,game.render.newTexture(game.render.tilesets.skins,sx,sy,64,64)),life.animRender.anchor.set(.5,.5),game.render.lifeLayer.addChild(life.animRender)):(life.animRender.x=life.x+32,life.animRender.y=life.y-16,maxScale=50,0===life.animFrame&&(life.animFrame=100),2===game.rand(0,25)&&(life.animRender.visible=!0),2===game.rand(0,50)&&(life.animRender.visible=!1))},game.ai.anims.noseat=function(life){!1===life.animRender?(tileAcross=33,tileDown=8,sx=(tileAcross-1)*game.tileSize,sy=(tileDown-1)*game.tileSize,life.animRender=new WorldObject(life.x,life.y,game.render.newTexture(game.render.tilesets.skins,sx,sy,64,64)),life.animRender.anchor.set(.5,.5),game.render.lifeLayer.addChild(life.animRender)):(life.animRender.x=life.x+32,life.animRender.y=life.y-16,maxScale=50,0===life.animFrame&&(life.animFrame=100),2===game.rand(0,25)&&(life.animRender.visible=!0),2===game.rand(0,50)&&(life.animRender.visible=!1))},game.ai.anims.nopinball=function(life){!1===life.animRender?(tileAcross=32,tileDown=8,sx=(tileAcross-1)*game.tileSize,sy=(tileDown-1)*game.tileSize,life.animRender=new WorldObject(life.x,life.y,game.render.newTexture(game.render.tilesets.skins,sx,sy,64,64)),life.animRender.anchor.set(.5,.5),game.render.lifeLayer.addChild(life.animRender)):(life.animRender.x=life.x+32,life.animRender.y=life.y-16,maxScale=50,0===life.animFrame&&(life.animFrame=100),2===game.rand(0,25)&&(life.animRender.visible=!0),2===game.rand(0,50)&&(life.animRender.visible=!1))},game.ai.anims.noarcade=function(life){!1===life.animRender?(tileAcross=32,tileDown=8,sx=(tileAcross-1)*game.tileSize,sy=(tileDown-1)*game.tileSize,life.animRender=new WorldObject(life.x,life.y,game.render.newTexture(game.render.tilesets.skins,sx,sy,64,64)),life.animRender.anchor.set(.5,.5),game.render.lifeLayer.addChild(life.animRender)):(life.animRender.x=life.x+32,life.animRender.y=life.y-16,maxScale=50,0===life.animFrame&&(life.animFrame=100),2===game.rand(0,25)&&(life.animRender.visible=!0),2===game.rand(0,50)&&(life.animRender.visible=!1))},game.ai.anims.nochange=function(life){!1===life.animRender?(tileAcross=31,tileDown=8,sx=(tileAcross-1)*game.tileSize,sy=(tileDown-1)*game.tileSize,life.animRender=new WorldObject(life.x,life.y,game.render.newTexture(game.render.tilesets.skins,sx,sy,64,64)),life.animRender.anchor.set(.5,.5),game.render.lifeLayer.addChild(life.animRender)):(life.animRender.x=life.x+32,life.animRender.y=life.y-16,maxScale=50,0===life.animFrame&&(life.animFrame=100),2===game.rand(0,25)&&(life.animRender.visible=!0),2===game.rand(0,50)&&(life.animRender.visible=!1))}};bootStrap.push(anims);var anims=function(){game.ai.anims.chatter=function(life){!1===life.animRender?(tileAcross=game.rand(30,34),tileDown=4,sx=(tileAcross-1)*game.tileSize,sy=(tileDown-1)*game.tileSize,life.animRender=new WorldObject(life.x,life.y,game.render.newTexture(game.render.tilesets.skins,sx,sy,64,64)),life.animRender.anchor.set(.5,.5),game.render.lifeLayer.addChild(life.animRender)):(life.animRender.x=life.x+64,life.animRender.y=life.y-16,maxScale=50,0===life.animFrame&&(life.animFrame=100),52===game.rand(0,500)&&(life.animRender.visible=!0),86===game.rand(0,500)&&(life.animRender.visible=!1,life.animRender.destroy(),life.animRender=!1))}};bootStrap.push(anims);var anims=function(){var interaction=function(life,object){object.data.runAnim="chatter"};game.ai.addInteraction(["seat"],interaction);interaction=function(life,object){object.data.pay>object.data.maxPay?(life.paying=!1,object.data.runAnim="badprice"):(object.data.runAnim="snack",life.paying=!0)};game.ai.addInteraction(["food"],interaction);interaction=function(life,object){object.data.pay>object.data.maxPay?(life.paying=!1,object.data.runAnim="badprice"):(object.data.runAnim="happy",life.paying=!0)};game.ai.addInteraction(["pinball"],interaction)};bootStrap.push(anims);var anims=function(){game.ai.addPostInteraction(["pinball","arcade","snack"],function(life,object){void 0!==object.data.pay&&!1!==life.paying&&(game.gain(object.data.pay),game.kaching(object))})};bootStrap.push(anims);var extend=function(){game.ai.statuses.wait=function(life){if(!0===life.data.isCat)return life.findNewPath(game.rand(0,game.mapDimension*game.tileSize),game.rand(0,game.mapDimension*game.tileSize)),!1;"workman"==life.data.job||game.ai.calcNeeds(life)}};bootStrap.push(extend);var tool=function(){game.ai.calcNeeds=function(life){if(defaultNeed="gohome",randNum=game.rand(0,game.needs.length-1),void 0===life.data.needCount)return life.data.needCount=game.rand(10,1e3),life.data.need="change",!0;0<life.data.needCount?(life.data.needCount--,life.data.need=game.needs[randNum]):life.data.need=defaultNeed,life.data.happiness<40&&(life.data.need=defaultNeed)}};bootStrap.push(tool);var tool=function(){game.grid.showBlockArea=function(){console.debug("ask"),game.ai.pathFinders[0].postMessage(["getgridnow"])},game.grid.blockRects=[],game.grid.showWalls=function(grid){console.debug("show"),console.debug(grid);for(var i=0;i<game.grid.blockRects.length;i++)game.grid.blockRects[i].destroy(),game.world.removeObject(game.grid.blockRects[i].id);game.grid.blockRects=[];for(var y=0;y<grid.nodes.length;y++)for(var x=0;x<grid.nodes[y].length;x++)!0===grid.nodes[y][x].walkable?(rect=new PIXI.Graphics,rect.beginFill(65280,.3),rect.lineStyle(1,2697513)):(rect=new PIXI.Graphics,rect.beginFill(16711680,.3),rect.lineStyle(4,2697513)),rect.drawRect(0,0,64,64),rect.displayGroup=game.render.background,game.render.background.addChild(rect),rect.visible=!0,rect.x=game.atGridPos(x),rect.y=game.atGridPos(y),game.grid.blockRects.push(rect)}};bootStrap.push(tool);var tool=function(){game.fCash=function(cash){return cash.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")},game.fCashShort=function(cash){return 5<=cash?Math.round(cash.toFixed(2)):cash.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")},game.spend=function(cost,type){return void 0===type&&(type="cash"),game.debug("Spend: "+cost+" of "+type),"cash"==type?cost>game.cash?0:(game.cash-=cost,1):(items=game.globalInventory.getItem(type),cost>items?0:(game.globalInventory.removeItem(type,cost),1))},game.gain=function(amount){!0===game.isTut&&7e3<game.cash&&(game.isTut=!1,game.completedTutorial()),game.cash+=amount},game.kachings=[],game.debugKaching=function(text,x,y){kaching=game.render.text(text,"cash"),kaching.x=x,kaching.y=y,game.render.objectLayer.addChild(kaching),game.kachings.push(kaching),kaching=void 0},game.kachingFunc=function(kaching){game.kachings.push(kaching),kaching=void 0},game.kaching=function(object){game.audio.sounds.ding.playMany(),kaching=game.render.text("$"+game.fCash(object.data.pay),"cash"),kaching.x=object.x,kaching.y=object.y,game.render.objectLayer.addChild(kaching),game.kachings.push(kaching),kaching=void 0},game.pooraf=function(object){mat=null==object?"cash":object.data.mat,kaching=game.render.text("Not enough "+mat+"!","redcash"),kaching.x=object.x,kaching.y=object.y,game.render.objectLayer.addChild(kaching),game.kachings.push(kaching),kaching=void 0},game.ouching=function(object){game.audio.sounds.spend.playMany(),kaching=game.render.text("$"+game.fCash(object.data.pay),"redcash"),kaching.x=object.x,kaching.y=object.y,game.render.objectLayer.addChild(kaching),game.kachings.push(kaching),kaching=void 0},game.tickers.push(function(){for(var k=0;k<game.kachings.length;k++)game.kachings[k].alpha=game.kachings[k].alpha-.005,game.kachings[k].y--,game.kachings[k].alpha<=0&&(game.kachings[k].destroy(),game.world.removeObject(game.kachings[k].id),game.kachings.splice(k,1),k--)})};bootStrap.push(tool);var tool=function(){game.ee.emitEvent("events-loaded"),game.ui.customerInfo=[],game.ui.hideCustomerInfo=function(life){for(var i=0;i<game.ui.customerInfo.length;i++)game.ui.customerInfo[i].destroy(),game.ui.customerInfo[i]=void 0;game.ui.customerInfo=[]},game.ui.showCustomerInfo=function(life){game.lifeClicked=!0,game.ui.hideCustomerInfo(),game.ui.hideStaffInfo(),void 0!==life.data.maxJobs&&(w=250,h=250,x=game.ui._VIEWPORT_RIGHT-w-15,y=game.ui._VIEWPORT_BOTTOM-h-15,game.ui.customerInfo.push(game.render.window(x,y,w,h,0,.8)),x+=15,y+=15,newText=game.render.text(life.data.job,"menu-title"),newText.x=x,newText.y=y,game.ui.customerInfo.push(newText),game.render.baseStage.addChild(newText),y+=35,clicked=function(life){life.status="destroy",game.ui.hideCustomerInfo(),game.ui.hideStaffInfo(),game.ui.notification("Fired staff member!")},newText=game.ui.greenButton("Fire",x,y,clicked,life),game.ui.customerInfo.push(newText[0]),game.ui.customerInfo.push(newText[1]),game.render.baseStage.addChild(newText[0]),game.render.baseStage.addChild(newText[1]),y+=35),void 0!==life.data.customerID&&(w=250,h=250,x=game.ui._VIEWPORT_RIGHT-w-15,y=game.ui._VIEWPORT_BOTTOM-h-15,game.ui.customerInfo.push(game.render.window(x,y,w,h,0,.8)),x+=15,y+=15,newText=game.render.text("Customer #"+life.data.customerID,"menu-title"),newText.x=x,newText.y=y,game.ui.customerInfo.push(newText),game.render.baseStage.addChild(newText),y+=35,newText=game.render.text(_LANG.BUDGET+" $"+life.data.cash,"smallcash"),newText.x=x,newText.y=y,game.ui.customerInfo.push(newText),game.render.baseStage.addChild(newText),y+=20,newText=game.render.text(_LANG.PERSONALITY+": "+life.data.personality,"standard-title"),newText.x=x,newText.y=y,game.ui.customerInfo.push(newText),game.render.baseStage.addChild(newText),y+=20,newText=game.render.text(_LANG.EXPERIENCE+": "+life.data.experience,"standard-title"),newText.x=x,newText.y=y,game.ui.customerInfo.push(newText),game.render.baseStage.addChild(newText),y+=20,void 0!==life.data.lastThought&&(newText=game.render.text("Last thought: "+life.data.lastThought,"standard-title"),newText.x=x,newText.y=y,game.ui.customerInfo.push(newText),game.render.baseStage.addChild(newText),y+=20))},game.ui.hideStaffInfo=function(life){for(var i=0;i<game.ui.customerInfo.length;i++)game.ui.customerInfo[i].destroy(),game.ui.customerInfo[i]=void 0;game.ui.customerInfo=[]},game.ui.showStaffInfo=function(life){game.lifeClicked=!0,game.ui.hideCustomerInfo(),game.ui.hideStaffInfo(),void 0!==life.data.maxJobs&&(w=250,h=250,x=game.ui._VIEWPORT_RIGHT-w-15,y=game.ui._VIEWPORT_BOTTOM-h-15,game.ui.customerInfo.push(game.render.window(x,y,w,h,0,.8)),x+=15,y+=15,newText=game.render.text("Customer #"+life.data.customerID,"menu-title"),newText.x=x,newText.y=y,game.ui.customerInfo.push(newText),game.render.baseStage.addChild(newText),y+=35,newText=game.render.text(_LANG.BUDGET+" $"+life.data.cash,"smallcash"),newText.x=x,newText.y=y,game.ui.customerInfo.push(newText),game.render.baseStage.addChild(newText),y+=20,newText=game.render.text(_LANG.PERSONALITY+": "+life.data.personality,"standard-title"),newText.x=x,newText.y=y,game.ui.customerInfo.push(newText),game.render.baseStage.addChild(newText),y+=20,newText=game.render.text(_LANG.EXPERIENCE+": "+life.data.experience,"standard-title"),newText.x=x,newText.y=y,game.ui.customerInfo.push(newText),game.render.baseStage.addChild(newText),y+=20,void 0!==life.data.lastThought&&!1!==game.settings.locked.readthoughts&&(newText=game.render.text("Last thought: "+life.data.lastThought,"standard-title"),newText.x=x,newText.y=y,game.ui.customerInfo.push(newText),game.render.baseStage.addChild(newText),y+=20))},game.events.clickLife=function(life){console.debug("clicked "+life.id),console.debug(life.toJSON()),game.ui.showCustomerInfo(life)},game.events.clickFurni=function(furni){console.debug("clicked furni "+furni.id)}};!function(exports){"use strict";function EventEmitter(){}var proto=EventEmitter.prototype,originalGlobalValue=exports.EventEmitter;function indexOfListener(listeners,listener){for(var i=listeners.length;i--;)if(listeners[i].listener===listener)return i;return-1}function alias(name){return function(){return this[name].apply(this,arguments)}}proto.getListeners=function(evt){var response,key,events=this._getEvents();if(evt instanceof RegExp)for(key in response={},events)events.hasOwnProperty(key)&&evt.test(key)&&(response[key]=events[key]);else response=events[evt]||(events[evt]=[]);return response},proto.flattenListeners=function(listeners){var i,flatListeners=[];for(i=0;i<listeners.length;i+=1)flatListeners.push(listeners[i].listener);return flatListeners},proto.getListenersAsObject=function(evt){var response,listeners=this.getListeners(evt);return listeners instanceof Array&&((response={})[evt]=listeners),response||listeners},proto.addListener=function(evt,listener){if(!function isValidListener(listener){return"function"==typeof listener||listener instanceof RegExp||!(!listener||"object"!=typeof listener)&&isValidListener(listener.listener)}(listener))throw new TypeError("listener must be a function");var key,listeners=this.getListenersAsObject(evt),listenerIsWrapped="object"==typeof listener;for(key in listeners)listeners.hasOwnProperty(key)&&-1===indexOfListener(listeners[key],listener)&&listeners[key].push(listenerIsWrapped?listener:{listener:listener,once:!1});return this},proto.on=alias("addListener"),proto.addOnceListener=function(evt,listener){return this.addListener(evt,{listener:listener,once:!0})},proto.once=alias("addOnceListener"),proto.defineEvent=function(evt){return this.getListeners(evt),this},proto.defineEvents=function(evts){for(var i=0;i<evts.length;i+=1)this.defineEvent(evts[i]);return this},proto.removeListener=function(evt,listener){var index,key,listeners=this.getListenersAsObject(evt);for(key in listeners)listeners.hasOwnProperty(key)&&-1!==(index=indexOfListener(listeners[key],listener))&&listeners[key].splice(index,1);return this},proto.off=alias("removeListener"),proto.addListeners=function(evt,listeners){return this.manipulateListeners(!1,evt,listeners)},proto.removeListeners=function(evt,listeners){return this.manipulateListeners(!0,evt,listeners)},proto.manipulateListeners=function(remove,evt,listeners){var i,value,single=remove?this.removeListener:this.addListener,multiple=remove?this.removeListeners:this.addListeners;if("object"!=typeof evt||evt instanceof RegExp)for(i=listeners.length;i--;)single.call(this,evt,listeners[i]);else for(i in evt)evt.hasOwnProperty(i)&&(value=evt[i])&&("function"==typeof value?single.call(this,i,value):multiple.call(this,i,value));return this},proto.removeEvent=function(evt){var key,type=typeof evt,events=this._getEvents();if("string"===type)delete events[evt];else if(evt instanceof RegExp)for(key in events)events.hasOwnProperty(key)&&evt.test(key)&&delete events[key];else delete this._events;return this},proto.removeAllListeners=alias("removeEvent"),proto.emitEvent=function(evt,args){var listeners,listener,i,key,listenersMap=this.getListenersAsObject(evt);for(key in listenersMap)if(listenersMap.hasOwnProperty(key))for(listeners=listenersMap[key].slice(0),i=0;i<listeners.length;i++)!0===(listener=listeners[i]).once&&this.removeListener(evt,listener.listener),listener.listener.apply(this,args||[])===this._getOnceReturnValue()&&this.removeListener(evt,listener.listener);return this},proto.trigger=alias("emitEvent"),proto.emit=function(evt){var args=Array.prototype.slice.call(arguments,1);return this.emitEvent(evt,args)},proto.setOnceReturnValue=function(value){return this._onceReturnValue=value,this},proto._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},proto._getEvents=function(){return this._events||(this._events={})},EventEmitter.noConflict=function(){return exports.EventEmitter=originalGlobalValue,EventEmitter},"function"==typeof define&&define.amd?define(function(){return EventEmitter}):"object"==typeof module&&module.exports?module.exports=EventEmitter:exports.EventEmitter=EventEmitter}(this||{});var tool=function(){game.track={},game.track.event=function(action,info){category="Game","undefined"!==ga?ga("send","event",category,action,info):game.debug("No tracking available")},game.track.event("Game loaded "+game.lang,"Loaded: "+game.lang)};bootStrap.push(tool);bootStrap.push(function(){game.setMarketingSettings=function(){game.settings.marketing={},game.settings.marketing.custBudget=0,game.settings.marketing.increasePros=0,game.settings.marketing.decreaseRuffians=0,game.settings.marketing.maxBudget=250}});bootStrap.push(function(){game.getMedal=function(name){},game.unlockNGMedal=function(name){},game.apis={},game.apis.ng={},game.apis.ng=new Newgrounds.io.core("46268:iS20RXE6","fIfgnwNqytdvd4dezQbqBg=="),game.apis.ng.callComponent("Gateway.getDatetime",{},function(result){result.success?(console.log("The current date/time on the Newgrounds.io server is "+result.datetime),game.apis.ng.active=!0):(console.log("ERROR!",result.error.message),game.apis.ng.active=!1)}),game.apis.ng.onMedalsLoaded=function(result){result.success&&(game.apis.ng.medals=result.medals)},game.apis.ng.onMedalUnlocked=function(medal){console.log("MEDAL GET:",medal.name)},game.apis.ng.unlockMedal=function(medal_name){if(!game.apis.ng.user)return game.debug("No user"),!1;if(void 0===game.apis.ng.medals)return game.debug("couldnt get medals"),!1;medals=game.apis.ng.medals,game.debug("                      "+medal_name),e="    ";for(var i=0;i<medals.length;i++)if(e+="         ",medal=medals[i],game.debug("                      "+e+medal_name),medal.name==medal_name)return void(medal.unlocked||game.apis.ng.callComponent("Medal.unlock",{id:medal.id},function(result){result.success&&game.apis.ng.onMedalUnlocked(result.medal)}))},game.apis.ng.onLoggedIn=function(){console.log("Welcome "+game.apis.ng.user.name+"!")},game.apis.ng.onLoginFailed=function(){console.log("There was a problem logging in: ".game.apis.ng.login_error.message)},game.apis.ng.onLoginCancelled=function(){console.log("The user cancelled the login.")},game.apis.ng.initSession=function(){game.apis.ng.getValidSession(function(){game.apis.ng.user&&game.apis.ng.onLoggedIn()})},game.apis.ng.requestLogin=function(){game.apis.ng.requestLogin(game.apis.ng.onLoggedIn,game.apis.ng.onLoginFailed,game.apis.ng.onLoginCancelled)},game.apis.ng.cancelLogin=function(){game.apis.ng.cancelLoginRequest()},game.apis.ng.logOut=function(){game.apis.ng.logOut(function(){})},game.apis.ng.queueComponent("Medal.getList",{},game.apis.ng.onMedalsLoaded),game.apis.ng.executeQueue(),game.apis.ng.initSession()});bootStrap.push(function(){game.patients={},game.patients.availablePatients={},game.patientNames=["Hector","Jasper","Phil","Steph","Wensdi","Ladeda","Warwick","Theo","Jake","Demi","Zeti","Alexa","Dinlol","Pompo","El Pompo","Keybro","Gremblo","Shremblo","Balzack","Mizzy","Jizz","Wendle","Tidj","Tashybashi","Nico","Morgan","Jam","Jammy","Data","Dale","Luke","Pash","Anil"],game.patientBios=["Enjoys reading books","The life of the party!","The boring one","A very smart cookie","Super cool dude","Loves to play FPS games","The quiet one"],game.patientRandomJobs=["builder","miner","janitor","spare"],game.patients.newAvailablePatient=function(job){var down=game.rand(1,4),female=.5<=Math.random(),headNumber=game.rand(1,5),name=game.patientNames[game.rand(0,game.patientNames.length-1)],bio=game.patientBios[game.rand(0,game.patientBios.length-1)];void 0===job&&(job=game.patientRandomJobs[game.rand(0,game.patientRandomJobs.length-1)]);var potentialPatient=game.ai.createLifePhoto(1,down,female,3,headNumber);potentialPatient.data.body={},potentialPatient.data.body.hat=3,potentialPatient.data.body.head=headNumber,potentialPatient.data.body.across=1,potentialPatient.data.body.down=down,potentialPatient.data.female=female,pre="Nickname: ",potentialPatient.data.patient={},potentialPatient.data.patient.name=pre+name,potentialPatient.data.patient.rawName=name,potentialPatient.data.patient.bio=bio,potentialPatient.data.patient.love=100,potentialPatient.data.patient.compliance=20,potentialPatient.data.patient.creativity=100,potentialPatient.data.patient.skill=job,potentialPatient.data.patient.skillLevel=game.rand(0,20),game.gameLog("New staff are available"),null==game.patients.availablePatients[job]&&(game.patients.availablePatients[job]=[]),game.patients.availablePatients[job].push(potentialPatient)},game.patients.addPatientToWorld=function(job,patientID){if(game.gameLog("Hired "+job),void 0===game.patients.availablePatients[job][patientID])return game.debug("Cant find that patient? "+patientID),!1;patient=game.patients.availablePatients[job][patientID],game.patients.availablePatients[job].splice(patientID,1),newPatient=game.ai.createLife(game.atGridPos(game.mapDimension/2),game.atGridPos(game.mapDimension/2),patient.data.body.across,patient.data.body.down,!0,patient.data.female,patient.data.body.hat,patient.data.body.head,patient.data.patient.rawName),newPatient.data.patient=patient.data.patient,newPatient.data.body=patient.data.body,newPatient.data.female=patient.data.female,newPatient.giveJob(patient.data.patient.skill),newPatient.data.jobs=game.jobs.allJobs,newPatient.data.skillLevel=patient.data.skillLevel,newPatient.interactive=!0,newPatient.on("pointerdown",function(){console.log("Clicked life"),game.ui.htmlPawnInfo(this)})}});bootStrap.push(function(){game.gameLog=function(message,level){void 0===level&&(level="green"),logCount=$("#game-log-contents p").length,14<logCount&&$("#game-log-contents p:last").remove(),day=5,hour=5,hour<10&&(hour="0"+hour),$("#game-log-contents").prepend("<p class='"+level+"'>"+message+"</p>")},game.clearLog=function(){$("#game-log-contents").empty()}});var tool=function(){game.bills={},game.bills.elecRate=10,game.bills.flatRate=500,game.paidLastBill=!0;game.world.addTimeFunction(18,{},function(){if(!0===game.started){if(console.debug("bill time"),billText=_LANG.ELEC_BILL_1+"\n\n",unitsUsed=0,uniques={},void 0!==game.world.index.on){for(var machine in game.world.index.on)void 0!==game.world.index.on[machine].data.elecUnits&&(unitsUsed+=game.world.index.on[machine].data.elecUnits,null==uniques[game.world.index.on[machine].readName]&&(uniques[game.world.index.on[machine].readName]=0),uniques[game.world.index.on[machine].readName]+=game.world.index.on[machine].data.elecUnits);totalBill=unitsUsed*game.bills.elecRate}else totalBill=0;for(var machine in uniques)billText+=machine+_LANG.ELEC_BILL_2+uniques[machine]+"\n";1===game.spend(totalBill)?(billText+="\n"+_LANG.ELEC_BILL_3+" $"+game.bills.elecRate+"\n"+_LANG.ELEC_BILL_4+" "+unitsUsed+"\n\n"+_LANG.ELEC_BILL_5+" $"+totalBill+"\n\n ["+_LANG.ELEC_BILL_6+"]",game.paidLastBill=!0):!1===game.paidLastBill?game.lose("elecbill"):(game.paidLastBill=!1,billText+="\n\n"+_LANG.ELEC_BILL_5+" $"+totalBill+"\n ["+_LANG.ELEC_BILL_7+"]"),game.ui.largeNotification(billText)}})};bootStrap.push(tool);bootStrap.push(function(){game.settings.failHappiness=25,game.settings.warnHappiness=49,game.checkFails=function(){!0===game.started&&(game.debug("Checking fail states"),game.settings.happyPeeps<game.settings.failHappiness&&game.ui.notification("Your happiness has hit an all time low! We have to close the arcade. Maybe we should try something different next time?"),game.settings.happyPeeps<game.settings.warnHappiness&&game.ui.notification("Your happiness is very low! If it drops below {1}% then you will lose ownership of the arcade!".replace("{1}",game.settings.failHappiness)),game.cash<-1e3&&game.ui.notification("Your cashflow is very low, consider taking out a loan or increasing prices"))},game.world.addTimeFunction(0,{},game.checkFails),game.world.addTimeFunction(7,{},game.checkFails),game.world.power={},game.world.power.lastCheck=0,game.world.powerGrid={},game.world.powerChecksInt=0,game.world.power.checkCables=function(pwr){game.debug("Check cables for: "+pwr.id);var x=game.gridPos(pwr.x),y=game.gridPos(pwr.y+64);game.debug("Check cables at x:"+x+" y: "+y),game.world.powerChecksInt=0,game.world.power.checkPower(x,y,pwr)},game.world.power.toggleWire=function(x,y,source){void 0!==game.world.powerGrid[x+"-"+y]?void 0===game.world.powerGrid[x+"-"+y][2][source.id]&&(game.world.powerGrid[x+"-"+y][0]=source.powered,void 0===game.world.powerGrid[x+"-"+y][2][source.id]&&(game.world.powerGrid[x+"-"+y][1]+=source.data.watts,game.world.powerGrid[x+"-"+y][2][source.id]=source.data.watts)):(sources={},sources[source.id]=source.data.watts,game.world.powerGrid[x+"-"+y]=[source.powered,source.data.watts,sources])},game.world.power.checkPower=function(x,y,pwr,lastpos){if(void 0!==game.world.powerGrid[x+"-"+y]&&void 0!==game.world.powerGrid[x+"-"+y][2][pwr.id])return game.world.power.toggleWire(x,y,pwr),!1;if(game.world.powerChecksInt++,game.grid.checkWire(x,y)){if(game.world.power.toggleWire(x,y,pwr),l=game.grid.checkWire(x-1,y),r=game.grid.checkWire(x+1,y),u=game.grid.checkWire(x,y-1),d=game.grid.checkWire(x,y+1),!(l||r||u||d))return!1;game.world.power.checkPower(x-1,y,pwr,"l"),game.world.power.checkPower(x+1,y,pwr,"r"),game.world.power.checkPower(x,y-1,pwr,"u"),game.world.power.checkPower(x,y+1,pwr,"d")}},game.world.power.runPowerCheck=function(){if($("#txt-x").html(game.cursor.x),$("#txt-y").html(game.cursor.y),$("#txt-gridx").html(game.gridPos(game.mouseX)),$("#txt-gridy").html(game.gridPos(game.mouseY)),void 0!==game.world.powerGrid[game.gridPos(game.mouseX)+"-"+game.gridPos(game.mouseY)]?($("#txt-power").html(game.world.powerGrid[game.gridPos(game.mouseX)+"-"+game.gridPos(game.mouseY)][0]),$("#txt-power").append("<br />"),$("#txt-power").append("W:"+game.world.powerGrid[game.gridPos(game.mouseX)+"-"+game.gridPos(game.mouseY)][1])):$("#txt-power").html("No"),doPowaCheck=!1,0===game.world.power.lastCheck&&(game.world.power.lastCheck=Date.now()),void 0===game.world.index.power||game.world.index.power.length<1)return doPowaCheck=!1;if(1e4<Date.now()-game.world.power.lastCheck&&(doPowaCheck=!0),!doPowaCheck)return!1;for(var objectName in game.world.powerGrid={},game.debug("Check powa"),game.world.power.lastCheck=Date.now(),powerItems=game.world.index.noPower,powerItems)pwr=powerItems[objectName],game.world.power.checkCables(pwr);for(var objectName in powerItems=game.world.index.power,powerItems)pwr=powerItems[objectName],game.world.power.checkCables(pwr);game.grid.drawn=!1,game.grid.drawWalls()}});window.onload = function() {game = new Game('prod');game.load();};